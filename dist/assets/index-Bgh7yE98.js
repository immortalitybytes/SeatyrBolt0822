const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browser-DBTxTTQI.js","assets/vendor-cfX1qToU.js"])))=>i.map(i=>d[i]);
import{r as e,a as t,R as s,g as r,c as a,u as n,N as i,B as o,b as l,d as c}from"./vendor-cfX1qToU.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var d={exports:{}},u={},h=e,m=Symbol.for("react.element"),p=Symbol.for("react.fragment"),g=Object.prototype.hasOwnProperty,f=h.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,y={key:!0,ref:!0,__self:!0,__source:!0};function b(e,t,s){var r,a={},n=null,i=null;for(r in void 0!==s&&(n=""+s),void 0!==t.key&&(n=""+t.key),void 0!==t.ref&&(i=t.ref),t)g.call(t,r)&&!y.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:m,type:e,key:n,ref:i,props:a,_owner:f.current}}u.Fragment=p,u.jsx=b,u.jsxs=b,d.exports=u;var x=d.exports,v={},w=t;v.createRoot=w.createRoot,v.hydrateRoot=w.hydrateRoot;
/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var j={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=(t,s)=>{const r=e.forwardRef((({color:r="currentColor",size:a=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:o="",children:l,...c},d)=>{return e.createElement("svg",{ref:d,...j,width:a,height:a,stroke:r,strokeWidth:i?24*Number(n)/Number(a):n,className:["lucide",`lucide-${u=t,u.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()}`,o].join(" "),...c},[...s.map((([t,s])=>e.createElement(t,s))),...Array.isArray(l)?l:[l]]);var u}));return r.displayName=`${t}`,r},k=_("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),S=_("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),N=_("ArrowDownAZ",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M20 8h-5",key:"1vsyxs"}],["path",{d:"M15 10V6.5a2.5 2.5 0 0 1 5 0V10",key:"ag13bf"}],["path",{d:"M15 14h5l-5 6h5",key:"ur5jdg"}]]),E=_("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),T=_("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),C=_("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),P=_("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),B=_("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]),I=_("ClipboardCopy",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2",key:"4jdomd"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v4",key:"3hqy98"}],["path",{d:"M21 14H11",key:"1bme5i"}],["path",{d:"m15 10-4 4 4 4",key:"5dvupr"}]]),A=_("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]),$=_("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),O=_("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),R=_("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),L=_("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]),D=_("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),U=_("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]),M=_("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]),z=_("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),F=_("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),q=_("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),W=_("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),V=_("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),H=_("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),G=_("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]),J=_("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Y=_("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),K=_("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]),Z=_("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),X=_("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]),Q=_("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),ee=_("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),te=_("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),se=_("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),re=({children:e,variant:t="primary",size:s="md",icon:r,iconPosition:a="left",className:n="",...i})=>{const o=i.disabled?"opacity-50 cursor-not-allowed":"";return x.jsxs("button",{className:`inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 border ${{primary:"bg-[#7973BB] hover:bg-[#7973BB]/90 text-white focus:ring-[#7973BB] border-[#7973BB]",secondary:"bg-white hover:bg-gray-100 text-[#7973BB] focus:ring-[#7973BB] border-[#7973BB]",danger:"bg-red-600 hover:bg-red-700 text-white focus:ring-red-500 border-[#7973BB]",success:"bg-green-600 hover:bg-green-700 text-white focus:ring-green-500 border-[#7973BB]",warning:"bg-amber-500 hover:bg-amber-600 text-white focus:ring-amber-500 border-[#7973BB]"}[t]} ${{sm:"px-2 py-1 text-sm",md:"px-4 py-2",lg:"px-6 py-3 text-lg"}[s]} ${o} ${n}`,...i,children:[r&&"left"===a&&x.jsx("span",{className:"mr-1",children:r}),e,r&&"right"===a&&x.jsx("span",{className:"ml-1",children:r})]})};var ae,ne="colors",ie="sizes",oe="space",le={gap:oe,gridGap:oe,columnGap:oe,gridColumnGap:oe,rowGap:oe,gridRowGap:oe,inset:oe,insetBlock:oe,insetBlockEnd:oe,insetBlockStart:oe,insetInline:oe,insetInlineEnd:oe,insetInlineStart:oe,margin:oe,marginTop:oe,marginRight:oe,marginBottom:oe,marginLeft:oe,marginBlock:oe,marginBlockEnd:oe,marginBlockStart:oe,marginInline:oe,marginInlineEnd:oe,marginInlineStart:oe,padding:oe,paddingTop:oe,paddingRight:oe,paddingBottom:oe,paddingLeft:oe,paddingBlock:oe,paddingBlockEnd:oe,paddingBlockStart:oe,paddingInline:oe,paddingInlineEnd:oe,paddingInlineStart:oe,top:oe,right:oe,bottom:oe,left:oe,scrollMargin:oe,scrollMarginTop:oe,scrollMarginRight:oe,scrollMarginBottom:oe,scrollMarginLeft:oe,scrollMarginX:oe,scrollMarginY:oe,scrollMarginBlock:oe,scrollMarginBlockEnd:oe,scrollMarginBlockStart:oe,scrollMarginInline:oe,scrollMarginInlineEnd:oe,scrollMarginInlineStart:oe,scrollPadding:oe,scrollPaddingTop:oe,scrollPaddingRight:oe,scrollPaddingBottom:oe,scrollPaddingLeft:oe,scrollPaddingX:oe,scrollPaddingY:oe,scrollPaddingBlock:oe,scrollPaddingBlockEnd:oe,scrollPaddingBlockStart:oe,scrollPaddingInline:oe,scrollPaddingInlineEnd:oe,scrollPaddingInlineStart:oe,fontSize:"fontSizes",background:ne,backgroundColor:ne,backgroundImage:ne,borderImage:ne,border:ne,borderBlock:ne,borderBlockEnd:ne,borderBlockStart:ne,borderBottom:ne,borderBottomColor:ne,borderColor:ne,borderInline:ne,borderInlineEnd:ne,borderInlineStart:ne,borderLeft:ne,borderLeftColor:ne,borderRight:ne,borderRightColor:ne,borderTop:ne,borderTopColor:ne,caretColor:ne,color:ne,columnRuleColor:ne,fill:ne,outline:ne,outlineColor:ne,stroke:ne,textDecorationColor:ne,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:ie,minBlockSize:ie,maxBlockSize:ie,inlineSize:ie,minInlineSize:ie,maxInlineSize:ie,width:ie,minWidth:ie,maxWidth:ie,height:ie,minHeight:ie,maxHeight:ie,flexBasis:ie,gridTemplateColumns:ie,gridTemplateRows:ie,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},ce=(e,t)=>"function"==typeof t?{"()":Function.prototype.toString.call(t)}:t,de=()=>{const e=Object.create(null);return(t,s,...r)=>{const a=(n=t,JSON.stringify(n,ce));var n;return a in e?e[a]:e[a]=s(t,...r)}},ue=Symbol.for("sxs.internal"),he=(e,t)=>Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)),me=e=>{for(const t in e)return!0;return!1},{hasOwnProperty:pe}=Object.prototype,ge=e=>e.includes("-")?e:e.replace(/[A-Z]/g,(e=>"-"+e.toLowerCase())),fe=/\s+(?![^()]*\))/,ye=e=>t=>e(..."string"==typeof t?String(t).split(fe):[t]),be={appearance:e=>({WebkitAppearance:e,appearance:e}),backfaceVisibility:e=>({WebkitBackfaceVisibility:e,backfaceVisibility:e}),backdropFilter:e=>({WebkitBackdropFilter:e,backdropFilter:e}),backgroundClip:e=>({WebkitBackgroundClip:e,backgroundClip:e}),boxDecorationBreak:e=>({WebkitBoxDecorationBreak:e,boxDecorationBreak:e}),clipPath:e=>({WebkitClipPath:e,clipPath:e}),content:e=>({content:e.includes('"')||e.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(e)?e:`"${e}"`}),hyphens:e=>({WebkitHyphens:e,hyphens:e}),maskImage:e=>({WebkitMaskImage:e,maskImage:e}),maskSize:e=>({WebkitMaskSize:e,maskSize:e}),tabSize:e=>({MozTabSize:e,tabSize:e}),textSizeAdjust:e=>({WebkitTextSizeAdjust:e,textSizeAdjust:e}),userSelect:e=>({WebkitUserSelect:e,userSelect:e}),marginBlock:ye(((e,t)=>({marginBlockStart:e,marginBlockEnd:t||e}))),marginInline:ye(((e,t)=>({marginInlineStart:e,marginInlineEnd:t||e}))),maxSize:ye(((e,t)=>({maxBlockSize:e,maxInlineSize:t||e}))),minSize:ye(((e,t)=>({minBlockSize:e,minInlineSize:t||e}))),paddingBlock:ye(((e,t)=>({paddingBlockStart:e,paddingBlockEnd:t||e}))),paddingInline:ye(((e,t)=>({paddingInlineStart:e,paddingInlineEnd:t||e})))},xe=/([\d.]+)([^]*)/,ve=(e,t)=>e.length?e.reduce(((e,s)=>(e.push(...t.map((e=>e.includes("&")?e.replace(/&/g,/[ +>|~]/.test(s)&&/&.*&/.test(e)?`:is(${s})`:s):s+" "+e))),e)),[]):t,we=(e,t)=>e in je&&"string"==typeof t?t.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,((t,s,r,a)=>s+("stretch"===r?`-moz-available${a};${ge(e)}:${s}-webkit-fill-available`:`-moz-fit-content${a};${ge(e)}:${s}fit-content`)+a)):String(t),je={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},_e=e=>e?e+"-":"",ke=(e,t,s)=>e.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,((e,r,a,n,i)=>"$"==n==!!a?e:(r||"--"==n?"calc(":"")+"var(--"+("$"===n?_e(t)+(i.includes("$")?"":_e(s))+i.replace(/\$/g,"-"):i)+")"+(r||"--"==n?"*"+(r||"")+(a||"1")+")":""))),Se=/\s*,\s*(?![^()]*\))/,Ne=Object.prototype.toString,Ee=(e,t,s,r,a)=>{let n,i,o;const l=(e,t,s)=>{let c,d;const u=e=>{for(c in e){const p=64===c.charCodeAt(0),g=p&&Array.isArray(e[c])?e[c]:[e[c]];for(d of g){const e=/[A-Z]/.test(m=c)?m:m.replace(/-[^]/g,(e=>e[1].toUpperCase())),g="object"==typeof d&&d&&d.toString===Ne&&(!r.utils[e]||!t.length);if(e in r.utils&&!g){const t=r.utils[e];if(t!==i){i=t,u(t(d)),i=null;continue}}else if(e in be){const t=be[e];if(t!==o){o=t,u(t(d)),o=null;continue}}if(p&&(h=c.slice(1)in r.media?"@media "+r.media[c.slice(1)]:c,c=h.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,((e,t,s,r,a,n)=>{const i=xe.test(t),o=.0625*(i?-1:1),[l,c]=i?[r,t]:[t,r];return"("+("="===s[0]?"":">"===s[0]===i?"max-":"min-")+l+":"+("="!==s[0]&&1===s.length?c.replace(xe,((e,t,r)=>Number(t)+o*(">"===s?1:-1)+r)):c)+(a?") and ("+(">"===a[0]?"min-":"max-")+l+":"+(1===a.length?n.replace(xe,((e,t,s)=>Number(t)+o*(">"===a?-1:1)+s)):n):"")+")"}))),g){const e=p?s.concat(c):[...s],r=p?[...t]:ve(t,c.split(Se));void 0!==n&&a(Te(...n)),n=void 0,l(d,r,e)}else void 0===n&&(n=[[],t,s]),c=p||36!==c.charCodeAt(0)?c:`--${_e(r.prefix)}${c.slice(1).replace(/\$/g,"-")}`,d=g?d:"number"==typeof d?d&&e in Ce?String(d)+"px":String(d):ke(we(e,null==d?"":d),r.prefix,r.themeMap[e]),n[0].push(`${p?`${c} `:`${ge(c)}:`}${d}`)}}var h,m};u(e),void 0!==n&&a(Te(...n)),n=void 0};l(e,t,s)},Te=(e,t,s)=>`${s.map((e=>`${e}{`)).join("")}${t.length?`${t.join(",")}{`:""}${e.join(";")}${t.length?"}":""}${Array(s.length?s.length+1:0).join("}")}`,Ce={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},Pe=e=>String.fromCharCode(e+(e>25?39:97)),Be=e=>(e=>{let t,s="";for(t=Math.abs(e);t>52;t=t/52|0)s=Pe(t%52)+s;return Pe(t%52)+s})(((e,t)=>{let s=t.length;for(;s;)e=33*e^t.charCodeAt(--s);return e})(5381,JSON.stringify(e))>>>0),Ie=["themed","global","styled","onevar","resonevar","allvar","inline"],Ae=e=>{if(e.href&&!e.href.startsWith(location.origin))return!1;try{return!!e.cssRules}catch(t){return!1}},$e=e=>{let t;const s=()=>{const{cssRules:e}=t.sheet;return[].map.call(e,((s,r)=>{const{cssText:a}=s;let n="";if(a.startsWith("--sxs"))return"";if(e[r-1]&&(n=e[r-1].cssText).startsWith("--sxs")){if(!s.cssRules.length)return"";for(const e in t.rules)if(t.rules[e].group===s)return`--sxs{--sxs:${[...t.rules[e].cache].join(" ")}}${a}`;return s.cssRules.length?`${n}${a}`:""}return a})).join("")},r=()=>{if(t){const{rules:e,sheet:s}=t;if(!s.deleteRule){for(;3===Object(Object(s.cssRules)[0]).type;)s.cssRules.splice(0,1);s.cssRules=[]}for(const t in e)delete e[t]}const a=Object(e).styleSheets||[];for(const e of a)if(Ae(e)){for(let a=0,n=e.cssRules;n[a];++a){const i=Object(n[a]);if(1!==i.type)continue;const o=Object(n[a+1]);if(4!==o.type)continue;++a;const{cssText:l}=i;if(!l.startsWith("--sxs"))continue;const c=l.slice(14,-3).trim().split(/\s+/),d=Ie[c[0]];d&&(t||(t={sheet:e,reset:r,rules:{},toString:s}),t.rules[d]={group:o,index:a,cache:new Set(c)})}if(t)break}if(!t){const a=(e,t)=>({type:t,cssRules:[],insertRule(e,t){this.cssRules.splice(t,0,a(e,{import:3,undefined:1}[(e.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return"@media{}"===e?`@media{${[].map.call(this.cssRules,(e=>e.cssText)).join("")}}`:e}});t={sheet:e?(e.head||e).appendChild(document.createElement("style")).sheet:a("","text/css"),rules:{},reset:r,toString:s}}const{sheet:n,rules:i}=t;for(let e=Ie.length-1;e>=0;--e){const t=Ie[e];if(!i[t]){const s=Ie[e+1],r=i[s]?i[s].index:n.cssRules.length;n.insertRule("@media{}",r),n.insertRule(`--sxs{--sxs:${e}}`,r),i[t]={group:n.cssRules[r+1],index:r,cache:new Set([e])}}Oe(i[t])}};return r(),t},Oe=e=>{const t=e.group;let s=t.cssRules.length;e.apply=e=>{try{t.insertRule(e,s),++s}catch(r){}}},Re=Symbol(),Le=de(),De=(e,t)=>Le(e,(()=>(...s)=>{let r={type:null,composers:new Set};for(const t of s)if(null!=t)if(t[ue]){null==r.type&&(r.type=t[ue].type);for(const e of t[ue].composers)r.composers.add(e)}else t.constructor!==Object||t.$$typeof?null==r.type&&(r.type=t):r.composers.add(Ue(t,e));return null==r.type&&(r.type="span"),r.composers.size||r.composers.add(["PJLV",{},[],[],{},[]]),Me(e,r,t)})),Ue=({variants:e,compoundVariants:t,defaultVariants:s,...r},a)=>{const n=`${_e(a.prefix)}c-${Be(r)}`,i=[],o=[],l=Object.create(null),c=[];for(const h in s)l[h]=String(s[h]);if("object"==typeof e&&e)for(const h in e){d=l,u=h,pe.call(d,u)||(l[h]="undefined");const t=e[h];for(const e in t){const s={[h]:String(e)};"undefined"===String(e)&&c.push(h);const r=t[e],a=[s,r,!me(r)];i.push(a)}}var d,u;if("object"==typeof t&&t)for(const h of t){let{css:e,...t}=h;e="object"==typeof e&&e||{};for(const r in t)t[r]=String(t[r]);const s=[t,e,!me(e)];o.push(s)}return[n,r,i,o,l,c]},Me=(e,t,s)=>{const[r,a,n,i]=ze(t.composers),o="function"==typeof t.type||t.type.$$typeof?(e=>{function t(){for(let s=0;s<t[Re].length;s++){const[r,a]=t[Re][s];e.rules[r].apply(a)}return t[Re]=[],null}return t[Re]=[],t.rules={},Ie.forEach((e=>t.rules[e]={apply:s=>t[Re].push([e,s])})),t})(s):null,l=(o||s).rules,c=`.${r}${a.length>1?`:where(.${a.slice(1).join(".")})`:""}`,d=d=>{d="object"==typeof d&&d||qe;const{css:u,...h}=d,m={};for(const e in n)if(delete h[e],e in d){let t=d[e];"object"==typeof t&&t?m[e]={"@initial":n[e],...t}:(t=String(t),m[e]="undefined"!==t||i.has(e)?t:n[e])}else m[e]=n[e];const p=new Set([...a]);for(const[r,a,n,i]of t.composers){s.rules.styled.cache.has(r)||(s.rules.styled.cache.add(r),Ee(a,[`.${r}`],[],e,(e=>{l.styled.apply(e)})));const t=Fe(n,m,e.media),o=Fe(i,m,e.media,!0);for(const a of t)if(void 0!==a)for(const[t,n,i]of a){const a=`${r}-${Be(n)}-${t}`;p.add(a);const o=(i?s.rules.resonevar:s.rules.onevar).cache,c=i?l.resonevar:l.onevar;o.has(a)||(o.add(a),Ee(n,[`.${a}`],[],e,(e=>{c.apply(e)})))}for(const a of o)if(void 0!==a)for(const[t,n]of a){const a=`${r}-${Be(n)}-${t}`;p.add(a),s.rules.allvar.cache.has(a)||(s.rules.allvar.cache.add(a),Ee(n,[`.${a}`],[],e,(e=>{l.allvar.apply(e)})))}}if("object"==typeof u&&u){const t=`${r}-i${Be(u)}-css`;p.add(t),s.rules.inline.cache.has(t)||(s.rules.inline.cache.add(t),Ee(u,[`.${t}`],[],e,(e=>{l.inline.apply(e)})))}for(const e of String(d.className||"").trim().split(/\s+/))e&&p.add(e);const g=h.className=[...p].join(" ");return{type:t.type,className:g,selector:c,props:h,toString:()=>g,deferredInjector:o}};return he(d,{className:r,selector:c,[ue]:t,toString:()=>(s.rules.styled.cache.has(r)||d(),r)})},ze=e=>{let t="";const s=[],r={},a=[];for(const[n,,,,i,o]of e){""===t&&(t=n),s.push(n),a.push(...o);for(const e in i){const t=i[e];(void 0===r[e]||"undefined"!==t||o.includes(t))&&(r[e]=t)}}return[t,s,r,new Set(a)]},Fe=(e,t,s,r)=>{const a=[];e:for(let[n,i,o]of e){if(o)continue;let e,l=0,c=!1;for(e in n){const r=n[e];let a=t[e];if(a!==r){if("object"!=typeof a||!a)continue e;{let e,t,n=0;for(const i in a){if(r===String(a[i])){if("@initial"!==i){const e=i.slice(1);(t=t||[]).push(e in s?s[e]:i.replace(/^@media ?/,"")),c=!0}l+=n,e=!0}++n}if(t&&t.length&&(i={["@media "+t.join(", ")]:i}),!e)continue e}}}(a[l]=a[l]||[]).push([r?"cv":`${e}-${n[e]}`,i,c])}return a},qe={},We=de(),Ve=(e,t)=>We(e,(()=>(...s)=>{const r=()=>{for(let r of s){r="object"==typeof r&&r||{};let s=Be(r);if(!t.rules.global.cache.has(s)){if(t.rules.global.cache.add(s),"@import"in r){let e=[].indexOf.call(t.sheet.cssRules,t.rules.themed.group)-1;for(let s of[].concat(r["@import"]))s=s.includes('"')||s.includes("'")?s:`"${s}"`,t.sheet.insertRule(`@import ${s};`,e++);delete r["@import"]}Ee(r,[],[],e,(e=>{t.rules.global.apply(e)}))}}return""};return he(r,{toString:r})})),He=de(),Ge=(e,t)=>He(e,(()=>s=>{const r=`${_e(e.prefix)}k-${Be(s)}`,a=()=>{if(!t.rules.global.cache.has(r)){t.rules.global.cache.add(r);const a=[];Ee(s,[],[],e,(e=>a.push(e)));const n=`@keyframes ${r}{${a.join("")}}`;t.rules.global.apply(n)}return r};return he(a,{get name(){return a()},toString:a})})),Je=class{constructor(e,t,s,r){this.token=null==e?"":String(e),this.value=null==t?"":String(t),this.scale=null==s?"":String(s),this.prefix=null==r?"":String(r)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+_e(this.prefix)+_e(this.scale)+this.token}toString(){return this.computedValue}},Ye=de(),Ke=(e,t)=>Ye(e,(()=>(s,r)=>{r="object"==typeof s&&s||Object(r);const a=`.${s=(s="string"==typeof s?s:"")||`${_e(e.prefix)}t-${Be(r)}`}`,n={},i=[];for(const t in r){n[t]={};for(const s in r[t]){const a=`--${_e(e.prefix)}${t}-${s}`,o=ke(String(r[t][s]),e.prefix,t);n[t][s]=new Je(s,o,t,e.prefix),i.push(`${a}:${o}`)}}const o=()=>{if(i.length&&!t.rules.themed.cache.has(s)){t.rules.themed.cache.add(s);const a=`${r===e.theme?":root,":""}.${s}{${i.join(";")}}`;t.rules.themed.apply(a)}return s};return{...n,get className(){return o()},selector:a,toString:o}})),Ze=de(),Xe=e=>{let t=!1;const s=Ze(e,(e=>{t=!0;const s="prefix"in(e="object"==typeof e&&e||{})?String(e.prefix):"",r="object"==typeof e.media&&e.media||{},a="object"==typeof e.root?e.root||null:globalThis.document||null,n="object"==typeof e.theme&&e.theme||{},i={prefix:s,media:r,theme:n,themeMap:"object"==typeof e.themeMap&&e.themeMap||{...le},utils:"object"==typeof e.utils&&e.utils||{}},o=$e(a),l={css:De(i,o),globalCss:Ve(i,o),keyframes:Ge(i,o),createTheme:Ke(i,o),reset(){o.reset(),l.theme.toString()},theme:{},sheet:o,config:i,prefix:s,getCssText:o.toString,toString:o.toString};return String(l.theme=l.createTheme(n)),l}));return t||s.reset(),s},Qe=()=>ae||(ae=Xe()),et=(...e)=>Qe().createTheme(...e),tt=(...e)=>Qe().css(...e),st={default:{colors:{brand:"hsl(153 60.0% 53.0%)",brandAccent:"hsl(154 54.8% 45.1%)",brandButtonText:"white",defaultButtonBackground:"white",defaultButtonBackgroundHover:"#eaeaea",defaultButtonBorder:"lightgray",defaultButtonText:"gray",dividerBackground:"#eaeaea",inputBackground:"transparent",inputBorder:"lightgray",inputBorderHover:"gray",inputBorderFocus:"gray",inputText:"black",inputLabelText:"gray",inputPlaceholder:"darkgray",messageText:"#2b805a",messageBackground:"#e7fcf1",messageBorder:"#d0f3e1",messageTextDanger:"#ff6369",messageBackgroundDanger:"#fff8f8",messageBorderDanger:"#822025",anchorTextColor:"gray",anchorTextHoverColor:"darkgray"},space:{spaceSmall:"4px",spaceMedium:"8px",spaceLarge:"16px",labelBottomMargin:"8px",anchorBottomMargin:"4px",emailInputSpacing:"4px",socialAuthSpacing:"4px",buttonPadding:"10px 15px",inputPadding:"10px 15px"},fontSizes:{baseBodySize:"13px",baseInputSize:"14px",baseLabelSize:"14px",baseButtonSize:"14px"},fonts:{bodyFontFamily:"ui-sans-serif, sans-serif",buttonFontFamily:"ui-sans-serif, sans-serif",inputFontFamily:"ui-sans-serif, sans-serif",labelFontFamily:"ui-sans-serif, sans-serif"},borderWidths:{buttonBorderWidth:"1px",inputBorderWidth:"1px"},radii:{borderRadiusButton:"4px",buttonBorderRadius:"4px",inputBorderRadius:"4px"}},dark:{colors:{brandButtonText:"white",defaultButtonBackground:"#2e2e2e",defaultButtonBackgroundHover:"#3e3e3e",defaultButtonBorder:"#3e3e3e",defaultButtonText:"white",dividerBackground:"#2e2e2e",inputBackground:"#1e1e1e",inputBorder:"#3e3e3e",inputBorderHover:"gray",inputBorderFocus:"gray",inputText:"white",inputPlaceholder:"darkgray",messageText:"#85e0b7",messageBackground:"#072719",messageBorder:"#2b805a",messageBackgroundDanger:"#1f1315"}}},rt="sign_in",at="sign_up",nt="forgotten_password",it="magic_link",ot="update_password",lt="verify_otp",ct={ROOT:"root",SIGN_IN:rt,SIGN_UP:at,FORGOTTEN_PASSWORD:nt,MAGIC_LINK:it,UPDATE_PASSWORD:ot,anchor:"ui-anchor",button:"ui-button",container:"ui-container",divider:"ui-divider",input:"ui-input",label:"ui-label",loader:"ui-loader",message:"ui-message"};function dt(e,t,s){var r,a;const n=[],i=ct[e];return n.push((null==s?void 0:s.prependedClassName)?(null==s?void 0:s.prependedClassName)+"_"+i:"supabase-auth-ui_"+i),(null==(r=null==s?void 0:s.className)?void 0:r[e])&&n.push(null==(a=null==s?void 0:s.className)?void 0:a[e]),void 0!==(null==s?void 0:s.extend)&&!0!==(null==s?void 0:s.extend)||n.push(t),n}function ut(e,t){let s;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(Array.isArray(t))for(s=0;s<t.length;s++)e[s]=ut(e[s],t[s]);else for(s in t)e[s]=ut(e[s],t[s]);return e}return t}function ht(e,...t){let s=t.length;for(let r=0;r<s;r++)e=ut(e,t[r]);return e}var mt={sign_up:{email_label:"Email address",password_label:"Create a Password",email_input_placeholder:"Your email address",password_input_placeholder:"Your password",button_label:"Sign up",loading_button_label:"Signing up ...",social_provider_text:"Sign in with {{provider}}",link_text:"Don't have an account? Sign up",confirmation_text:"Check your email for the confirmation link"},sign_in:{email_label:"Email address",password_label:"Your Password",email_input_placeholder:"Your email address",password_input_placeholder:"Your password",button_label:"Sign in",loading_button_label:"Signing in ...",social_provider_text:"Sign in with {{provider}}",link_text:"Already have an account? Sign in"},magic_link:{email_input_label:"Email address",email_input_placeholder:"Your email address",button_label:"Send Magic Link",loading_button_label:"Sending Magic Link ...",link_text:"Send a magic link email",confirmation_text:"Check your email for the magic link"},forgotten_password:{email_label:"Email address",password_label:"Your Password",email_input_placeholder:"Your email address",button_label:"Send reset password instructions",loading_button_label:"Sending reset instructions ...",link_text:"Forgot your password?",confirmation_text:"Check your email for the password reset link"},update_password:{password_label:"New password",password_input_placeholder:"Your new password",button_label:"Update password",loading_button_label:"Updating password ...",confirmation_text:"Your password has been updated"},verify_otp:{email_input_label:"Email address",email_input_placeholder:"Your email address",phone_input_label:"Phone number",phone_input_placeholder:"Your phone number",token_input_label:"Token",token_input_placeholder:"Your Otp token",button_label:"Verify token",loading_button_label:"Signing in ..."}};const pt=tt({fontFamily:"$bodyFontFamily",fontSize:"$baseBodySize",marginBottom:"$anchorBottomMargin",color:"$anchorTextColor",display:"block",textAlign:"center",textDecoration:"underline","&:hover":{color:"$anchorTextHoverColor"}}),gt=({children:e,appearance:t,...r})=>{var a;const n=dt("anchor",pt(),t);return s.createElement("a",{...r,style:null==(a=null==t?void 0:t.style)?void 0:a.anchor,className:n.join(" ")},e)},ft=tt({fontFamily:"$buttonFontFamily",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",borderRadius:"$borderRadiusButton",fontSize:"$baseButtonSize",padding:"$buttonPadding",cursor:"pointer",borderWidth:"$buttonBorderWidth",borderStyle:"solid",width:"100%",transitionProperty:"background-color",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transitionDuration:"100ms","&:disabled":{opacity:.7,cursor:"unset"},variants:{color:{default:{backgroundColor:"$defaultButtonBackground",color:"$defaultButtonText",borderColor:"$defaultButtonBorder","&:hover:not(:disabled)":{backgroundColor:"$defaultButtonBackgroundHover"}},primary:{backgroundColor:"$brand",color:"$brandButtonText",borderColor:"$brandAccent","&:hover:not(:disabled)":{backgroundColor:"$brandAccent"}}}}}),yt=({children:e,color:t="default",appearance:r,icon:a,loading:n=!1,...i})=>{var o;const l=dt("button",ft({color:t}),r);return s.createElement("button",{...i,style:null==(o=null==r?void 0:r.style)?void 0:o.button,className:l.join(" "),disabled:n},a,e)},bt=tt({display:"flex",gap:"4px",variants:{direction:{horizontal:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(48px, 1fr))"},vertical:{flexDirection:"column",margin:"8px 0"}},gap:{small:{gap:"4px"},medium:{gap:"8px"},large:{gap:"16px"}}}}),xt=({children:e,appearance:t,...r})=>{var a;const n=dt("container",bt({direction:r.direction,gap:r.gap}),t);return s.createElement("div",{...r,style:null==(a=null==t?void 0:t.style)?void 0:a.container,className:n.join(" ")},e)},vt=tt({background:"$dividerBackground",display:"block",margin:"16px 0",height:"1px",width:"100%"}),wt=({children:e,appearance:t,...r})=>{var a;const n=dt("divider",vt(),t);return s.createElement("div",{...r,style:null==(a=null==t?void 0:t.style)?void 0:a.divider,className:n.join(" ")})},jt=tt({fontFamily:"$inputFontFamily",background:"$inputBackground",borderRadius:"$inputBorderRadius",padding:"$inputPadding",cursor:"text",borderWidth:"$inputBorderWidth",borderColor:"$inputBorder",borderStyle:"solid",fontSize:"$baseInputSize",width:"100%",color:"$inputText",boxSizing:"border-box","&:hover":{borderColor:"$inputBorderHover",outline:"none"},"&:focus":{borderColor:"$inputBorderFocus",outline:"none"},"&::placeholder":{color:"$inputPlaceholder",letterSpacing:"initial"},transitionProperty:"background-color, border",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transitionDuration:"100ms",variants:{type:{default:{letterSpacing:"0px"},password:{letterSpacing:"0px"}}}}),_t=({children:e,appearance:t,...r})=>{var a;const n=dt("input",jt({type:"password"===r.type?"password":"default"}),t);return s.createElement("input",{...r,style:null==(a=null==t?void 0:t.style)?void 0:a.input,className:n.join(" ")},e)},kt=tt({fontFamily:"$labelFontFamily",fontSize:"$baseLabelSize",marginBottom:"$labelBottomMargin",color:"$inputLabelText",display:"block"}),St=({children:e,appearance:t,...r})=>{var a;const n=dt("label",kt(),t);return s.createElement("label",{...r,style:null==(a=null==t?void 0:t.style)?void 0:a.label,className:n.join(" ")},e)},Nt=tt({fontFamily:"$bodyFontFamily",fontSize:"$baseInputSize",marginBottom:"$labelBottomMargin",display:"block",textAlign:"center",borderRadius:"0.375rem",padding:"1.5rem 1rem",lineHeight:"1rem",color:"$messageText",backgroundColor:"$messageBackground",border:"1px solid $messageBorder",variants:{color:{danger:{color:"$messageTextDanger",backgroundColor:"$messageBackgroundDanger",border:"1px solid $messageBorderDanger"}}}}),Et=({children:e,appearance:t,...r})=>{var a;const n=dt("message",Nt({color:r.color}),t);return s.createElement("span",{...r,style:null==(a=null==t?void 0:t.style)?void 0:a.message,className:n.join(" ")},e)};function Tt({setAuthView:t=()=>{},supabaseClient:r,redirectTo:a,i18n:n,appearance:i,showLinks:o=!1}){var l;const[c,d]=e.useState(""),[u,h]=e.useState(""),[m,p]=e.useState(""),[g,f]=e.useState(!1),y=null==n?void 0:n.magic_link;return s.createElement("form",{id:"auth-magic-link",onSubmit:async e=>{var t,s;if(e.preventDefault(),h(""),p(""),f(!0),0===c.length)return h(null==(t=null==n?void 0:n.magic_link)?void 0:t.empty_email_address),void f(!1);const{error:i}=await r.auth.signInWithOtp({email:c,options:{emailRedirectTo:a}});i?h(i.message):p(null==(s=null==n?void 0:n.magic_link)?void 0:s.confirmation_text),f(!1)}},s.createElement(xt,{gap:"large",direction:"vertical",appearance:i},s.createElement("div",null,s.createElement(St,{htmlFor:"email",appearance:i},null==y?void 0:y.email_input_label),s.createElement(_t,{id:"email",name:"email",type:"email",autoFocus:!0,placeholder:null==y?void 0:y.email_input_placeholder,onChange:e=>{h&&h(""),d(e.target.value)},appearance:i})),s.createElement(yt,{color:"primary",type:"submit",loading:g,appearance:i},g?null==y?void 0:y.loading_button_label:null==y?void 0:y.button_label),o&&s.createElement(gt,{href:"#auth-sign-in",onClick:e=>{e.preventDefault(),t(rt)},appearance:i},null==(l=null==n?void 0:n.sign_in)?void 0:l.link_text),m&&s.createElement(Et,{appearance:i},m),u&&s.createElement(Et,{color:"danger",appearance:i},u)))}const Ct=tt({width:"21px",height:"21px"}),Pt=({provider:e})=>"google"==e?Bt():"facebook"==e?It():"twitter"==e?At():"apple"==e?$t():"github"==e?Ot():"gitlab"==e?Rt():"bitbucket"==e?Lt():"discord"==e?Dt():"azure"==e?Ut():"keycloak"==e?Mt():"linkedin"==e?zt():"notion"==e?Ft():"slack"==e?qt():"spotify"==e?Wt():"twitch"==e?Vt():"workos"==e?Ht():"kakao"==e?Gt():null,Bt=()=>s.createElement("svg",{className:Ct(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},s.createElement("path",{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),s.createElement("path",{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),s.createElement("path",{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),s.createElement("path",{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"})),It=()=>s.createElement("svg",{className:Ct(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},s.createElement("path",{fill:"#039be5",d:"M24 5A19 19 0 1 0 24 43A19 19 0 1 0 24 5Z"}),s.createElement("path",{fill:"#fff",d:"M26.572,29.036h4.917l0.772-4.995h-5.69v-2.73c0-2.075,0.678-3.915,2.619-3.915h3.119v-4.359c-0.548-0.074-1.707-0.236-3.897-0.236c-4.573,0-7.254,2.415-7.254,7.917v3.323h-4.701v4.995h4.701v13.729C22.089,42.905,23.032,43,24,43c0.875,0,1.729-0.08,2.572-0.194V29.036z"})),At=()=>s.createElement("svg",{className:Ct(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},s.createElement("path",{fill:"#03A9F4",d:"M42,12.429c-1.323,0.586-2.746,0.977-4.247,1.162c1.526-0.906,2.7-2.351,3.251-4.058c-1.428,0.837-3.01,1.452-4.693,1.776C34.967,9.884,33.05,9,30.926,9c-4.08,0-7.387,3.278-7.387,7.32c0,0.572,0.067,1.129,0.193,1.67c-6.138-0.308-11.582-3.226-15.224-7.654c-0.64,1.082-1,2.349-1,3.686c0,2.541,1.301,4.778,3.285,6.096c-1.211-0.037-2.351-0.374-3.349-0.914c0,0.022,0,0.055,0,0.086c0,3.551,2.547,6.508,5.923,7.181c-0.617,0.169-1.269,0.263-1.941,0.263c-0.477,0-0.942-0.054-1.392-0.135c0.94,2.902,3.667,5.023,6.898,5.086c-2.528,1.96-5.712,3.134-9.174,3.134c-0.598,0-1.183-0.034-1.761-0.104C9.268,36.786,13.152,38,17.321,38c13.585,0,21.017-11.156,21.017-20.834c0-0.317-0.01-0.633-0.025-0.945C39.763,15.197,41.013,13.905,42,12.429"})),$t=()=>s.createElement("svg",{className:Ct(),fill:"gray",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"21px",height:"21px"}," ",s.createElement("path",{d:"M 15.904297 1.078125 C 15.843359 1.06875 15.774219 1.0746094 15.699219 1.0996094 C 14.699219 1.2996094 13.600391 1.8996094 12.900391 2.5996094 C 12.300391 3.1996094 11.800781 4.1996094 11.800781 5.0996094 C 11.800781 5.2996094 11.999219 5.5 12.199219 5.5 C 13.299219 5.4 14.399609 4.7996094 15.099609 4.0996094 C 15.699609 3.2996094 16.199219 2.4 16.199219 1.5 C 16.199219 1.275 16.087109 1.10625 15.904297 1.078125 z M 16.199219 5.4003906 C 14.399219 5.4003906 13.600391 6.5 12.400391 6.5 C 11.100391 6.5 9.9003906 5.5 8.4003906 5.5 C 6.3003906 5.5 3.0996094 7.4996094 3.0996094 12.099609 C 2.9996094 16.299609 6.8 21 9 21 C 10.3 21 10.600391 20.199219 12.400391 20.199219 C 14.200391 20.199219 14.600391 21 15.900391 21 C 17.400391 21 18.500391 19.399609 19.400391 18.099609 C 19.800391 17.399609 20.100391 17.000391 20.400391 16.400391 C 20.600391 16.000391 20.4 15.600391 20 15.400391 C 17.4 14.100391 16.900781 9.9003906 19.800781 8.4003906 C 20.300781 8.1003906 20.4 7.4992188 20 7.1992188 C 18.9 6.1992187 17.299219 5.4003906 16.199219 5.4003906 z"})),Ot=()=>s.createElement("svg",{className:Ct(),fill:"gray",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30",width:"21px",height:"21px"}," ",s.createElement("path",{d:"M15,3C8.373,3,3,8.373,3,15c0,5.623,3.872,10.328,9.092,11.63C12.036,26.468,12,26.28,12,26.047v-2.051 c-0.487,0-1.303,0-1.508,0c-0.821,0-1.551-0.353-1.905-1.009c-0.393-0.729-0.461-1.844-1.435-2.526 c-0.289-0.227-0.069-0.486,0.264-0.451c0.615,0.174,1.125,0.596,1.605,1.222c0.478,0.627,0.703,0.769,1.596,0.769 c0.433,0,1.081-0.025,1.691-0.121c0.328-0.833,0.895-1.6,1.588-1.962c-3.996-0.411-5.903-2.399-5.903-5.098 c0-1.162,0.495-2.286,1.336-3.233C9.053,10.647,8.706,8.73,9.435,8c1.798,0,2.885,1.166,3.146,1.481C13.477,9.174,14.461,9,15.495,9 c1.036,0,2.024,0.174,2.922,0.483C18.675,9.17,19.763,8,21.565,8c0.732,0.731,0.381,2.656,0.102,3.594 c0.836,0.945,1.328,2.066,1.328,3.226c0,2.697-1.904,4.684-5.894,5.097C18.199,20.49,19,22.1,19,23.313v2.734 c0,0.104-0.023,0.179-0.035,0.268C23.641,24.676,27,20.236,27,15C27,8.373,21.627,3,15,3z"})),Rt=()=>s.createElement("svg",{className:Ct(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},s.createElement("path",{fill:"#e53935",d:"M24 43L16 20 32 20z"}),s.createElement("path",{fill:"#ff7043",d:"M24 43L42 20 32 20z"}),s.createElement("path",{fill:"#e53935",d:"M37 5L42 20 32 20z"}),s.createElement("path",{fill:"#ffa726",d:"M24 43L42 20 45 28z"}),s.createElement("path",{fill:"#ff7043",d:"M24 43L6 20 16 20z"}),s.createElement("path",{fill:"#e53935",d:"M11 5L6 20 16 20z"}),s.createElement("path",{fill:"#ffa726",d:"M24 43L6 20 3 28z"})),Lt=()=>s.createElement("svg",{className:Ct(),xmlns:"http://www.w3.org/2000/svg",width:"512",height:"512",viewBox:"0 0 62.42 62.42"},s.createElement("defs",null,s.createElement("linearGradient",{id:"New_Gradient_Swatch_1",x1:"64.01",y1:"30.27",x2:"32.99",y2:"54.48",gradientUnits:"userSpaceOnUse"},s.createElement("stop",{offset:"0.18",stopColor:"#0052cc"}),s.createElement("stop",{offset:"1",stopColor:"#2684ff"}))),s.createElement("title",null,"Bitbucket-blue"),s.createElement("g",{id:"Layer_2","data-name":"Layer 2"},s.createElement("g",{id:"Blue",transform:"translate(0 -3.13)"},s.createElement("path",{d:"M2,6.26A2,2,0,0,0,0,8.58L8.49,60.12a2.72,2.72,0,0,0,2.66,2.27H51.88a2,2,0,0,0,2-1.68L62.37,8.59a2,2,0,0,0-2-2.32ZM37.75,43.51h-13L21.23,25.12H40.9Z",fill:"#2684ff"}),s.createElement("path",{d:"M59.67,25.12H40.9L37.75,43.51h-13L9.4,61.73a2.71,2.71,0,0,0,1.75.66H51.89a2,2,0,0,0,2-1.68Z",fill:"url(#New_Gradient_Swatch_1)"})))),Dt=()=>s.createElement("svg",{className:Ct(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},s.createElement("path",{fill:"#536dfe",d:"M39.248,10.177c-2.804-1.287-5.812-2.235-8.956-2.778c-0.057-0.01-0.114,0.016-0.144,0.068\tc-0.387,0.688-0.815,1.585-1.115,2.291c-3.382-0.506-6.747-0.506-10.059,0c-0.3-0.721-0.744-1.603-1.133-2.291\tc-0.03-0.051-0.087-0.077-0.144-0.068c-3.143,0.541-6.15,1.489-8.956,2.778c-0.024,0.01-0.045,0.028-0.059,0.051\tc-5.704,8.522-7.267,16.835-6.5,25.044c0.003,0.04,0.026,0.079,0.057,0.103c3.763,2.764,7.409,4.442,10.987,5.554\tc0.057,0.017,0.118-0.003,0.154-0.051c0.846-1.156,1.601-2.374,2.248-3.656c0.038-0.075,0.002-0.164-0.076-0.194\tc-1.197-0.454-2.336-1.007-3.432-1.636c-0.087-0.051-0.094-0.175-0.014-0.234c0.231-0.173,0.461-0.353,0.682-0.534\tc0.04-0.033,0.095-0.04,0.142-0.019c7.201,3.288,14.997,3.288,22.113,0c0.047-0.023,0.102-0.016,0.144,0.017\tc0.22,0.182,0.451,0.363,0.683,0.536c0.08,0.059,0.075,0.183-0.012,0.234c-1.096,0.641-2.236,1.182-3.434,1.634\tc-0.078,0.03-0.113,0.12-0.075,0.196c0.661,1.28,1.415,2.498,2.246,3.654c0.035,0.049,0.097,0.07,0.154,0.052\tc3.595-1.112,7.241-2.79,11.004-5.554c0.033-0.024,0.054-0.061,0.057-0.101c0.917-9.491-1.537-17.735-6.505-25.044\tC39.293,10.205,39.272,10.187,39.248,10.177z M16.703,30.273c-2.168,0-3.954-1.99-3.954-4.435s1.752-4.435,3.954-4.435\tc2.22,0,3.989,2.008,3.954,4.435C20.658,28.282,18.906,30.273,16.703,30.273z M31.324,30.273c-2.168,0-3.954-1.99-3.954-4.435\ts1.752-4.435,3.954-4.435c2.22,0,3.989,2.008,3.954,4.435C35.278,28.282,33.544,30.273,31.324,30.273z"})),Ut=()=>s.createElement("svg",{className:Ct(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},s.createElement("linearGradient",{id:"k8yl7~hDat~FaoWq8WjN6a",x1:"-1254.397",x2:"-1261.911",y1:"877.268",y2:"899.466",gradientTransform:"translate(1981.75 -1362.063) scale(1.5625)",gradientUnits:"userSpaceOnUse"},s.createElement("stop",{offset:"0",stopColor:"#114a8b"}),s.createElement("stop",{offset:"1",stopColor:"#0669bc"})),s.createElement("path",{fill:"url(#k8yl7~hDat~FaoWq8WjN6a)",d:"M17.634,6h11.305L17.203,40.773c-0.247,0.733-0.934,1.226-1.708,1.226H6.697 c-0.994,0-1.8-0.806-1.8-1.8c0-0.196,0.032-0.39,0.094-0.576L15.926,7.227C16.173,6.494,16.86,6,17.634,6L17.634,6z"}),s.createElement("path",{fill:"#0078d4",d:"M34.062,29.324H16.135c-0.458-0.001-0.83,0.371-0.831,0.829c0,0.231,0.095,0.451,0.264,0.608 l11.52,10.752C27.423,41.826,27.865,42,28.324,42h10.151L34.062,29.324z"}),s.createElement("linearGradient",{id:"k8yl7~hDat~FaoWq8WjN6b",x1:"-1252.05",x2:"-1253.788",y1:"887.612",y2:"888.2",gradientTransform:"translate(1981.75 -1362.063) scale(1.5625)",gradientUnits:"userSpaceOnUse"},s.createElement("stop",{offset:"0",stopOpacity:".3"}),s.createElement("stop",{offset:".071",stopOpacity:".2"}),s.createElement("stop",{offset:".321",stopOpacity:".1"}),s.createElement("stop",{offset:".623",stopOpacity:".05"}),s.createElement("stop",{offset:"1",stopOpacity:"0"})),s.createElement("path",{fill:"url(#k8yl7~hDat~FaoWq8WjN6b)",d:"M17.634,6c-0.783-0.003-1.476,0.504-1.712,1.25L5.005,39.595 c-0.335,0.934,0.151,1.964,1.085,2.299C6.286,41.964,6.493,42,6.702,42h9.026c0.684-0.122,1.25-0.603,1.481-1.259l2.177-6.416 l7.776,7.253c0.326,0.27,0.735,0.419,1.158,0.422h10.114l-4.436-12.676l-12.931,0.003L28.98,6H17.634z"}),s.createElement("linearGradient",{id:"k8yl7~hDat~FaoWq8WjN6c",x1:"-1252.952",x2:"-1244.704",y1:"876.6",y2:"898.575",gradientTransform:"translate(1981.75 -1362.063) scale(1.5625)",gradientUnits:"userSpaceOnUse"},s.createElement("stop",{offset:"0",stopColor:"#3ccbf4"}),s.createElement("stop",{offset:"1",stopColor:"#2892df"})),s.createElement("path",{fill:"url(#k8yl7~hDat~FaoWq8WjN6c)",d:"M32.074,7.225C31.827,6.493,31.141,6,30.368,6h-12.6c0.772,0,1.459,0.493,1.705,1.224 l10.935,32.399c0.318,0.942-0.188,1.963-1.13,2.281C29.093,41.968,28.899,42,28.703,42h12.6c0.994,0,1.8-0.806,1.8-1.801 c0-0.196-0.032-0.39-0.095-0.575L32.074,7.225z"})),Mt=()=>s.createElement("svg",{className:Ct(),width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M472.136 163.959H408.584C407.401 163.959 406.218 163.327 405.666 162.3L354.651 73.6591C354.02 72.632 352.916 72 351.654 72H143.492C142.309 72 141.126 72.632 140.574 73.6591L87.5084 165.618L36.414 254.259C35.862 255.286 35.862 256.55 36.414 257.656L87.5084 346.297L140.495 438.335C141.047 439.362 142.23 440.073 143.413 439.994H351.654C352.837 439.994 354.02 439.362 354.651 438.335L405.745 349.694C406.297 348.667 407.48 347.956 408.663 348.035H472.215C474.344 348.035 476 346.297 476 344.243V167.83C475.921 165.697 474.186 163.959 472.136 163.959ZM228.728 349.694L212.721 377.345C212.485 377.74 212.091 378.135 211.696 378.372C211.223 378.609 210.75 378.767 210.198 378.767H178.422C177.318 378.767 176.293 378.214 175.82 377.187L128.431 294.787L123.779 286.65L106.748 257.498C106.511 257.103 106.353 256.629 106.432 256.076C106.432 255.602 106.59 255.049 106.827 254.654L123.937 224.949L175.899 134.886C176.451 133.938 177.476 133.306 178.501 133.306H210.198C210.75 133.306 211.302 133.464 211.854 133.701C212.248 133.938 212.643 134.254 212.879 134.728L228.886 162.537C229.359 163.485 229.28 164.67 228.728 165.539L177.397 254.654C177.16 255.049 177.081 255.523 177.081 255.918C177.081 256.392 177.239 256.787 177.397 257.182L228.728 346.218C229.438 347.403 229.359 348.667 228.728 349.694V349.694ZM388.083 257.498L371.051 286.65L366.399 294.787L319.011 377.187C318.459 378.135 317.512 378.767 316.409 378.767H284.632C284.08 378.767 283.607 378.609 283.134 378.372C282.74 378.135 282.346 377.819 282.109 377.345L266.103 349.694C265.393 348.667 265.393 347.403 266.024 346.376L317.355 257.34C317.591 256.945 317.67 256.471 317.67 256.076C317.67 255.602 317.513 255.207 317.355 254.812L266.024 165.697C265.472 164.749 265.393 163.643 265.866 162.695L281.873 134.886C282.109 134.491 282.503 134.096 282.898 133.859C283.371 133.543 283.923 133.464 284.553 133.464H316.409C317.512 133.464 318.538 134.017 319.011 135.044L370.972 225.107L388.083 254.812C388.319 255.286 388.477 255.76 388.477 256.234C388.477 256.55 388.319 257.024 388.083 257.498V257.498Z",fill:"#008AAA"})),zt=()=>s.createElement("svg",{className:Ct(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},s.createElement("path",{fill:"#0288D1",d:"M42,37c0,2.762-2.238,5-5,5H11c-2.761,0-5-2.238-5-5V11c0-2.762,2.239-5,5-5h26c2.762,0,5,2.238,5,5V37z"}),s.createElement("path",{fill:"#FFF",d:"M12 19H17V36H12zM14.485 17h-.028C12.965 17 12 15.888 12 14.499 12 13.08 12.995 12 14.514 12c1.521 0 2.458 1.08 2.486 2.499C17 15.887 16.035 17 14.485 17zM36 36h-5v-9.099c0-2.198-1.225-3.698-3.192-3.698-1.501 0-2.313 1.012-2.707 1.99C24.957 25.543 25 26.511 25 27v9h-5V19h5v2.616C25.721 20.5 26.85 19 29.738 19c3.578 0 6.261 2.25 6.261 7.274L36 36 36 36z"})),Ft=()=>s.createElement("svg",{className:Ct(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px",fillRule:"evenodd",clipRule:"evenodd"},s.createElement("path",{fill:"#fff",fillRule:"evenodd",d:"M11.553,11.099c1.232,1.001,1.694,0.925,4.008,0.77 l21.812-1.31c0.463,0,0.078-0.461-0.076-0.538l-3.622-2.619c-0.694-0.539-1.619-1.156-3.391-1.002l-21.12,1.54 c-0.77,0.076-0.924,0.461-0.617,0.77L11.553,11.099z",clipRule:"evenodd"}),s.createElement("path",{fill:"#fff",fillRule:"evenodd",d:"M12.862,16.182v22.95c0,1.233,0.616,1.695,2.004,1.619 l23.971-1.387c1.388-0.076,1.543-0.925,1.543-1.927V14.641c0-1-0.385-1.54-1.234-1.463l-25.05,1.463 C13.171,14.718,12.862,15.181,12.862,16.182L12.862,16.182z",clipRule:"evenodd"}),s.createElement("path",{fill:"#424242",fillRule:"evenodd",d:"M11.553,11.099c1.232,1.001,1.694,0.925,4.008,0.77 l21.812-1.31c0.463,0,0.078-0.461-0.076-0.538l-3.622-2.619c-0.694-0.539-1.619-1.156-3.391-1.002l-21.12,1.54 c-0.77,0.076-0.924,0.461-0.617,0.77L11.553,11.099z M12.862,16.182v22.95c0,1.233,0.616,1.695,2.004,1.619l23.971-1.387 c1.388-0.076,1.543-0.925,1.543-1.927V14.641c0-1-0.385-1.54-1.234-1.463l-25.05,1.463C13.171,14.718,12.862,15.181,12.862,16.182 L12.862,16.182z M36.526,17.413c0.154,0.694,0,1.387-0.695,1.465l-1.155,0.23v16.943c-1.003,0.539-1.928,0.847-2.698,0.847 c-1.234,0-1.543-0.385-2.467-1.54l-7.555-11.86v11.475l2.391,0.539c0,0,0,1.386-1.929,1.386l-5.317,0.308 c-0.154-0.308,0-1.078,0.539-1.232l1.388-0.385V20.418l-1.927-0.154c-0.155-0.694,0.23-1.694,1.31-1.772l5.704-0.385l7.862,12.015 V19.493l-2.005-0.23c-0.154-0.848,0.462-1.464,1.233-1.54L36.526,17.413z M7.389,5.862l21.968-1.618 c2.698-0.231,3.392-0.076,5.087,1.155l7.013,4.929C42.614,11.176,43,11.407,43,12.33v27.032c0,1.694-0.617,2.696-2.775,2.849 l-25.512,1.541c-1.62,0.077-2.391-0.154-3.239-1.232l-5.164-6.7C5.385,34.587,5,33.664,5,32.585V8.556 C5,7.171,5.617,6.015,7.389,5.862z",clipRule:"evenodd"})),qt=()=>s.createElement("svg",{className:Ct(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},s.createElement("path",{fill:"#33d375",d:"M33,8c0-2.209-1.791-4-4-4s-4,1.791-4,4c0,1.254,0,9.741,0,11c0,2.209,1.791,4,4,4s4-1.791,4-4\tC33,17.741,33,9.254,33,8z"}),s.createElement("path",{fill:"#33d375",d:"M43,19c0,2.209-1.791,4-4,4c-1.195,0-4,0-4,0s0-2.986,0-4c0-2.209,1.791-4,4-4S43,16.791,43,19z"}),s.createElement("path",{fill:"#40c4ff",d:"M8,14c-2.209,0-4,1.791-4,4s1.791,4,4,4c1.254,0,9.741,0,11,0c2.209,0,4-1.791,4-4s-1.791-4-4-4\tC17.741,14,9.254,14,8,14z"}),s.createElement("path",{fill:"#40c4ff",d:"M19,4c2.209,0,4,1.791,4,4c0,1.195,0,4,0,4s-2.986,0-4,0c-2.209,0-4-1.791-4-4S16.791,4,19,4z"}),s.createElement("path",{fill:"#e91e63",d:"M14,39.006C14,41.212,15.791,43,18,43s4-1.788,4-3.994c0-1.252,0-9.727,0-10.984\tc0-2.206-1.791-3.994-4-3.994s-4,1.788-4,3.994C14,29.279,14,37.754,14,39.006z"}),s.createElement("path",{fill:"#e91e63",d:"M4,28.022c0-2.206,1.791-3.994,4-3.994c1.195,0,4,0,4,0s0,2.981,0,3.994c0,2.206-1.791,3.994-4,3.994\tS4,30.228,4,28.022z"}),s.createElement("path",{fill:"#ffc107",d:"M39,33c2.209,0,4-1.791,4-4s-1.791-4-4-4c-1.254,0-9.741,0-11,0c-2.209,0-4,1.791-4,4s1.791,4,4,4\tC29.258,33,37.746,33,39,33z"}),s.createElement("path",{fill:"#ffc107",d:"M28,43c-2.209,0-4-1.791-4-4c0-1.195,0-4,0-4s2.986,0,4,0c2.209,0,4,1.791,4,4S30.209,43,28,43z"})),Wt=()=>s.createElement("svg",{className:Ct(),width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M255.498 31.0034C131.513 31.0034 31 131.515 31 255.502C31 379.492 131.513 480 255.498 480C379.497 480 480 379.495 480 255.502C480 131.522 379.497 31.0135 255.495 31.0135L255.498 31V31.0034ZM358.453 354.798C354.432 361.391 345.801 363.486 339.204 359.435C286.496 327.237 220.139 319.947 141.993 337.801C134.463 339.516 126.957 334.798 125.24 327.264C123.516 319.731 128.217 312.225 135.767 310.511C221.284 290.972 294.639 299.384 353.816 335.549C360.413 339.596 362.504 348.2 358.453 354.798ZM385.932 293.67C380.864 301.903 370.088 304.503 361.858 299.438C301.512 262.345 209.528 251.602 138.151 273.272C128.893 276.067 119.118 270.851 116.309 261.61C113.521 252.353 118.74 242.597 127.981 239.782C209.512 215.044 310.87 227.026 380.17 269.612C388.4 274.68 391 285.456 385.935 293.676V293.673L385.932 293.67ZM388.293 230.016C315.935 187.039 196.56 183.089 127.479 204.055C116.387 207.42 104.654 201.159 101.293 190.063C97.9326 178.964 104.189 167.241 115.289 163.87C194.59 139.796 326.418 144.446 409.723 193.902C419.722 199.826 422.995 212.71 417.068 222.675C411.168 232.653 398.247 235.943 388.303 230.016H388.293V230.016Z",fill:"#1ED760"})),Vt=()=>s.createElement("svg",{className:Ct(),width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M416 240L352 304H288L232 360V304H160V64H416V240Z",fill:"white"}),s.createElement("path",{d:"M144 32L64 112V400H160V480L240 400H304L448 256V32H144ZM416 240L352 304H288L232 360V304H160V64H416V240Z",fill:"#9146FF"}),s.createElement("path",{d:"M368 120H336V216H368V120Z",fill:"#9146FF"}),s.createElement("path",{d:"M280 120H248V216H280V120Z",fill:"#9146FF"})),Ht=()=>s.createElement("svg",{className:Ct(),width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M33 256.043C33 264.556 35.3159 273.069 39.4845 280.202L117.993 415.493C126.098 429.298 138.373 440.572 153.657 445.634C183.764 455.528 214.797 442.873 229.618 417.333L248.609 384.661L173.806 256.043L252.777 119.831L271.768 87.1591C277.557 77.2654 284.968 69.4424 294 63H285.894H172.185C150.878 63 131.193 74.2742 120.54 92.6812L39.7161 231.884C35.3159 239.016 33 247.53 33 256.043Z",fill:"#6363F1"}),s.createElement("path",{d:"M480 256.058C480 247.539 477.684 239.021 473.516 231.883L393.849 94.6596C379.028 69.3331 347.995 56.4396 317.888 66.34C302.603 71.4053 290.329 82.6871 282.224 96.5015L264.391 127.354L339.194 256.058L260.223 392.131L241.232 424.825C235.443 434.495 228.032 442.553 219 449H227.106H340.815C362.122 449 381.807 437.718 392.46 419.299L473.284 280.003C477.684 272.866 480 264.577 480 256.058Z",fill:"#6363F1"})),Gt=()=>s.createElement("svg",{className:Ct(),xmlns:"http://www.w3.org/2000/svg",width:"2500",height:"2500",viewBox:"0 0 256 256"},s.createElement("path",{fill:"#FFE812",d:"M256 236c0 11.046-8.954 20-20 20H20c-11.046 0-20-8.954-20-20V20C0 8.954 8.954 0 20 0h216c11.046 0 20 8.954 20 20v216z"}),s.createElement("path",{d:"M128 36C70.562 36 24 72.713 24 118c0 29.279 19.466 54.97 48.748 69.477-1.593 5.494-10.237 35.344-10.581 37.689 0 0-.207 1.762.934 2.434s2.483.15 2.483.15c3.272-.457 37.943-24.811 43.944-29.04 5.995.849 12.168 1.29 18.472 1.29 57.438 0 104-36.712 104-82 0-45.287-46.562-82-104-82z"}),s.createElement("path",{fill:"#FFE812",d:"M70.5 146.625c-3.309 0-6-2.57-6-5.73V105.25h-9.362c-3.247 0-5.888-2.636-5.888-5.875s2.642-5.875 5.888-5.875h30.724c3.247 0 5.888 2.636 5.888 5.875s-2.642 5.875-5.888 5.875H76.5v35.645c0 3.16-2.691 5.73-6 5.73zM123.112 146.547c-2.502 0-4.416-1.016-4.993-2.65l-2.971-7.778-18.296-.001-2.973 7.783c-.575 1.631-2.488 2.646-4.99 2.646a9.155 9.155 0 0 1-3.814-.828c-1.654-.763-3.244-2.861-1.422-8.52l14.352-37.776c1.011-2.873 4.082-5.833 7.99-5.922 3.919.088 6.99 3.049 8.003 5.928l14.346 37.759c1.826 5.672.236 7.771-1.418 8.532a9.176 9.176 0 0 1-3.814.827c-.001 0 0 0 0 0zm-11.119-21.056L106 108.466l-5.993 17.025h11.986zM138 145.75c-3.171 0-5.75-2.468-5.75-5.5V99.5c0-3.309 2.748-6 6.125-6s6.125 2.691 6.125 6v35.25h12.75c3.171 0 5.75 2.468 5.75 5.5s-2.579 5.5-5.75 5.5H138zM171.334 146.547c-3.309 0-6-2.691-6-6V99.5c0-3.309 2.691-6 6-6s6 2.691 6 6v12.896l16.74-16.74c.861-.861 2.044-1.335 3.328-1.335 1.498 0 3.002.646 4.129 1.772 1.051 1.05 1.678 2.401 1.764 3.804.087 1.415-.384 2.712-1.324 3.653l-13.673 13.671 14.769 19.566a5.951 5.951 0 0 1 1.152 4.445 5.956 5.956 0 0 1-2.328 3.957 5.94 5.94 0 0 1-3.609 1.211 5.953 5.953 0 0 1-4.793-2.385l-14.071-18.644-2.082 2.082v13.091a6.01 6.01 0 0 1-6.002 6.003z"}));function Jt({supabaseClient:t,socialLayout:r="vertical",providers:a=["github","google","azure"],providerScopes:n,queryParams:i,redirectTo:o,onlyThirdPartyProviders:l=!0,view:c="sign_in",i18n:d,appearance:u}){const[h,m]=e.useState(!1),[p,g]=e.useState(""),f="vertical"===r,y="magic_link"===c?"sign_in":c;function b(e){const t=e.toLowerCase();return e.charAt(0).toUpperCase()+t.slice(1)}return s.createElement(s.Fragment,null,a&&a.length>0&&s.createElement(s.Fragment,null,s.createElement(xt,{gap:"large",direction:"vertical",appearance:u},s.createElement(xt,{direction:f?"vertical":"horizontal",gap:f?"small":"medium",appearance:u},a.map((e=>{var r,a,l;return s.createElement(yt,{key:e,color:"default",loading:h,onClick:()=>(async e=>{m(!0);const{error:s}=await t.auth.signInWithOAuth({provider:e,options:{redirectTo:o,scopes:null==n?void 0:n[e],queryParams:i}});s&&g(s.message),m(!1)})(e),appearance:u},s.createElement(Pt,{provider:e}),f&&(a=null==(r=null==d?void 0:d[y])?void 0:r.social_provider_text,l={provider:b(e)},a.replace(/{{(\w+)}}/g,((e,t)=>l.hasOwnProperty(t)?l[t]:e))))})))),!l&&s.createElement(wt,{appearance:u})))}function Yt({authView:t="sign_in",defaultEmail:r="",defaultPassword:a="",setAuthView:n=()=>{},setDefaultEmail:i=e=>{},setDefaultPassword:o=e=>{},supabaseClient:l,showLinks:c=!1,redirectTo:d,additionalData:u,magicLink:h,i18n:m,appearance:p,children:g}){var f,y,b,x;const v=e.useRef(!0),[w,j]=e.useState(r),[_,k]=e.useState(a),[S,N]=e.useState(""),[E,T]=e.useState(!1),[C,P]=e.useState("");e.useEffect((()=>(v.current=!0,j(r),k(a),()=>{v.current=!1})),[t]);const B=e=>{i(w),o(_),n(e)},I=null==m?void 0:m[t];return s.createElement("form",{id:"sign_in"===t?"auth-sign-in":"auth-sign-up",onSubmit:async e=>{var s;switch(e.preventDefault(),N(""),T(!0),t){case"sign_in":const{error:e}=await l.auth.signInWithPassword({email:w,password:_});e&&N(e.message);break;case"sign_up":let t={emailRedirectTo:d};u&&(t.data=u);const{data:{user:r,session:a},error:n}=await l.auth.signUp({email:w,password:_,options:t});n?N(n.message):r&&!a&&P(null==(s=null==m?void 0:m.sign_up)?void 0:s.confirmation_text)}v.current&&T(!1)},autoComplete:"on",style:{width:"100%"}},s.createElement(xt,{direction:"vertical",gap:"large",appearance:p},s.createElement(xt,{direction:"vertical",gap:"large",appearance:p},s.createElement("div",null,s.createElement(St,{htmlFor:"email",appearance:p},null==I?void 0:I.email_label),s.createElement(_t,{id:"email",type:"email",name:"email",placeholder:null==I?void 0:I.email_input_placeholder,defaultValue:w,onChange:e=>j(e.target.value),autoComplete:"email",appearance:p})),s.createElement("div",null,s.createElement(St,{htmlFor:"password",appearance:p},null==I?void 0:I.password_label),s.createElement(_t,{id:"password",type:"password",name:"password",placeholder:null==I?void 0:I.password_input_placeholder,defaultValue:_,onChange:e=>k(e.target.value),autoComplete:"sign_in"===t?"current-password":"new-password",appearance:p})),g),s.createElement(yt,{type:"submit",color:"primary",loading:E,appearance:p},E?null==I?void 0:I.loading_button_label:null==I?void 0:I.button_label),c&&s.createElement(xt,{direction:"vertical",gap:"small",appearance:p},t===rt&&h&&s.createElement(gt,{href:"#auth-magic-link",onClick:e=>{e.preventDefault(),n(it)},appearance:p},null==(f=null==m?void 0:m.magic_link)?void 0:f.link_text),t===rt&&s.createElement(gt,{href:"#auth-forgot-password",onClick:e=>{e.preventDefault(),n(nt)},appearance:p},null==(y=null==m?void 0:m.forgotten_password)?void 0:y.link_text),t===rt?s.createElement(gt,{href:"#auth-sign-up",onClick:e=>{e.preventDefault(),B(at)},appearance:p},null==(b=null==m?void 0:m.sign_up)?void 0:b.link_text):s.createElement(gt,{href:"#auth-sign-in",onClick:e=>{e.preventDefault(),B(rt)},appearance:p},null==(x=null==m?void 0:m.sign_in)?void 0:x.link_text))),C&&s.createElement(Et,{appearance:p},C),S&&s.createElement(Et,{color:"danger",appearance:p},S))}function Kt({setAuthView:t=()=>{},supabaseClient:r,redirectTo:a,i18n:n,appearance:i,showLinks:o=!1}){var l;const[c,d]=e.useState(""),[u,h]=e.useState(""),[m,p]=e.useState(""),[g,f]=e.useState(!1),y=null==n?void 0:n.forgotten_password;return s.createElement("form",{id:"auth-forgot-password",onSubmit:async e=>{var t;e.preventDefault(),h(""),p(""),f(!0);const{error:s}=await r.auth.resetPasswordForEmail(c,{redirectTo:a});s?h(s.message):p(null==(t=null==n?void 0:n.forgotten_password)?void 0:t.confirmation_text),f(!1)}},s.createElement(xt,{direction:"vertical",gap:"large",appearance:i},s.createElement(xt,{gap:"large",direction:"vertical",appearance:i},s.createElement("div",null,s.createElement(St,{htmlFor:"email",appearance:i},null==y?void 0:y.email_label),s.createElement(_t,{id:"email",name:"email",type:"email",autoFocus:!0,placeholder:null==y?void 0:y.email_input_placeholder,onChange:e=>d(e.target.value),appearance:i})),s.createElement(yt,{type:"submit",color:"primary",loading:g,appearance:i},g?null==y?void 0:y.loading_button_label:null==y?void 0:y.button_label),o&&s.createElement(gt,{href:"#auth-sign-in",onClick:e=>{e.preventDefault(),t(rt)},appearance:i},null==(l=null==n?void 0:n.sign_in)?void 0:l.link_text),m&&s.createElement(Et,{appearance:i},m),u&&s.createElement(Et,{color:"danger",appearance:i},u))))}function Zt({supabaseClient:t,i18n:r,appearance:a}){const[n,i]=e.useState(""),[o,l]=e.useState(""),[c,d]=e.useState(""),[u,h]=e.useState(!1),m=null==r?void 0:r.update_password;return s.createElement("form",{id:"auth-update-password",onSubmit:async e=>{var s;e.preventDefault(),l(""),d(""),h(!0);const{error:a}=await t.auth.updateUser({password:n});a?l(a.message):d(null==(s=null==r?void 0:r.update_password)?void 0:s.confirmation_text),h(!1)}},s.createElement(xt,{gap:"large",direction:"vertical",appearance:a},s.createElement("div",null,s.createElement(St,{htmlFor:"password",appearance:a},null==m?void 0:m.password_label),s.createElement(_t,{id:"password",name:"password",placeholder:null==m?void 0:m.password_input_placeholder,type:"password",autoFocus:!0,onChange:e=>i(e.target.value),appearance:a})),s.createElement(yt,{type:"submit",color:"primary",loading:u,appearance:a},u?null==m?void 0:m.loading_button_label:null==m?void 0:m.button_label),c&&s.createElement(Et,{appearance:a},c),o&&s.createElement(Et,{color:"danger",appearance:a},o)))}function Xt({setAuthView:t=()=>{},supabaseClient:r,otpType:a="email",i18n:n,appearance:i,showLinks:o=!1}){var l;const[c,d]=e.useState(""),[u,h]=e.useState(""),[m,p]=e.useState(""),[g,f]=e.useState(""),[y,b]=e.useState(""),[x,v]=e.useState(!1),w=null==n?void 0:n.verify_otp;return s.createElement("form",{id:"auth-magic-link",onSubmit:async e=>{e.preventDefault(),f(""),b(""),v(!0);let t={email:c,token:m,type:a};["sms","phone_change"].includes(a)&&(t={phone:u,token:m,type:a});const{error:s}=await r.auth.verifyOtp(t);s&&f(s.message),v(!1)}},s.createElement(xt,{gap:"large",direction:"vertical",appearance:i},["sms","phone_change"].includes(a)?s.createElement("div",null,s.createElement(St,{htmlFor:"phone",appearance:i},null==w?void 0:w.phone_input_label),s.createElement(_t,{id:"phone",name:"phone",type:"text",autoFocus:!0,placeholder:null==w?void 0:w.phone_input_placeholder,onChange:e=>h(e.target.value),appearance:i})):s.createElement("div",null,s.createElement(St,{htmlFor:"email",appearance:i},null==w?void 0:w.email_input_label),s.createElement(_t,{id:"email",name:"email",type:"email",autoFocus:!0,placeholder:null==w?void 0:w.email_input_placeholder,onChange:e=>d(e.target.value),appearance:i})),s.createElement("div",null,s.createElement(St,{htmlFor:"token",appearance:i},null==w?void 0:w.token_input_label),s.createElement(_t,{id:"token",name:"token",type:"text",placeholder:null==w?void 0:w.token_input_placeholder,onChange:e=>p(e.target.value),appearance:i})),s.createElement(yt,{color:"primary",type:"submit",loading:x,appearance:i},x?null==w?void 0:w.loading_button_label:null==w?void 0:w.button_label),o&&s.createElement(gt,{href:"#auth-sign-in",onClick:e=>{e.preventDefault(),t(rt)},appearance:i},null==(l=null==n?void 0:n.sign_in)?void 0:l.link_text),y&&s.createElement(Et,{appearance:i},y),g&&s.createElement(Et,{color:"danger",appearance:i},g)))}const Qt=e.createContext({user:null,session:null});function es({supabaseClient:t,socialLayout:r="vertical",providers:a,providerScopes:n,queryParams:i,view:o="sign_in",redirectTo:l,onlyThirdPartyProviders:c=!1,magicLink:d=!1,showLinks:u=!0,appearance:h,theme:m="default",localization:p={variables:{}},otpType:g="email",additionalData:f,children:y}){const b=ht(mt,p.variables??{}),[x,v]=e.useState(o),[w,j]=e.useState(""),[_,k]=e.useState(""),S="sign_in"===x||"sign_up"===x||"magic_link"===x;e.useEffect((()=>{var e,t;Xe({theme:ht((null==(e=null==h?void 0:h.theme)?void 0:e.default)??{},(null==(t=null==h?void 0:h.variables)?void 0:t.default)??{})})}),[h]);const N=({children:e})=>{var o;return s.createElement("div",{className:"default"!==m?et(ht(null==h?void 0:h.theme[m],(null==(o=null==h?void 0:h.variables)?void 0:o[m])??{})):""},S&&s.createElement(Jt,{appearance:h,supabaseClient:t,providers:a,providerScopes:n,queryParams:i,socialLayout:r,redirectTo:l,onlyThirdPartyProviders:c,i18n:b,view:x}),!c&&e)};e.useEffect((()=>{const{data:e}=t.auth.onAuthStateChange((e=>{"PASSWORD_RECOVERY"===e?v("update_password"):"USER_UPDATED"===e&&v("sign_in")}));return v(o),()=>e.subscription.unsubscribe()}),[o]);const E={supabaseClient:t,setAuthView:v,defaultEmail:w,defaultPassword:_,setDefaultEmail:j,setDefaultPassword:k,redirectTo:l,magicLink:d,showLinks:u,i18n:b,appearance:h};switch(x){case rt:return s.createElement(N,null,s.createElement(Yt,{...E,authView:"sign_in"}));case at:return s.createElement(N,null,s.createElement(Yt,{appearance:h,supabaseClient:t,authView:"sign_up",setAuthView:v,defaultEmail:w,defaultPassword:_,setDefaultEmail:j,setDefaultPassword:k,redirectTo:l,magicLink:d,showLinks:u,i18n:b,additionalData:f,children:y}));case nt:return s.createElement(N,null,s.createElement(Kt,{appearance:h,supabaseClient:t,setAuthView:v,redirectTo:l,showLinks:u,i18n:b}));case it:return s.createElement(N,null,s.createElement(Tt,{appearance:h,supabaseClient:t,setAuthView:v,redirectTo:l,showLinks:u,i18n:b}));case ot:return s.createElement(Zt,{appearance:h,supabaseClient:t,i18n:b});case lt:return s.createElement(Xt,{appearance:h,supabaseClient:t,otpType:g,i18n:b});default:return null}}es.ForgottenPassword=Kt,es.UpdatePassword=Zt,es.MagicLink=Tt,es.UserContextProvider=t=>{const{supabaseClient:r}=t,[a,n]=e.useState(null),[i,o]=e.useState((null==a?void 0:a.user)??null);e.useEffect((()=>{(async()=>{var e;const{data:t}=await r.auth.getSession();n(t.session),o((null==(e=t.session)?void 0:e.user)??null)})();const{data:e}=r.auth.onAuthStateChange((async(e,t)=>{n(t),o((null==t?void 0:t.user)??null)}));return()=>{null==e||e.subscription.unsubscribe()}}),[]);const l={session:a,user:i};return s.createElement(Qt.Provider,{value:l,...t})},es.useUser=()=>{const t=e.useContext(Qt);if(void 0===t)throw new Error("useUser must be used within a UserContextProvider.");return t},tt({borderRadius:"12px",boxShadow:"rgba(100, 100, 111, 0.2) 0px 7px 29px 0px",width:"360px",padding:"28px 32px"});const ts={},ss=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),s=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));r=Promise.allSettled(t.map((e=>{if((e=function(e){return"/"+e}(e))in ts)return;ts[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const a=document.createElement("link");return a.rel=t?"stylesheet":"modulepreload",t||(a.as="script"),a.crossOrigin="",a.href=e,s&&a.setAttribute("nonce",s),document.head.appendChild(a),t?new Promise(((t,s)=>{a.addEventListener("load",t),a.addEventListener("error",(()=>s(new Error(`Unable to preload CSS for ${e}`))))})):void 0})))}function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then((t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)}))};class rs extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class as extends rs{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ns extends rs{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class is extends rs{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var os,ls;(ls=os||(os={})).Any="any",ls.ApNortheast1="ap-northeast-1",ls.ApNortheast2="ap-northeast-2",ls.ApSouth1="ap-south-1",ls.ApSoutheast1="ap-southeast-1",ls.ApSoutheast2="ap-southeast-2",ls.CaCentral1="ca-central-1",ls.EuCentral1="eu-central-1",ls.EuWest1="eu-west-1",ls.EuWest2="eu-west-2",ls.EuWest3="eu-west-3",ls.SaEast1="sa-east-1",ls.UsEast1="us-east-1",ls.UsWest1="us-west-1",ls.UsWest2="us-west-2";var cs=function(e,t,s,r){return new(s||(s=Promise))((function(a,n){function i(e){try{l(r.next(e))}catch(t){n(t)}}function o(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(i,o)}l((r=r.apply(e,t||[])).next())}))};class ds{constructor(e,{headers:t={},customFetch:s,region:r=os.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=(e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>ss((async()=>{const{default:e}=await Promise.resolve().then((()=>_s));return{default:e}}),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)})(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return cs(this,void 0,void 0,(function*(){try{const{headers:r,method:a,body:n}=t;let i,o={},{region:l}=t;l||(l=this.region),l&&"any"!==l&&(o["x-region"]=l),n&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&("undefined"!=typeof Blob&&n instanceof Blob||n instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",i=n):"string"==typeof n?(o["Content-Type"]="text/plain",i=n):"undefined"!=typeof FormData&&n instanceof FormData?i=n:(o["Content-Type"]="application/json",i=JSON.stringify(n)));const c=yield this.fetch(`${this.url}/${e}`,{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),r),body:i}).catch((e=>{throw new as(e)})),d=c.headers.get("x-relay-error");if(d&&"true"===d)throw new ns(c);if(!c.ok)throw new is(c);let u,h=(null!==(s=c.headers.get("Content-Type"))&&void 0!==s?s:"text/plain").split(";")[0].trim();return u="application/json"===h?yield c.json():"application/octet-stream"===h?yield c.blob():"text/event-stream"===h?c:"multipart/form-data"===h?yield c.formData():yield c.text(),{data:u,error:null}}catch(r){return{data:null,error:r}}}))}}var us={},hs={},ms={},ps={},gs={},fs={},ys=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();const bs=ys.fetch,xs=ys.fetch.bind(ys),vs=ys.Headers,ws=ys.Request,js=ys.Response,_s=Object.freeze(Object.defineProperty({__proto__:null,Headers:vs,Request:ws,Response:js,default:xs,fetch:bs},Symbol.toStringTag,{value:"Module"})),ks=r(_s);var Ss={};Object.defineProperty(Ss,"__esModule",{value:!0});let Ns=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Ss.default=Ns;var Es=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(fs,"__esModule",{value:!0});const Ts=Es(ks),Cs=Es(Ss);fs.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=Ts.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let s=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((async e=>{var t,s,r;let a=null,n=null,i=null,o=e.status,l=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(n="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const r=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),c=null===(s=e.headers.get("content-range"))||void 0===s?void 0:s.split("/");r&&c&&c.length>1&&(i=parseInt(c[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(n)&&(n.length>1?(a={code:"PGRST116",details:`Results contain ${n.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},n=null,i=null,o=406,l="Not Acceptable"):n=1===n.length?n[0]:null)}else{const t=await e.text();try{a=JSON.parse(t),Array.isArray(a)&&404===e.status&&(n=[],a=null,o=200,l="OK")}catch(c){404===e.status&&""===t?(o=204,l="No Content"):a={message:t}}if(a&&this.isMaybeSingle&&(null===(r=null==a?void 0:a.details)||void 0===r?void 0:r.includes("0 rows"))&&(a=null,o=200,l="OK"),a&&this.shouldThrowOnError)throw new Cs.default(a)}return{error:a,data:n,count:i,status:o,statusText:l}}));return this.shouldThrowOnError||(s=s.catch((e=>{var t,s,r;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(s=null==e?void 0:e.stack)&&void 0!==s?s:""}`,hint:"",code:`${null!==(r=null==e?void 0:e.code)&&void 0!==r?r:""}`},data:null,count:null,status:0,statusText:""}}))),s.then(e,t)}returns(){return this}overrideTypes(){return this}};var Ps=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(gs,"__esModule",{value:!0});const Bs=Ps(fs);let Is=class extends Bs.default{select(e){let t=!1;const s=(null!=e?e:"*").split("").map((e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e))).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:r,referencedTable:a=r}={}){const n=a?`${a}.order`:"order",i=this.url.searchParams.get(n);return this.url.searchParams.set(n,`${i?`${i},`:""}${e}.${t?"asc":"desc"}${void 0===s?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const r=void 0===s?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:r=s}={}){const a=void 0===r?"offset":`${r}.offset`,n=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(n,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:r=!1,wal:a=!1,format:n="text"}={}){var i;const o=[e?"analyze":null,t?"verbose":null,s?"settings":null,r?"buffers":null,a?"wal":null].filter(Boolean).join("|"),l=null!==(i=this.headers.Accept)&&void 0!==i?i:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${n}; for="${l}"; options=${o};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};gs.default=Is;var As=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ps,"__esModule",{value:!0});const $s=As(gs);let Os=class extends $s.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map((e=>"string"==typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`)).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:r}={}){let a="";"plain"===r?a="pl":"phrase"===r?a="ph":"websearch"===r&&(a="w");const n=void 0===s?"":`(${s})`;return this.url.searchParams.append(e,`${a}fts${n}.${t}`),this}match(e){return Object.entries(e).forEach((([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)})),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const r=s?`${s}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};ps.default=Os;var Rs=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ms,"__esModule",{value:!0});const Ls=Rs(ps);ms.default=class{constructor(e,{headers:t={},schema:s,fetch:r}){this.url=e,this.headers=t,this.schema=s,this.fetch=r}select(e,{head:t=!1,count:s}={}){const r=t?"HEAD":"GET";let a=!1;const n=(null!=e?e:"*").split("").map((e=>/\s/.test(e)&&!a?"":('"'===e&&(a=!a),e))).join("");return this.url.searchParams.set("select",n),s&&(this.headers.Prefer=`count=${s}`),new Ls.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:s=!0}={}){const r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),s||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new Ls.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:r,defaultToNull:a=!0}={}){const n=[`resolution=${s?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&n.push(this.headers.Prefer),r&&n.push(`count=${r}`),a||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new Ls.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new Ls.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new Ls.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};var Ds={},Us={};Object.defineProperty(Us,"__esModule",{value:!0}),Us.version=void 0,Us.version="0.0.0-automated",Object.defineProperty(Ds,"__esModule",{value:!0}),Ds.DEFAULT_HEADERS=void 0;const Ms=Us;Ds.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Ms.version}`};var zs=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(hs,"__esModule",{value:!0});const Fs=zs(ms),qs=zs(ps),Ws=Ds;hs.default=class e{constructor(e,{headers:t={},schema:s,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},Ws.DEFAULT_HEADERS),t),this.schemaName=s,this.fetch=r}from(e){const t=new URL(`${this.url}/${e}`);return new Fs.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:r=!1,count:a}={}){let n;const i=new URL(`${this.url}/rpc/${e}`);let o;s||r?(n=s?"HEAD":"GET",Object.entries(t).filter((([e,t])=>void 0!==t)).map((([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`])).forEach((([e,t])=>{i.searchParams.append(e,t)}))):(n="POST",o=t);const l=Object.assign({},this.headers);return a&&(l.Prefer=`count=${a}`),new qs.default({method:n,url:i,headers:l,schema:this.schemaName,body:o,fetch:this.fetch,allowEmpty:!1})}};var Vs=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(us,"__esModule",{value:!0}),us.PostgrestError=us.PostgrestBuilder=us.PostgrestTransformBuilder=us.PostgrestFilterBuilder=us.PostgrestQueryBuilder=us.PostgrestClient=void 0;const Hs=Vs(hs);us.PostgrestClient=Hs.default;const Gs=Vs(ms);us.PostgrestQueryBuilder=Gs.default;const Js=Vs(ps);us.PostgrestFilterBuilder=Js.default;const Ys=Vs(gs);us.PostgrestTransformBuilder=Ys.default;const Ks=Vs(fs);us.PostgrestBuilder=Ks.default;const Zs=Vs(Ss);us.PostgrestError=Zs.default;var Xs=us.default={PostgrestClient:Hs.default,PostgrestQueryBuilder:Gs.default,PostgrestFilterBuilder:Js.default,PostgrestTransformBuilder:Ys.default,PostgrestBuilder:Ks.default,PostgrestError:Zs.default};const{PostgrestClient:Qs,PostgrestQueryBuilder:er,PostgrestFilterBuilder:tr,PostgrestTransformBuilder:sr,PostgrestBuilder:rr,PostgrestError:ar}=Xs,nr={"X-Client-Info":"realtime-js/2.11.2"};var ir,or,lr,cr,dr,ur,hr,mr,pr,gr,fr;(or=ir||(ir={}))[or.connecting=0]="connecting",or[or.open=1]="open",or[or.closing=2]="closing",or[or.closed=3]="closed",(cr=lr||(lr={})).closed="closed",cr.errored="errored",cr.joined="joined",cr.joining="joining",cr.leaving="leaving",(ur=dr||(dr={})).close="phx_close",ur.error="phx_error",ur.join="phx_join",ur.reply="phx_reply",ur.leave="phx_leave",ur.access_token="access_token",(hr||(hr={})).websocket="websocket",(pr=mr||(mr={})).Connecting="connecting",pr.Open="open",pr.Closing="closing",pr.Closed="closed";class yr{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"==typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const r=t.getUint8(1),a=t.getUint8(2);let n=this.HEADER_LENGTH+2;const i=s.decode(e.slice(n,n+r));n+=r;const o=s.decode(e.slice(n,n+a));n+=a;return{ref:null,topic:i,event:o,payload:JSON.parse(s.decode(e.slice(n,e.byteLength)))}}}class br{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}(fr=gr||(gr={})).abstime="abstime",fr.bool="bool",fr.date="date",fr.daterange="daterange",fr.float4="float4",fr.float8="float8",fr.int2="int2",fr.int4="int4",fr.int4range="int4range",fr.int8="int8",fr.int8range="int8range",fr.json="json",fr.jsonb="jsonb",fr.money="money",fr.numeric="numeric",fr.oid="oid",fr.reltime="reltime",fr.text="text",fr.time="time",fr.timestamp="timestamp",fr.timestamptz="timestamptz",fr.timetz="timetz",fr.tsrange="tsrange",fr.tstzrange="tstzrange";const xr=(e,t,s={})=>{var r;const a=null!==(r=s.skipTypes)&&void 0!==r?r:[];return Object.keys(t).reduce(((s,r)=>(s[r]=vr(r,e,t,a),s)),{})},vr=(e,t,s,r)=>{const a=t.find((t=>t.name===e)),n=null==a?void 0:a.type,i=s[e];return n&&!r.includes(n)?wr(n,i):jr(i)},wr=(e,t)=>{if("_"===e.charAt(0)){const s=e.slice(1,e.length);return Nr(t,s)}switch(e){case gr.bool:return _r(t);case gr.float4:case gr.float8:case gr.int2:case gr.int4:case gr.int8:case gr.numeric:case gr.oid:return kr(t);case gr.json:case gr.jsonb:return Sr(t);case gr.timestamp:return Er(t);case gr.abstime:case gr.date:case gr.daterange:case gr.int4range:case gr.int8range:case gr.money:case gr.reltime:case gr.text:case gr.time:case gr.timestamptz:case gr.timetz:case gr.tsrange:case gr.tstzrange:default:return jr(t)}},jr=e=>e,_r=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},kr=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Sr=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Nr=(e,t)=>{if("string"!=typeof e)return e;const s=e.length-1,r=e[s];if("{"===e[0]&&"}"===r){let r;const n=e.slice(1,s);try{r=JSON.parse("["+n+"]")}catch(a){r=n?n.split(","):[]}return r.map((e=>wr(t,e)))}return e},Er=e=>"string"==typeof e?e.replace(" ","T"):e,Tr=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Cr{constructor(e,t,s={},r=1e4){this.channel=e,this.event=t,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t(null===(s=this.receivedResp)||void 0===s?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},(e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter((t=>t.status===e)).forEach((e=>e.callback(t)))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Pr,Br,Ir,Ar,$r,Or,Rr,Lr;(Br=Pr||(Pr={})).SYNC="sync",Br.JOIN="join",Br.LEAVE="leave";class Dr{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},(e=>{const{onJoin:t,onLeave:s,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Dr.syncState(this.state,e,t,s),this.pendingDiffs.forEach((e=>{this.state=Dr.syncDiff(this.state,e,t,s)})),this.pendingDiffs=[],r()})),this.channel._on(s.diff,{},(e=>{const{onJoin:t,onLeave:s,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=Dr.syncDiff(this.state,e,t,s),r())})),this.onJoin(((e,t,s)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:s})})),this.onLeave(((e,t,s)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:s})})),this.onSync((()=>{this.channel._trigger("presence",{event:"sync"})}))}static syncState(e,t,s,r){const a=this.cloneDeep(e),n=this.transformState(t),i={},o={};return this.map(a,((e,t)=>{n[e]||(o[e]=t)})),this.map(n,((e,t)=>{const s=a[e];if(s){const r=t.map((e=>e.presence_ref)),a=s.map((e=>e.presence_ref)),n=t.filter((e=>a.indexOf(e.presence_ref)<0)),l=s.filter((e=>r.indexOf(e.presence_ref)<0));n.length>0&&(i[e]=n),l.length>0&&(o[e]=l)}else i[e]=t})),this.syncDiff(a,{joins:i,leaves:o},s,r)}static syncDiff(e,t,s,r){const{joins:a,leaves:n}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(a,((t,r)=>{var a;const n=null!==(a=e[t])&&void 0!==a?a:[];if(e[t]=this.cloneDeep(r),n.length>0){const s=e[t].map((e=>e.presence_ref)),r=n.filter((e=>s.indexOf(e.presence_ref)<0));e[t].unshift(...r)}s(t,n,r)})),this.map(n,((t,s)=>{let a=e[t];if(!a)return;const n=s.map((e=>e.presence_ref));a=a.filter((e=>n.indexOf(e.presence_ref)<0)),e[t]=a,r(t,a,s),0===a.length&&delete e[t]})),e}static map(e,t){return Object.getOwnPropertyNames(e).map((s=>t(s,e[s])))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce(((t,s)=>{const r=e[s];return t[s]="metas"in r?r.metas.map((e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e))):r,t}),{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(Ar=Ir||(Ir={})).ALL="*",Ar.INSERT="INSERT",Ar.UPDATE="UPDATE",Ar.DELETE="DELETE",(Or=$r||($r={})).BROADCAST="broadcast",Or.PRESENCE="presence",Or.POSTGRES_CHANGES="postgres_changes",Or.SYSTEM="system",(Lr=Rr||(Rr={})).SUBSCRIBED="SUBSCRIBED",Lr.TIMED_OUT="TIMED_OUT",Lr.CLOSED="CLOSED",Lr.CHANNEL_ERROR="CHANNEL_ERROR";class Ur{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=lr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Cr(this,dr.join,this.params,this.timeout),this.rejoinTimer=new br((()=>this._rejoinUntilConnected()),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(()=>{this.state=lr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach((e=>e.send())),this.pushBuffer=[]})),this._onClose((()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=lr.closed,this.socket._remove(this)})),this._onError((e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=lr.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=lr.errored,this.rejoinTimer.scheduleTimeout())})),this._on(dr.reply,{},((e,t)=>{this._trigger(this._replyEventName(t),e)})),this.presence=new Dr(this),this.broadcastEndpointURL=Tr(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:a,presence:n,private:i}}=this.params;this._onError((t=>null==e?void 0:e(Rr.CHANNEL_ERROR,t))),this._onClose((()=>null==e?void 0:e(Rr.CLOSED)));const o={},l={broadcast:a,presence:n,postgres_changes:null!==(r=null===(s=this.bindings.postgres_changes)||void 0===s?void 0:s.map((e=>e.filter)))&&void 0!==r?r:[],private:i};this.socket.accessTokenValue&&(o.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},o)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",(async({postgres_changes:t})=>{var s;if(this.socket.setAuth(),void 0!==t){const r=this.bindings.postgres_changes,a=null!==(s=null==r?void 0:r.length)&&void 0!==s?s:0,n=[];for(let s=0;s<a;s++){const a=r[s],{filter:{event:i,schema:o,table:l,filter:c}}=a,d=t&&t[s];if(!d||d.event!==i||d.schema!==o||d.table!==l||d.filter!==c)return this.unsubscribe(),void(null==e||e(Rr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));n.push(Object.assign(Object.assign({},a),{id:d.id}))}return this.bindings.postgres_changes=n,void(e&&e(Rr.SUBSCRIBED))}null==e||e(Rr.SUBSCRIBED)})).receive("error",(t=>{null==e||e(Rr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))})).receive("timeout",(()=>{null==e||e(Rr.TIMED_OUT)}))}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,r;if(this._canPush()||"broadcast"!==e.type)return new Promise((s=>{var r,a,n;const i=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(n=null===(a=null===(r=this.params)||void 0===r?void 0:r.config)||void 0===a?void 0:a.broadcast)||void 0===n?void 0:n.ack)||s("ok"),i.receive("ok",(()=>s("ok"))),i.receive("error",(()=>s("error"))),i.receive("timeout",(()=>s("timed out")))}));{const{event:n,payload:i}=e,o={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:i,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!==(s=t.timeout)&&void 0!==s?s:this.timeout);return await(null===(r=e.body)||void 0===r?void 0:r.cancel()),e.ok?"ok":"error"}catch(a){return"AbortError"===a.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=lr.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(dr.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise((s=>{const r=new Cr(this,dr.leave,{},e);r.receive("ok",(()=>{t(),s("ok")})).receive("timeout",(()=>{t(),s("timed out")})).receive("error",(()=>{s("error")})),r.send(),this._canPush()||r.trigger("ok",{})}))}async _fetchWithTimeout(e,t,s){const r=new AbortController,a=setTimeout((()=>r.abort()),s),n=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(a),n}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Cr(this,e,t,s);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var r,a;const n=e.toLocaleLowerCase(),{close:i,error:o,leave:l,join:c}=dr;if(s&&[i,o,l,c].indexOf(n)>=0&&s!==this._joinRef())return;let d=this._onMessage(n,t,s);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(n)?null===(r=this.bindings.postgres_changes)||void 0===r||r.filter((e=>{var t,s,r;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(r=null===(s=e.filter)||void 0===s?void 0:s.event)||void 0===r?void 0:r.toLocaleLowerCase())===n})).map((e=>e.callback(d,s))):null===(a=this.bindings[n])||void 0===a||a.filter((e=>{var s,r,a,i,o,l;if(["broadcast","presence","postgres_changes"].includes(n)){if("id"in e){const n=e.id,i=null===(s=e.filter)||void 0===s?void 0:s.event;return n&&(null===(r=t.ids)||void 0===r?void 0:r.includes(n))&&("*"===i||(null==i?void 0:i.toLocaleLowerCase())===(null===(a=t.data)||void 0===a?void 0:a.type.toLocaleLowerCase()))}{const s=null===(o=null===(i=null==e?void 0:e.filter)||void 0===i?void 0:i.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===s||s===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===n})).map((e=>{if("object"==typeof d&&"ids"in d){const e=d.data,{schema:t,table:s,commit_timestamp:r,type:a,errors:n}=e,i={schema:t,table:s,commit_timestamp:r,eventType:a,new:{},old:{},errors:n};d=Object.assign(Object.assign({},i),this._getPayloadRecords(e))}e.callback(d,s)}))}_isClosed(){return this.state===lr.closed}_isJoined(){return this.state===lr.joined}_isJoining(){return this.state===lr.joining}_isLeaving(){return this.state===lr.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const r=e.toLocaleLowerCase(),a={type:r,filter:t,callback:s};return this.bindings[r]?this.bindings[r].push(a):this.bindings[r]=[a],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter((e=>{var r;return!((null===(r=e.type)||void 0===r?void 0:r.toLocaleLowerCase())===s&&Ur.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(dr.close,{},e)}_onError(e){this._on(dr.error,{},(t=>e(t)))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=lr.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=xr(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=xr(e.columns,e.old_record)),t}}const Mr=()=>{},zr="undefined"!=typeof WebSocket;class Fr{constructor(e,t){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=nr,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Mr,this.conn=null,this.sendBuffer=[],this.serializer=new yr,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>ss((async()=>{const{default:e}=await Promise.resolve().then((()=>_s));return{default:e}}),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},this.endPoint=`${e}/${hr.websocket}`,this.httpEndpoint=Tr(e),(null==t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null==t?void 0:t.params)&&(this.params=t.params),(null==t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null==t?void 0:t.timeout)&&(this.timeout=t.timeout),(null==t?void 0:t.logger)&&(this.logger=t.logger),(null==t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const r=null===(s=null==t?void 0:t.params)||void 0===s?void 0:s.apikey;if(r&&(this.accessTokenValue=r,this.apiKey=r),this.reconnectAfterMs=(null==t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null==t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null==t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new br((async()=>{this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(null==t?void 0:t.fetch),null==t?void 0:t.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null==t?void 0:t.worker)||!1,this.workerUrl=null==t?void 0:t.workerUrl}this.accessToken=(null==t?void 0:t.accessToken)||null}connect(){if(!this.conn)if(this.transport)this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});else{if(zr)return this.conn=new WebSocket(this.endpointURL()),void this.setupConnection();this.conn=new qr(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),ss((async()=>{const{default:e}=await import("./browser-DBTxTTQI.js").then((e=>e.b));return{default:e}}),__vite__mapDeps([0,1])).then((({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()}))}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map((e=>e.unsubscribe())));return this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case ir.connecting:return mr.Connecting;case ir.open:return mr.Open;case ir.closing:return mr.Closing;default:return mr.Closed}}isConnected(){return this.connectionState()===mr.Open}channel(e,t={config:{}}){const s=new Ur(`realtime:${e}`,t,this);return this.channels.push(s),s}push(e){const{topic:t,event:s,payload:r,ref:a}=e,n=()=>{this.encode(e,(e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)}))};this.log("push",`${t} ${s} (${a})`,r),this.isConnected()?n():this.sendBuffer.push(n)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let e=null;try{e=JSON.parse(atob(t.split(".")[1]))}catch(s){}if(e&&e.exp){if(!(Math.floor(Date.now()/1e3)-e.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${e.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${e.exp}`)}this.accessTokenValue=t,this.channels.forEach((e=>{t&&e.updateJoinPayload({access_token:t}),e.joinedOnce&&e._isJoined()&&e._push(dr.access_token,{access_token:t})}))}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((e=>e())),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find((t=>t.topic===e&&(t._isJoined()||t._isJoining())));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter((t=>t._joinRef()!==e._joinRef()))}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,(e=>{let{topic:t,event:s,payload:r,ref:a}=e;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${r.status||""} ${t} ${s} ${a&&"("+a+")"||""}`,r),this.channels.filter((e=>e._isMember(t))).forEach((e=>e._trigger(s,r,a))),this.stateChangeCallbacks.message.forEach((t=>t(e)))}))}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this.sendHeartbeat()),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach((e=>e()))}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((t=>t(e)))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((t=>t(e)))}_triggerChanError(){this.channels.forEach((e=>e._trigger(dr.error)))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const s=e.match(/\?/)?"&":"?";return`${e}${s}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class qr{constructor(e,t,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=ir.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class Wr extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Vr(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class Hr extends Wr{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Gr extends Wr{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Jr=function(e,t,s,r){return new(s||(s=Promise))((function(a,n){function i(e){try{l(r.next(e))}catch(t){n(t)}}function o(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(i,o)}l((r=r.apply(e,t||[])).next())}))};const Yr=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>ss((async()=>{const{default:e}=await Promise.resolve().then((()=>_s));return{default:e}}),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},Kr=e=>{if(Array.isArray(e))return e.map((e=>Kr(e)));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach((([e,s])=>{const r=e.replace(/([-_][a-z])/gi,(e=>e.toUpperCase().replace(/[-_]/g,"")));t[r]=Kr(s)})),t};var Zr=function(e,t,s,r){return new(s||(s=Promise))((function(a,n){function i(e){try{l(r.next(e))}catch(t){n(t)}}function o(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(i,o)}l((r=r.apply(e,t||[])).next())}))};const Xr=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Qr=(e,t,s)=>Zr(void 0,void 0,void 0,(function*(){const r=yield Jr(void 0,void 0,void 0,(function*(){return"undefined"==typeof Response?(yield ss((()=>Promise.resolve().then((()=>_s))),void 0)).Response:Response}));e instanceof r&&!(null==s?void 0:s.noResolveJson)?e.json().then((s=>{t(new Hr(Xr(s),e.status||500))})).catch((e=>{t(new Gr(Xr(e),e))})):t(new Gr(Xr(e),e))}));function ea(e,t,s,r,a,n){return Zr(this,void 0,void 0,(function*(){return new Promise(((i,o)=>{e(s,((e,t,s,r)=>{const a={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?a:(a.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),r&&(a.body=JSON.stringify(r)),Object.assign(Object.assign({},a),s))})(t,r,a,n)).then((e=>{if(!e.ok)throw e;return(null==r?void 0:r.noResolveJson)?e:e.json()})).then((e=>i(e))).catch((e=>Qr(e,o,r)))}))}))}function ta(e,t,s,r){return Zr(this,void 0,void 0,(function*(){return ea(e,"GET",t,s,r)}))}function sa(e,t,s,r,a){return Zr(this,void 0,void 0,(function*(){return ea(e,"POST",t,r,a,s)}))}function ra(e,t,s,r,a){return Zr(this,void 0,void 0,(function*(){return ea(e,"DELETE",t,r,a,s)}))}var aa=function(e,t,s,r){return new(s||(s=Promise))((function(a,n){function i(e){try{l(r.next(e))}catch(t){n(t)}}function o(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(i,o)}l((r=r.apply(e,t||[])).next())}))};const na={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ia={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class oa{constructor(e,t={},s,r){this.url=e,this.headers=t,this.bucketId=s,this.fetch=Yr(r)}uploadOrUpdate(e,t,s,r){return aa(this,void 0,void 0,(function*(){try{let a;const n=Object.assign(Object.assign({},ia),r);let i=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(n.upsert)});const o=n.metadata;"undefined"!=typeof Blob&&s instanceof Blob?(a=new FormData,a.append("cacheControl",n.cacheControl),o&&a.append("metadata",this.encodeMetadata(o)),a.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(a=s,a.append("cacheControl",n.cacheControl),o&&a.append("metadata",this.encodeMetadata(o))):(a=s,i["cache-control"]=`max-age=${n.cacheControl}`,i["content-type"]=n.contentType,o&&(i["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null==r?void 0:r.headers)&&(i=Object.assign(Object.assign({},i),r.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:a,headers:i},(null==n?void 0:n.duplex)?{duplex:n.duplex}:{})),u=yield d.json();if(d.ok)return{data:{path:l,id:u.Id,fullPath:u.Key},error:null};return{data:null,error:u}}catch(a){if(Vr(a))return{data:null,error:a};throw a}}))}upload(e,t,s){return aa(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",e,t,s)}))}uploadToSignedUrl(e,t,s,r){return aa(this,void 0,void 0,(function*(){const a=this._removeEmptyFolders(e),n=this._getFinalPath(a),i=new URL(this.url+`/object/upload/sign/${n}`);i.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:ia.upsert},r),n=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&s instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(e=s,e.append("cacheControl",t.cacheControl)):(e=s,n["cache-control"]=`max-age=${t.cacheControl}`,n["content-type"]=t.contentType);const o=yield this.fetch(i.toString(),{method:"PUT",body:e,headers:n}),l=yield o.json();if(o.ok)return{data:{path:a,fullPath:l.Key},error:null};return{data:null,error:l}}catch(o){if(Vr(o))return{data:null,error:o};throw o}}))}createSignedUploadUrl(e,t){return aa(this,void 0,void 0,(function*(){try{let s=this._getFinalPath(e);const r=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(r["x-upsert"]="true");const a=yield sa(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:r}),n=new URL(this.url+a.url),i=n.searchParams.get("token");if(!i)throw new Wr("No token returned by API");return{data:{signedUrl:n.toString(),path:e,token:i},error:null}}catch(s){if(Vr(s))return{data:null,error:s};throw s}}))}update(e,t,s){return aa(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",e,t,s)}))}move(e,t,s){return aa(this,void 0,void 0,(function*(){try{return{data:yield sa(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(Vr(r))return{data:null,error:r};throw r}}))}copy(e,t,s){return aa(this,void 0,void 0,(function*(){try{return{data:{path:(yield sa(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(Vr(r))return{data:null,error:r};throw r}}))}createSignedUrl(e,t,s){return aa(this,void 0,void 0,(function*(){try{let r=this._getFinalPath(e),a=yield sa(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},(null==s?void 0:s.transform)?{transform:s.transform}:{}),{headers:this.headers});const n=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${n}`)},{data:a,error:null}}catch(r){if(Vr(r))return{data:null,error:r};throw r}}))}createSignedUrls(e,t,s){return aa(this,void 0,void 0,(function*(){try{const r=yield sa(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return{data:r.map((e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${a}`):null}))),error:null}}catch(r){if(Vr(r))return{data:null,error:r};throw r}}))}download(e,t){return aa(this,void 0,void 0,(function*(){const s=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",r=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),a=r?`?${r}`:"";try{const t=this._getFinalPath(e),r=yield ta(this.fetch,`${this.url}/${s}/${t}${a}`,{headers:this.headers,noResolveJson:!0});return{data:yield r.blob(),error:null}}catch(n){if(Vr(n))return{data:null,error:n};throw n}}))}info(e){return aa(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{const e=yield ta(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Kr(e),error:null}}catch(s){if(Vr(s))return{data:null,error:s};throw s}}))}exists(e){return aa(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{return yield function(e,t,s,r){return Zr(this,void 0,void 0,(function*(){return ea(e,"HEAD",t,Object.assign(Object.assign({},s),{noResolveJson:!0}),r)}))}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(Vr(s)&&s instanceof Gr){const e=s.originalError;if([400,404].includes(null==e?void 0:e.status))return{data:!1,error:s}}throw s}}))}getPublicUrl(e,t){const s=this._getFinalPath(e),r=[],a=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==a&&r.push(a);const n=void 0!==(null==t?void 0:t.transform)?"render/image":"object",i=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==i&&r.push(i);let o=r.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${n}/public/${s}${o}`)}}}remove(e){return aa(this,void 0,void 0,(function*(){try{return{data:yield ra(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Vr(t))return{data:null,error:t};throw t}}))}list(e,t,s){return aa(this,void 0,void 0,(function*(){try{const r=Object.assign(Object.assign(Object.assign({},na),t),{prefix:e||""});return{data:yield sa(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(r){if(Vr(r))return{data:null,error:r};throw r}}))}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const la={"X-Client-Info":"storage-js/2.7.1"};var ca=function(e,t,s,r){return new(s||(s=Promise))((function(a,n){function i(e){try{l(r.next(e))}catch(t){n(t)}}function o(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(i,o)}l((r=r.apply(e,t||[])).next())}))};class da{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},la),t),this.fetch=Yr(s)}listBuckets(){return ca(this,void 0,void 0,(function*(){try{return{data:yield ta(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Vr(e))return{data:null,error:e};throw e}}))}getBucket(e){return ca(this,void 0,void 0,(function*(){try{return{data:yield ta(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Vr(t))return{data:null,error:t};throw t}}))}createBucket(e,t={public:!1}){return ca(this,void 0,void 0,(function*(){try{return{data:yield sa(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Vr(s))return{data:null,error:s};throw s}}))}updateBucket(e,t){return ca(this,void 0,void 0,(function*(){try{const s=yield function(e,t,s,r,a){return Zr(this,void 0,void 0,(function*(){return ea(e,"PUT",t,r,a,s)}))}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:s,error:null}}catch(s){if(Vr(s))return{data:null,error:s};throw s}}))}emptyBucket(e){return ca(this,void 0,void 0,(function*(){try{return{data:yield sa(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Vr(t))return{data:null,error:t};throw t}}))}deleteBucket(e){return ca(this,void 0,void 0,(function*(){try{return{data:yield ra(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Vr(t))return{data:null,error:t};throw t}}))}}class ua extends da{constructor(e,t={},s){super(e,t,s)}from(e){return new oa(this.url,this.headers,e,this.fetch)}}let ha="";ha="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const ma={headers:{"X-Client-Info":`supabase-js-${ha}/2.49.4`}},pa={schema:"public"},ga={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},fa={};var ya=function(e,t,s,r){return new(s||(s=Promise))((function(a,n){function i(e){try{l(r.next(e))}catch(t){n(t)}}function o(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(i,o)}l((r=r.apply(e,t||[])).next())}))};const ba=(e,t,s)=>{const r=(e=>{let t;return t=e||("undefined"==typeof fetch?xs:fetch),(...e)=>t(...e)})(s),a="undefined"==typeof Headers?vs:Headers;return(s,n)=>ya(void 0,void 0,void 0,(function*(){var i;const o=null!==(i=yield t())&&void 0!==i?i:e;let l=new a(null==n?void 0:n.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),r(s,Object.assign(Object.assign({},n),{headers:l}))}))};var xa=function(e,t,s,r){return new(s||(s=Promise))((function(a,n){function i(e){try{l(r.next(e))}catch(t){n(t)}}function o(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(i,o)}l((r=r.apply(e,t||[])).next())}))};const va="2.69.1",wa=3e4,ja=9e4,_a={"X-Client-Info":`gotrue-js/${va}`},ka="X-Supabase-Api-Version",Sa={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},Na=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class Ea extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function Ta(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class Ca extends Ea{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}class Pa extends Ea{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Ba extends Ea{constructor(e,t,s,r){super(e,s,r),this.name=t,this.status=s}}class Ia extends Ba{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Aa extends Ba{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class $a extends Ba{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Oa extends Ba{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ra extends Ba{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class La extends Ba{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Da(e){return Ta(e)&&"AuthRetryableFetchError"===e.name}class Ua extends Ba{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class Ma extends Ba{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const za="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Fa=" \t\n\r=".split(""),qa=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Fa.length;t+=1)e[Fa[t].charCodeAt(0)]=-2;for(let t=0;t<za.length;t+=1)e[za[t].charCodeAt(0)]=t;return e})();function Wa(e,t,s){const r=qa[e];if(!(r>-1)){if(-2===r)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)s(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function Va(e){const t=[],s=e=>{t.push(String.fromCodePoint(e))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},n=e=>{!function(e,t,s){if(0===t.utf8seq){if(e<=127)return void s(e);for(let s=1;s<6;s+=1)if(!(e>>7-s&1)){t.utf8seq=s;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&s(t.codepoint)}}(e,r,s)};for(let i=0;i<e.length;i+=1)Wa(e.charCodeAt(i),a,n);return t.join("")}function Ha(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}t(e)}function Ga(e){const t=[],s={queue:0,queuedBits:0},r=e=>{t.push(e)};for(let a=0;a<e.length;a+=1)Wa(e.charCodeAt(a),s,r);return new Uint8Array(t)}function Ja(e){const t=[];return function(e,t){for(let s=0;s<e.length;s+=1){let r=e.charCodeAt(s);if(r>55295&&r<=56319){const t=1024*(r-55296)&65535;r=65536+(e.charCodeAt(s+1)-56320&65535|t),s+=1}Ha(r,t)}}(e,(e=>t.push(e))),new Uint8Array(t)}const Ya=()=>"undefined"!=typeof window&&"undefined"!=typeof document,Ka={tested:!1,writable:!1},Za=()=>{if(!Ya())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(t){return!1}if(Ka.tested)return Ka.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ka.tested=!0,Ka.writable=!0}catch(t){Ka.tested=!0,Ka.writable=!1}return Ka.writable};const Xa=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>ss((async()=>{const{default:e}=await Promise.resolve().then((()=>_s));return{default:e}}),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},Qa=async(e,t,s)=>{await e.setItem(t,JSON.stringify(s))},en=async(e,t)=>{const s=await e.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch(r){return s}},tn=async(e,t)=>{await e.removeItem(t)};class sn{constructor(){this.promise=new sn.promiseConstructor(((e,t)=>{this.resolve=e,this.reject=t}))}}function rn(e){const t=e.split(".");if(3!==t.length)throw new Ma("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!Na.test(t[s]))throw new Ma("JWT not in base64url format");return{header:JSON.parse(Va(t[0])),payload:JSON.parse(Va(t[1])),signature:Ga(t[2]),raw:{header:t[0],payload:t[1]}}}function an(e){return("0"+e.toString(16)).substr(-2)}async function nn(e){if(!("undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),s=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(s);return Array.from(r).map((e=>String.fromCharCode(e))).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function on(e,t,s=!1){const r=function(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let s="";for(let r=0;r<56;r++)s+=e.charAt(Math.floor(Math.random()*t));return s}return crypto.getRandomValues(e),Array.from(e,an).join("")}();let a=r;s&&(a+="/PASSWORD_RECOVERY"),await Qa(e,`${t}-code-verifier`,a);const n=await nn(r);return[n,r===n?"plain":"s256"]}sn.promiseConstructor=Promise;const ln=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const cn=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),dn=[502,503,504];async function un(e){var t,s;if(!("object"==typeof(s=e)&&null!==s&&"status"in s&&"ok"in s&&"json"in s&&"function"==typeof s.json))throw new La(cn(e),0);if(dn.includes(e.status))throw new La(cn(e),e.status);let r,a;try{r=await e.json()}catch(i){throw new Pa(cn(i),i)}const n=function(e){const t=e.headers.get(ka);if(!t)return null;if(!t.match(ln))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(i){return null}}(e);if(n&&n.getTime()>=Sa.timestamp&&"object"==typeof r&&r&&"string"==typeof r.code?a=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(a=r.error_code),a){if("weak_password"===a)throw new Ua(cn(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===a)throw new Ia}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce(((e,t)=>e&&"string"==typeof t),!0))throw new Ua(cn(r),e.status,r.weak_password.reasons);throw new Ca(cn(r),e.status||500,a)}async function hn(e,t,s,r){var a;const n=Object.assign({},null==r?void 0:r.headers);n[ka]||(n[ka]=Sa.name),(null==r?void 0:r.jwt)&&(n.Authorization=`Bearer ${r.jwt}`);const i=null!==(a=null==r?void 0:r.query)&&void 0!==a?a:{};(null==r?void 0:r.redirectTo)&&(i.redirect_to=r.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await async function(e,t,s,r,a,n){const i=((e,t,s,r)=>{const a={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),s))})(t,r,a,n);let o;try{o=await e(s,Object.assign({},i))}catch(l){throw console.error(l),new La(cn(l),0)}o.ok||await un(o);if(null==r?void 0:r.noResolveJson)return o;try{return await o.json()}catch(l){await un(l)}}(e,t,s+o,{headers:n,noResolveJson:null==r?void 0:r.noResolveJson},{},null==r?void 0:r.body);return(null==r?void 0:r.xform)?null==r?void 0:r.xform(l):{data:Object.assign({},l),error:null}}function mn(e){var t;let s=null;var r;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(s=Object.assign({},e),e.expires_at||(s.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)));return{data:{session:s,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function pn(e){const t=mn(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce(((e,t)=>e&&"string"==typeof t),!0)&&(t.data.weak_password=e.weak_password),t}function gn(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function fn(e){return{data:e,error:null}}function yn(e){const{action_link:t,email_otp:s,hashed_token:r,redirect_to:a,verification_type:n}=e,i=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(s[r[a]]=e[r[a]])}return s}(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:s,hashed_token:r,redirect_to:a,verification_type:n},user:Object.assign({},i)},error:null}}function bn(e){return e}class xn{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=Xa(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await hn(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Ta(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await hn(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:gn})}catch(s){if(Ta(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(s[r[a]]=e[r[a]])}return s}(e,["options"]),r=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(r.new_email=null==s?void 0:s.newEmail,delete r.newEmail),await hn(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:yn,redirectTo:null==t?void 0:t.redirectTo})}catch(t){if(Ta(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await hn(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:gn})}catch(t){if(Ta(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,r,a,n,i,o;try{const l={nextPage:null,lastPage:0,total:0},c=await hn(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(s=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==s?s:"",per_page:null!==(a=null===(r=null==e?void 0:e.perPage)||void 0===r?void 0:r.toString())&&void 0!==a?a:""},xform:bn});if(c.error)throw c.error;const d=await c.json(),u=null!==(n=c.headers.get("x-total-count"))&&void 0!==n?n:0,h=null!==(o=null===(i=c.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach((e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),s=JSON.parse(e.split(";")[1].split("=")[1]);l[`${s}Page`]=t})),l.total=parseInt(u)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(Ta(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){try{return await hn(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:gn})}catch(t){if(Ta(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await hn(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:gn})}catch(s){if(Ta(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){try{return await hn(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:gn})}catch(s){if(Ta(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){try{const{data:t,error:s}=await hn(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:s}}catch(t){if(Ta(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await hn(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Ta(t))return{data:null,error:t};throw t}}}const vn={getItem:e=>Za()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Za()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Za()&&globalThis.localStorage.removeItem(e)}};function wn(e={}){return{getItem:t=>e[t]||null,setItem:(t,s)=>{e[t]=s},removeItem:t=>{delete e[t]}}}const jn=!!(globalThis&&Za()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class _n extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class kn extends _n{}async function Sn(e,t,s){jn&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout((()=>{r.abort(),jn&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)}),t),await Promise.resolve().then((()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},(async r=>{if(!r){if(0===t)throw jn&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new kn(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(jn)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}jn&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,r.name);try{return await s()}finally{jn&&console.log("@supabase/gotrue-js: navigatorLock: released",e,r.name)}}))))}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();const Nn={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:_a,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function En(e,t,s){return await s()}class Tn{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Tn.nextInstanceID,Tn.nextInstanceID+=1,this.instanceID>0&&Ya()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},Nn),e);if(this.logDebugMessages=!!r.debug,"function"==typeof r.debug&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new xn({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=Xa(r.fetch),this.lock=r.lock||En,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Ya()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=Sn:this.lock=En,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:Za()?this.storage=vn:(this.memoryStorage={},this.storage=wn(this.memoryStorage)):(this.memoryStorage={},this.storage=wn(this.memoryStorage)),Ya()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}null===(s=this.broadcastChannel)||void 0===s||s.addEventListener("message",(async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}))}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${va}) ${(new Date).toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,(async()=>await this._initialize())))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},s=new URL(e);if(s.hash&&"#"===s.hash[0])try{new URLSearchParams(s.hash.substring(1)).forEach(((e,s)=>{t[s]=e}))}catch(r){}return s.searchParams.forEach(((e,s)=>{t[s]=e})),t}(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),Ya()&&this.detectSessionInUrl&&"none"!==s){const{data:r,error:a}=await this._getSessionFromURL(t,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),function(e){return Ta(e)&&"AuthImplicitGrantRedirectError"===e.name}(a)){const t=null===(e=a.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:a}}return await this._removeSession(),{error:a}}const{session:n,redirectType:i}=r;return this._debug("#_initialize()","detected session in URL",n,"redirect type",i),await this._saveSession(n),setTimeout((async()=>{"recovery"===i?await this._notifyAllSubscribers("PASSWORD_RECOVERY",n):await this._notifyAllSubscribers("SIGNED_IN",n)}),0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ta(t)?{error:t}:{error:new Pa("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,r;try{const a=await hn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(s=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==s?s:{},gotrue_meta_security:{captcha_token:null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken}},xform:mn}),{data:n,error:i}=a;if(i||!n)return{data:{user:null,session:null},error:i};const o=n.session,l=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(a){if(Ta(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,s,r;try{let a;if("email"in e){const{email:s,password:r,options:n}=e;let i=null,o=null;"pkce"===this.flowType&&([i,o]=await on(this.storage,this.storageKey)),a=await hn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==n?void 0:n.emailRedirectTo,body:{email:s,password:r,data:null!==(t=null==n?void 0:n.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:i,code_challenge_method:o},xform:mn})}else{if(!("phone"in e))throw new $a("You must provide either an email or phone number and a password");{const{phone:t,password:n,options:i}=e;a=await hn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:n,data:null!==(s=null==i?void 0:i.data)&&void 0!==s?s:{},channel:null!==(r=null==i?void 0:i.channel)&&void 0!==r?r:"sms",gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:mn})}}const{data:n,error:i}=a;if(i||!n)return{data:{user:null,session:null},error:i};const o=n.session,l=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(a){if(Ta(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:s,password:r,options:a}=e;t=await hn(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:r,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:pn})}else{if(!("phone"in e))throw new $a("You must provide either an email or phone number and a password");{const{phone:s,password:r,options:a}=e;t=await hn(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:r,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:pn})}}const{data:s,error:r}=t;return r?{data:{user:null,session:null},error:r}:s&&s.session&&s.user?(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r}):{data:{user:null,session:null},error:new Aa}}catch(t){if(Ta(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,r,a;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(s=e.options)||void 0===s?void 0:s.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:null===(a=e.options)||void 0===a?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,(async()=>this._exchangeCodeForSession(e)))}async _exchangeCodeForSession(e){const t=await en(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(null!=t?t:"").split("/");try{const{data:t,error:a}=await hn(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:mn});if(await tn(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=r?r:null}),error:a}):{data:{user:null,session:null,redirectType:null},error:new Aa}}catch(a){if(Ta(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:s,token:r,access_token:a,nonce:n}=e,i=await hn(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:a,nonce:n,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:mn}),{data:o,error:l}=i;return l?{data:{user:null,session:null},error:l}:o&&o.session&&o.user?(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:o,error:l}):{data:{user:null,session:null},error:new Aa}}catch(t){if(Ta(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,r,a,n;try{if("email"in e){const{email:r,options:a}=e;let n=null,i=null;"pkce"===this.flowType&&([n,i]=await on(this.storage,this.storageKey));const{error:o}=await hn(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:r,data:null!==(t=null==a?void 0:a.data)&&void 0!==t?t:{},create_user:null===(s=null==a?void 0:a.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken},code_challenge:n,code_challenge_method:i},redirectTo:null==a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){const{phone:t,options:s}=e,{data:i,error:o}=await hn(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(r=null==s?void 0:s.data)&&void 0!==r?r:{},create_user:null===(a=null==s?void 0:s.shouldCreateUser)||void 0===a||a,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},channel:null!==(n=null==s?void 0:s.channel)&&void 0!==n?n:"sms"}});return{data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:o}}throw new $a("You must provide either an email or phone number.")}catch(i){if(Ta(i))return{data:{user:null,session:null},error:i};throw i}}async verifyOtp(e){var t,s;try{let r,a;"options"in e&&(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo,a=null===(s=e.options)||void 0===s?void 0:s.captchaToken);const{data:n,error:i}=await hn(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:r,xform:mn});if(i)throw i;if(!n)throw new Error("An error occurred on token verification.");const o=n.session,l=n.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(r){if(Ta(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,s,r;try{let a=null,n=null;return"pkce"===this.flowType&&([a,n]=await on(this.storage,this.storageKey)),await hn(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(s=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==s?s:void 0}),(null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:n}),headers:this.headers,xform:fn})}catch(a){if(Ta(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._reauthenticate()))}async _reauthenticate(){try{return await this._useSession((async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new Ia;const{error:r}=await hn(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}}))}catch(e){if(Ta(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:a}=e,{error:n}=await hn(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},redirectTo:null==a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:n}}if("phone"in e){const{phone:s,type:r,options:a}=e,{data:n,error:i}=await hn(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:null==n?void 0:n.message_id},error:i}}throw new $a("You must provide either an email or phone number and a type")}catch(t){if(Ta(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,(async()=>this._useSession((async e=>e))))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch(e){}})()),s}return await this.lock(`lock:${this.storageKey}`,e,(async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await en(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=!!e.expires_at&&1e3*e.expires_at-Date.now()<ja;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,s,r)=>(t||"user"!==s||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,s,r))})}return{data:{session:e},error:null}}const{session:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,(async()=>await this._getUser()))}async _getUser(e){try{return e?await hn(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:gn}):await this._useSession((async e=>{var t,s,r;const{data:a,error:n}=e;if(n)throw n;return(null===(t=a.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await hn(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(r=null===(s=a.session)||void 0===s?void 0:s.access_token)&&void 0!==r?r:void 0,xform:gn}):{data:{user:null},error:new Ia}}))}catch(t){if(Ta(t))return function(e){return Ta(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await tn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._updateUser(e,t)))}async _updateUser(e,t={}){try{return await this._useSession((async s=>{const{data:r,error:a}=s;if(a)throw a;if(!r.session)throw new Ia;const n=r.session;let i=null,o=null;"pkce"===this.flowType&&null!=e.email&&([i,o]=await on(this.storage,this.storageKey));const{data:l,error:c}=await hn(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:i,code_challenge_method:o}),jwt:n.access_token,xform:gn});if(c)throw c;return n.user=l.user,await this._saveSession(n),await this._notifyAllSubscribers("USER_UPDATED",n),{data:{user:n.user},error:null}}))}catch(s){if(Ta(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._setSession(e)))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ia;const t=Date.now()/1e3;let s=t,r=!0,a=null;const{payload:n}=rn(e.access_token);if(n.exp&&(s=n.exp,r=s<=t),r){const{session:t,error:s}=await this._callRefreshToken(e.refresh_token);if(s)return{data:{user:null,session:null},error:s};if(!t)return{data:{user:null,session:null},error:null};a=t}else{const{data:r,error:n}=await this._getUser(e.access_token);if(n)throw n;a={access_token:e.access_token,refresh_token:e.refresh_token,user:r.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(Ta(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._refreshSession(e)))}async _refreshSession(e){try{return await this._useSession((async t=>{var s;if(!e){const{data:r,error:a}=t;if(a)throw a;e=null!==(s=r.session)&&void 0!==s?s:void 0}if(!(null==e?void 0:e.refresh_token))throw new Ia;const{session:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}}))}catch(t){if(Ta(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Ya())throw new Oa("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Oa(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new Ra("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new Oa("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Ra("No code detected.");const{data:t,error:s}=await this._exchangeCodeForSession(e.code);if(s)throw s;const r=new URL(window.location.href);return r.searchParams.delete("code"),window.history.replaceState(window.history.state,"",r.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:a,refresh_token:n,expires_in:i,expires_at:o,token_type:l}=e;if(!(a&&i&&n&&l))throw new Oa("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(i);let u=c+d;o&&(u=parseInt(o));const h=u-c;1e3*h<=wa&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${d}s`);const m=u-d;c-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,u,c):c-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,u,c);const{data:p,error:g}=await this._getUser(a);if(g)throw g;const f={provider_token:s,provider_refresh_token:r,access_token:a,expires_in:d,expires_at:u,refresh_token:n,token_type:l,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:f,redirectType:e.type},error:null}}catch(s){if(Ta(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await en(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._signOut(e)))}async _signOut({scope:e}={scope:"global"}){return await this._useSession((async t=>{var s;const{data:r,error:a}=t;if(a)return{error:a};const n=null===(s=r.session)||void 0===s?void 0:s.access_token;if(n){const{error:t}=await this.admin.signOut(n,e);if(t&&(!function(e){return Ta(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await tn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>{await this.initializePromise,await this._acquireLock(-1,(async()=>{this._emitInitialSession(t)}))})(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession((async t=>{var s,r;try{const{data:{session:r},error:a}=t;if(a)throw a;await(null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(a){await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}}))}async resetPasswordForEmail(e,t={}){let s=null,r=null;"pkce"===this.flowType&&([s,r]=await on(this.storage,this.storageKey,!0));try{return await hn(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(Ta(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(Ta(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:r}=await this._useSession((async t=>{var s,r,a,n,i;const{data:o,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(s=e.options)||void 0===s?void 0:s.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(a=e.options)||void 0===a?void 0:a.queryParams,skipBrowserRedirect:!0});return await hn(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(i=null===(n=o.session)||void 0===n?void 0:n.access_token)&&void 0!==i?i:void 0})}));if(r)throw r;return Ya()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null==s?void 0:s.url),{data:{provider:e.provider,url:null==s?void 0:s.url},error:null}}catch(s){if(Ta(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession((async t=>{var s,r;const{data:a,error:n}=t;if(n)throw n;return await hn(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(r=null===(s=a.session)||void 0===s?void 0:s.access_token)&&void 0!==r?r:void 0})}))}catch(t){if(Ta(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const a=Date.now();return await(s=async s=>(s>0&&await async function(e){return await new Promise((t=>{setTimeout((()=>t(null)),e)}))}(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await hn(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:mn})),r=(e,t)=>{const s=200*Math.pow(2,e);return t&&Da(t)&&Date.now()+s-a<wa},new Promise(((e,t)=>{(async()=>{for(let n=0;n<1/0;n++)try{const t=await s(n);if(!r(n,null,t))return void e(t)}catch(a){if(!r(n,a))return void t(a)}})()})))}catch(a){if(this._debug(t,"error",a),Ta(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(t,"end")}var s,r}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),Ya()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await en(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s))return this._debug(t,"session is not valid"),void(null!==s&&await this._removeSession());const r=1e3*(null!==(e=s.expires_at)&&void 0!==e?e:1/0)-Date.now()<ja;if(this._debug(t,`session has${r?"":" not"} expired with margin of 90000s`),r){if(this.autoRefreshToken&&s.refresh_token){const{error:e}=await this._callRefreshToken(s.refresh_token);e&&(console.error(e),Da(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){return this._debug(t,"error",s),void console.error(s)}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new Ia;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new sn;const{data:t,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!t.session)throw new Ia;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const r={session:t.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(a){if(this._debug(r,"error",a),Ta(a)){const e={session:null,error:a};return Da(a)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(s=this.refreshingDeferred)||void 0===s||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],a=Array.from(this.stateChangeEmitters.values()).map((async s=>{try{await s.callback(e,t)}catch(a){r.push(a)}}));if(await Promise.all(a),r.length>0){for(let e=0;e<r.length;e+=1)console.error(r[e]);throw r[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Qa(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await tn(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ya()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval((()=>this._autoRefreshTokenTick()),wa);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout((async()=>{await this.initializePromise,await this._autoRefreshTokenTick()}),0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,(async()=>{try{const t=Date.now();try{return await this._useSession((async e=>{const{data:{session:s}}=e;if(!s||!s.refresh_token||!s.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const r=Math.floor((1e3*s.expires_at-t)/wa);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),r<=3&&await this._callRefreshToken(s.refresh_token)}))}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(!(e.isAcquireTimeout||e instanceof _n))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ya()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,(async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const r=[`provider=${encodeURIComponent(t)}`];if((null==s?void 0:s.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),(null==s?void 0:s.scopes)&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),"pkce"===this.flowType){const[e,t]=await on(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});r.push(s.toString())}if(null==s?void 0:s.queryParams){const e=new URLSearchParams(s.queryParams);r.push(e.toString())}return(null==s?void 0:s.skipBrowserRedirect)&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession((async t=>{var s;const{data:r,error:a}=t;return a?{data:null,error:a}:await hn(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token})}))}catch(t){if(Ta(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession((async t=>{var s,r;const{data:a,error:n}=t;if(n)return{data:null,error:n};const i=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:o,error:l}=await hn(this.fetch,"POST",`${this.url}/factors`,{body:i,headers:this.headers,jwt:null===(s=null==a?void 0:a.session)||void 0===s?void 0:s.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(r=null==o?void 0:o.totp)||void 0===r?void 0:r.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})}))}catch(t){if(Ta(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var s;const{data:r,error:a}=t;if(a)return{data:null,error:a};const{data:n,error:i}=await hn(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token});return i?{data:null,error:i}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+n.expires_in},n)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",n),{data:n,error:i})}))}catch(t){if(Ta(t))return{data:null,error:t};throw t}}))}async _challenge(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var s;const{data:r,error:a}=t;return a?{data:null,error:a}:await hn(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token})}))}catch(t){if(Ta(t))return{data:null,error:t};throw t}}))}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(null==e?void 0:e.factors)||[],r=s.filter((e=>"totp"===e.factor_type&&"verified"===e.status)),a=s.filter((e=>"phone"===e.factor_type&&"verified"===e.status));return{data:{all:s,totp:r,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,(async()=>await this._useSession((async e=>{var t,s;const{data:{session:r},error:a}=e;if(a)return{data:null,error:a};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:n}=rn(r.access_token);let i=null;n.aal&&(i=n.aal);let o=i;(null!==(s=null===(t=r.user.factors)||void 0===t?void 0:t.filter((e=>"verified"===e.status)))&&void 0!==s?s:[]).length>0&&(o="aal2");return{data:{currentLevel:i,nextLevel:o,currentAuthenticationMethods:n.amr||[]},error:null}}))))}async fetchJwk(e,t={keys:[]}){let s=t.keys.find((t=>t.kid===e));if(s)return s;if(s=this.jwks.keys.find((t=>t.kid===e)),s&&this.jwks_cached_at+6e5>Date.now())return s;const{data:r,error:a}=await hn(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;if(!r.keys||0===r.keys.length)throw new Ma("JWKS is empty");if(this.jwks=r,this.jwks_cached_at=Date.now(),s=r.keys.find((t=>t.kid===e)),!s)throw new Ma("No matching signing key found in JWKS");return s}async getClaims(e,t={keys:[]}){try{let s=e;if(!s){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};s=e.session.access_token}const{header:r,payload:a,signature:n,raw:{header:i,payload:o}}=rn(s);if(function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(a.exp),!r.kid||"HS256"===r.alg||!("crypto"in globalThis)||!("subtle"in globalThis.crypto)){const{error:e}=await this.getUser(s);if(e)throw e;return{data:{claims:a,header:r,signature:n},error:null}}const l=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(r.alg),c=await this.fetchJwk(r.kid,t),d=await crypto.subtle.importKey("jwk",c,l,!0,["verify"]);if(!(await crypto.subtle.verify(l,d,n,Ja(`${i}.${o}`))))throw new Ma("Invalid JWT signature");return{data:{claims:a,header:r,signature:n},error:null}}catch(s){if(Ta(s))return{data:null,error:s};throw s}}}Tn.nextInstanceID=0;const Cn=Tn;class Pn extends Cn{constructor(e){super(e)}}var Bn=function(e,t,s,r){return new(s||(s=Promise))((function(a,n){function i(e){try{l(r.next(e))}catch(t){n(t)}}function o(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(i,o)}l((r=r.apply(e,t||[])).next())}))};class In{constructor(e,t,s){var r,a,n;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const i=e.replace(/\/$/,"");this.realtimeUrl=`${i}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${i}/auth/v1`,this.storageUrl=`${i}/storage/v1`,this.functionsUrl=`${i}/functions/v1`;const o=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,l=function(e,t){const{db:s,auth:r,realtime:a,global:n}=e,{db:i,auth:o,realtime:l,global:c}=t,d={db:Object.assign(Object.assign({},i),s),auth:Object.assign(Object.assign({},o),r),realtime:Object.assign(Object.assign({},l),a),global:Object.assign(Object.assign({},c),n),accessToken:()=>xa(this,void 0,void 0,(function*(){return""}))};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}(null!=s?s:{},{db:pa,realtime:fa,auth:Object.assign(Object.assign({},ga),{storageKey:o}),global:ma});this.storageKey=null!==(r=l.auth.storageKey)&&void 0!==r?r:"",this.headers=null!==(a=l.global.headers)&&void 0!==a?a:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(n=l.auth)&&void 0!==n?n:{},this.headers,l.global.fetch),this.fetch=ba(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new Qs(`${i}/rest/v1`,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),l.accessToken||this._listenForAuthEvents()}get functions(){return new ds(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new ua(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Bn(this,void 0,void 0,(function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return null!==(t=null===(e=s.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null}))}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,storageKey:a,flowType:n,lock:i,debug:o},l,c){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Pn({url:this.authUrl,headers:Object.assign(Object.assign({},d),l),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,flowType:n,lock:i,debug:o,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Fr(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)}))}_handleTokenChanged(e,t,s){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===s?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=s}}const An="undefined"!=typeof window?window.location.origin.replace("http:","https:"):"",$n=(On="https://xuakhnuxkxjopfrshsny.supabase.co",Rn="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh1YWtobnV4a3hqb3BmcnNoc255Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY3Njk1NzgsImV4cCI6MjA2MjM0NTU3OH0.u9G84BiP3QEgBHKje0TQPiT45GR2n0-tni83VfuNNWs",Ln={auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,storage:"undefined"!=typeof window?window.localStorage:void 0,storageKey:"seatyr-auth-token",redirectTo:`${An}/auth/callback`,onAuthStateChange:(e,t)=>{if("SIGNED_IN"===e||"TOKEN_REFRESHED"===e){const e=new URL(window.location.href);e.searchParams.delete("code"),e.searchParams.delete("error"),e.searchParams.delete("error_description"),window.history.replaceState({},"",e.toString())}}}},new In(On,Rn,Ln));var On,Rn,Ln;const Dn=({onClose:t})=>{const[s,r]=e.useState(null),[a,n]=e.useState("sign_in"),[i,o]=e.useState(!1),[l,c]=e.useState(0),[d,u]=e.useState(0),[h,m]=e.useState(0);e.useEffect((()=>{const{data:{subscription:e}}=$n.auth.onAuthStateChange(((e,s)=>{var a;"SIGNED_IN"===e?t():"SIGNED_OUT"===e?o(!1):"USER_UPDATED"===e?(null==(a=null==s?void 0:s.user)?void 0:a.email_confirmed_at)&&t():"PASSWORD_RECOVERY"===e&&(n("sign_in"),r("Please enter your new password"))})),s=new URL(window.location.href),a=s.searchParams.get("error"),i=s.searchParams.get("error_description"),l=s.searchParams.get("code");a&&i&&r(decodeURIComponent(i)),(a||i||l)&&(s.searchParams.delete("error"),s.searchParams.delete("error_description"),s.searchParams.delete("code"),window.history.replaceState({},"",s.toString()));const d=localStorage.getItem("lastEmailSent"),u=localStorage.getItem("dailyEmailCount"),h=localStorage.getItem("emailCountDate");d&&c(parseInt(d));const p=(new Date).toDateString();return h===p&&u?m(parseInt(u)):(localStorage.setItem("emailCountDate",p),localStorage.setItem("dailyEmailCount","0"),m(0)),()=>{e.unsubscribe()}}),[t]),e.useEffect((()=>{const e=setInterval((()=>{const e=Date.now()-l;u(e<3e3?Math.ceil((3e3-e)/1e3):0)}),1e3);return()=>clearInterval(e)}),[l]);const p=window.location.origin;return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:x.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full shadow-2xl",children:[x.jsxs("div",{className:"flex justify-between items-center mb-4",children:[x.jsxs("div",{className:"flex space-x-4",children:[x.jsx("button",{onClick:()=>{n("sign_in"),o(!1),r(null)},className:"px-4 py-2 rounded-md transition-all "+("sign_in"===a?"font-bold text-black border-2 border-green-500":"text-gray-500 border border-gray-300"),children:"Log In"}),x.jsx("button",{onClick:()=>{n("sign_up"),o(!1),r(null)},className:"px-4 py-2 rounded-md transition-all "+("sign_up"===a?"font-bold text-black border-2 border-green-500":"text-gray-500 border border-gray-300"),children:"Sign Up"})]}),x.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 text-2xl","aria-label":"Close",children:""})]}),x.jsxs("div",{className:"mb-4 space-y-2",children:[x.jsxs("div",{className:"p-3 bg-blue-50 rounded-md",children:[x.jsx("p",{className:"text-sm text-blue-700",children:"Password requirements:"}),x.jsxs("ul",{className:"text-sm text-blue-700 list-disc list-inside mt-1",children:[x.jsx("li",{children:"At least 6 characters long"}),x.jsx("li",{children:"Contains at least one letter"}),x.jsx("li",{children:"Contains at least one number"})]})]}),i&&x.jsx("div",{className:"p-4 bg-green-50 rounded-md",children:x.jsxs("p",{className:"text-sm text-green-700",children:["Please check your email to verify your account. The verification link will expire in 1 hour.",d>0&&x.jsxs("span",{className:"block mt-2",children:["You can request another email in ",d," seconds."]}),x.jsxs("span",{className:"block mt-2",children:["Email requests remaining today: ",10-h,"/10"]})]})}),s&&x.jsx("div",{className:"p-4 bg-red-50 rounded-md",children:x.jsx("p",{className:"text-sm text-red-700",children:s})})]}),x.jsx(es,{supabaseClient:$n,appearance:{theme:st,variables:{default:{colors:{brand:"#2563eb",brandAccent:"#1d4ed8"}}}},view:a,showLinks:"sign_in"===a,providers:[],redirectTo:p,onError:e=>{console.error("Auth error:",e),h>=10?r("Daily email limit reached (10/10). Please try again tomorrow."):e.message.includes("rate limit")?r(`Please wait ${d} seconds before trying again.`):e.message.includes("invalid_credentials")?r("sign_in"===a?'Invalid email or password. Please try again or click "Forgot your password?" below.':"Please ensure your password meets all requirements listed above."):e.message.includes("Email not confirmed")?r("Please check your email and click the confirmation link before signing in."):e.message.includes("User already registered")?r("An account with this email already exists. Please sign in instead."):r(e.message)},onEmailVerificationSent:()=>{const e=Date.now(),t=(new Date).toDateString(),s=h+1;c(e),m(s),localStorage.setItem("lastEmailSent",e.toString()),localStorage.setItem("dailyEmailCount",s.toString()),localStorage.setItem("emailCountDate",t),o(!0)}})]})})},Un=({onClose:t,onSuccess:s})=>{const[r,a]=e.useState(""),[n,i]=e.useState(null),[o,l]=e.useState(!1);return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:x.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full shadow-2xl",children:[x.jsxs("h2",{className:"text-2xl font-bold text-[#7973BB] mb-4 flex items-center",children:[x.jsx(L,{className:"mr-2 text-yellow-500"}),"Beta Tester Access"]}),x.jsxs("form",{onSubmit:async e=>{e.preventDefault(),i(null),l(!0);try{await(async()=>{var e;const{data:t,error:s}=await $n.auth.getSession(),a=null==(e=null==t?void 0:t.session)?void 0:e.user;if(!a)return void alert("You must be signed in to use a beta code.");const n=r.trim(),{data:i,error:o}=await $n.from("beta_codes").select("*").eq("code",n).single();if(!i||o)return alert("Invalid or expired code."),void console.warn("Beta code validation failed:",null==o?void 0:o.message);const l=new Date;l.setDate(l.getDate()+30);const{error:c}=await $n.from("trial_subscriptions").upsert({user_id:a.id,trial_code:n,start_date:new Date,expires_on:l});if(c)return alert("Failed to activate trial. Please try again."),void console.error("Trial upsert error:",c.message);alert("Premium trial activated!"),window.location.reload()})(),s()}catch(t){console.error("Error activating beta code:",t),i(t instanceof Error?t.message:"An unexpected error occurred")}finally{l(!1)}},className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{htmlFor:"betaCode",className:"block text-sm font-medium text-gray-700 mb-1",children:"Enter your beta tester code:"}),x.jsx("input",{id:"betaCode",type:"text",value:r,onChange:e=>a(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#7973BB]",placeholder:"e.g., bt-rabbit-car"})]}),n&&x.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:x.jsx("p",{className:"text-red-600 text-sm",children:n})}),x.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-md p-3",children:x.jsx("p",{className:"text-sm text-amber-700",children:"Beta tester codes provide 30 days of premium access. Each code can be used up to 3 times."})}),x.jsxs("div",{className:"flex justify-end space-x-2",children:[x.jsx(re,{variant:"secondary",onClick:t,disabled:o,children:"Cancel"}),x.jsx(re,{type:"submit",disabled:!r.trim()||o,icon:o?x.jsx("span",{className:"animate-spin",children:""}):void 0,children:o?"Activating...":"Activate Trial"})]})]})]})})};var Mn,zn="https://js.stripe.com/v3",Fn=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,qn="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",Wn=function(e){var t=document.createElement("script");t.src="".concat(zn).concat("");var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(t),t},Vn=null,Hn=null,Gn=null,Jn=function(e){return null!==Vn?Vn:(Vn=new Promise((function(t,s){if("undefined"!=typeof window&&"undefined"!=typeof document)if(window.Stripe&&e&&console.warn(qn),window.Stripe)t(window.Stripe);else try{var r=function(){for(var e=document.querySelectorAll('script[src^="'.concat(zn,'"]')),t=0;t<e.length;t++){var s=e[t];if(Fn.test(s.src))return s}return null}();if(r&&e)console.warn(qn);else if(r){if(r&&null!==Gn&&null!==Hn){var a;r.removeEventListener("load",Gn),r.removeEventListener("error",Hn),null===(a=r.parentNode)||void 0===a||a.removeChild(r),r=Wn()}}else r=Wn();Gn=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}}(t,s),Hn=function(e){return function(){e(new Error("Failed to load Stripe.js"))}}(s),r.addEventListener("load",Gn),r.addEventListener("error",Hn)}catch(n){return void s(n)}else t(null)}))).catch((function(e){return Vn=null,Promise.reject(e)}))},Yn=!1,Kn=function(){return Mn||(Mn=Jn(null).catch((function(e){return Mn=null,Promise.reject(e)})))};Promise.resolve().then((function(){return Kn()})).catch((function(e){Yn||console.warn(e)}));const Zn=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];Yn=!0;var r=Date.now();return Kn().then((function(e){return function(e,t,s){if(null===e)return null;var r=e.apply(void 0,t);return function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"2.4.0",startTime:t})}(r,s),r}(e,t,r)}))}(void 0),Xn=async e=>{try{if(!e)throw new Error("User ID is required");const{data:s}=await $n.from("subscriptions").select("*").eq("user_id",e).eq("status","active").is("canceled_at",null).limit(1);if((null==s?void 0:s.length)>0)throw new Error("You already have an active subscription");console.log("Creating checkout session for user:",e);try{const t=await fetch("https://xuakhnuxkxjopfrshsny.supabase.co/functions/v1/create-checkout",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh1YWtobnV4a3hqb3BmcnNoc255Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY3Njk1NzgsImV4cCI6MjA2MjM0NTU3OH0.u9G84BiP3QEgBHKje0TQPiT45GR2n0-tni83VfuNNWs"},body:JSON.stringify({userId:e})});if(!t.ok)throw console.error("Error response from create-checkout:",await t.text()),new Error("Failed to create checkout session");{const{sessionId:e,url:s}=await t.json();if(console.log("Checkout session created:",e),s)return void(window.location.href=s);const r=await Zn,{error:a}=await r.redirectToCheckout({sessionId:e});if(a)throw console.error("Stripe redirect error:",a),a}}catch(t){console.error("Edge function failed, using direct link fallback",t),window.location.href="https://buy.stripe.com/3cs4ju9Y113D8hi5kk"}}catch(t){throw console.error("Error redirecting to checkout:",t),alert("Failed to start checkout process: "+(t.message||"Please try again.")),t}},Qn=async(e,t)=>{try{if(!e)throw new Error("User ID is required");const s="https://xuakhnuxkxjopfrshsny.supabase.co/functions/v1/manage-subscription",r=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh1YWtobnV4a3hqb3BmcnNoc255Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY3Njk1NzgsImV4cCI6MjA2MjM0NTU3OH0.u9G84BiP3QEgBHKje0TQPiT45GR2n0-tni83VfuNNWs"},body:JSON.stringify({userId:e,action:t})});if(!r.ok){const e=await r.json();throw new Error(e.error||`Failed to ${t} subscription`)}return await r.json()}catch(s){throw console.error("Error managing subscription:",s),s}},ei=async e=>{try{if(!e)throw new Error("User ID is required");const t=await fetch("https://xuakhnuxkxjopfrshsny.supabase.co/functions/v1/create-portal-session",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh1YWtobnV4a3hqb3BmcnNoc255Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY3Njk1NzgsImV4cCI6MjA2MjM0NTU3OH0.u9G84BiP3QEgBHKje0TQPiT45GR2n0-tni83VfuNNWs"},body:JSON.stringify({userId:e})});if(!t.ok){const e=await t.json();throw new Error(e.error||"Failed to create customer portal session")}const{url:s}=await t.json();window.location.href=s}catch(t){throw console.error("Error redirecting to customer portal:",t),t}},ti=({onClose:t,userId:s,onSuccess:r})=>{const[a,n]=e.useState(!1),[i,o]=e.useState(!1);return x.jsxs(x.Fragment,{children:[x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:x.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full shadow-2xl",children:[x.jsxs("div",{className:"flex justify-between items-center mb-6",children:[x.jsxs("h2",{className:"text-2xl font-bold text-[#7973BB] flex items-center",children:[x.jsx(L,{className:"w-6 h-6 text-yellow-500 mr-2"}),"Upgrade to Premium"]}),x.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 text-2xl","aria-label":"Close",children:""})]}),x.jsxs("div",{className:"space-y-5",children:[x.jsx("p",{className:"text-lg text-gray-700 mb-4",children:"Great! Please click a button:"}),x.jsx("button",{className:"w-full py-3 px-4 rounded-lg flex items-center justify-center text-[#fff4cd] bg-[#a78bfa] border border-[#a78bfa] font-medium hover:bg-[#a78bfa]/90 transition-colors",onClick:async()=>{try{o(!0),await Xn(s)}catch(e){console.error("Error initiating checkout:",e),alert("Failed to start checkout process. Please try again."),o(!1)}},disabled:i,children:i?"Processing...":"Sign Me Up!"}),x.jsx("button",{className:"w-full py-3 px-4 rounded-lg flex items-center justify-center text-[#a78bfa] bg-[#fff4cd] font-medium hover:bg-[#fff4cd]/90 transition-colors",onClick:()=>n(!0),children:"Beta Tester Code"}),x.jsx("div",{className:"pt-2 text-sm text-gray-500",children:x.jsx("p",{children:"Premium gives you unlimited guests, 50 saved settings, and premium support!"})})]})]})}),a&&x.jsx(Un,{onClose:()=>n(!1),onSuccess:()=>{r&&r(),t()}})]})};function si(e,t){if(!e)return!1;if(["active","trialing","past_due"].includes(e.status))return!0;if(e.current_period_end){if((s=e.current_period_end,isNaN(Number(s))||10!==s.length?new Date(e.current_period_end):new Date(1e3*Number(e.current_period_end)))>new Date)return!0}var s;return!1}function ri(e){return si(e)?Number.MAX_SAFE_INTEGER:80}function ai(e){return si(e)?50:5}function ni(e,t){return si(e)?`${t} guests`:`${t}/80 guests used`}const ii=async(e,t)=>{try{if(localStorage.removeItem("seatyr_recent_tables"),t&&e){const{error:t}=await $n.from("recent_session_settings").delete().eq("user_id",e);t&&console.error("Error clearing recent session settings:",t)}}catch(s){console.error("Error clearing recent session settings:",s)}},oi="seatyr_app_state",li=Array.from({length:10},((e,t)=>({id:t+1,seats:8}))),ci={guests:[],tables:li,constraints:{},adjacents:{},assignments:{},seatingPlans:[],currentPlanIndex:0,subscription:null,userSetTables:!1,user:null,loadedSavedSetting:!1},di=(e,t=8)=>{const s=Math.ceil(e/t);return Array.from({length:s},((e,s)=>({id:s+1,seats:t})))},ui=(e,t)=>{var s;let r;switch(t.type){case"ADD_GUESTS":{const s=[...e.guests,...t.payload],a=s.length,n=ri(e.subscription);if(a>n)return console.log(`Cannot add guests: limit of ${n} exceeded (total: ${a})`),alert(`You can only have up to ${n} guests with your current plan. Upgrade to Premium for unlimited guests.`),e;let i=e.tables;if(!e.userSetTables){const e=s.reduce(((e,t)=>e+t.count),0);i=di(e)}r={...e,guests:s,tables:i,seatingPlans:[]};break}case"REMOVE_GUEST":{const s=[...e.guests],a=s.splice(t.payload,1)[0],n={...e.constraints};delete n[a.name],Object.keys(n).forEach((e=>{delete n[e][a.name]}));const i={...e.adjacents};delete i[a.name],Object.keys(i).forEach((e=>{var t;i[e]=(null==(t=i[e])?void 0:t.filter((e=>e!==a.name)))||[]}));const o={...e.assignments};delete o[a.name];let l=e.tables;if(!e.userSetTables){const e=s.reduce(((e,t)=>e+t.count),0);l=di(e)}r={...e,guests:s,constraints:n,adjacents:i,assignments:o,tables:l,seatingPlans:[]};break}case"RENAME_GUEST":{const s=[...e.guests],a=s[t.payload.index].name;s[t.payload.index]={...s[t.payload.index],name:t.payload.name};const n={...e.constraints};n[a]&&(n[t.payload.name]={...n[a]},delete n[a]),Object.keys(n).forEach((e=>{void 0!==n[e][a]&&(n[e][t.payload.name]=n[e][a],delete n[e][a])}));const i={...e.adjacents};i[a]&&(i[t.payload.name]=[...i[a]],delete i[a]),Object.keys(i).forEach((e=>{i[e]&&(i[e]=i[e].map((e=>e===a?t.payload.name:e)))}));const o={...e.assignments};o[a]&&(o[t.payload.name]=o[a],delete o[a]),r={...e,guests:s,constraints:n,adjacents:i,assignments:o,seatingPlans:[]};break}case"CLEAR_GUESTS":r={...e,guests:[],constraints:{},adjacents:{},assignments:{},seatingPlans:[],tables:li,userSetTables:!1,loadedSavedSetting:!1},e.user&&si(e.subscription)&&ii(e.user.id,!0);break;case"SET_CONSTRAINT":{const{guest1:s,guest2:a,value:n}=t.payload,i={...e.constraints};if(i[s]||(i[s]={}),i[a]||(i[a]={}),i[s][a]=n,i[a][s]=n,"must"!==n){const t={...e.adjacents};t[s]&&(t[s]=t[s].filter((e=>e!==a))),t[a]&&(t[a]=t[a].filter((e=>e!==s))),r={...e,constraints:i,adjacents:t,seatingPlans:[]};break}r={...e,constraints:i,seatingPlans:[]};break}case"SET_ADJACENT":{const{guest1:s,guest2:a}=t.payload,n={...e.adjacents},i={...e.constraints};i[s]||(i[s]={}),i[a]||(i[a]={}),i[s][a]="must",i[a][s]="must",n[s]||(n[s]=[]),n[a]||(n[a]=[]);n[s].includes(a)||n[s].length<2&&n[a].length<2&&(n[s].push(a),n[a].push(s)),r={...e,constraints:i,adjacents:n,seatingPlans:[]};break}case"REMOVE_ADJACENT":{const{guest1:s,guest2:a}=t.payload,n={...e.adjacents};n[s]&&(n[s]=n[s].filter((e=>e!==a))),n[a]&&(n[a]=n[a].filter((e=>e!==s))),r={...e,adjacents:n,seatingPlans:[]};break}case"ADD_TABLE":{const a=[...e.tables],n=a.length?Math.max(...a.map((e=>e.id)))+1:1;a.push({id:n,seats:(null==(s=t.payload)?void 0:s.seats)||8,...t.payload}),r={...e,tables:a,seatingPlans:[],userSetTables:!0};break}case"REMOVE_TABLE":{const s=e.tables.filter((e=>e.id!==t.payload)),a={...e.assignments};Object.keys(a).forEach((e=>{const s=a[e].split(",").map((e=>e.trim())).filter((e=>e!==t.payload.toString()));0===s.length?delete a[e]:a[e]=s.join(",")})),r={...e,tables:s,assignments:a,seatingPlans:[],userSetTables:!0};break}case"UPDATE_TABLE_SEATS":{const s=e.tables.map((e=>e.id===t.payload.id?{...e,seats:t.payload.seats}:e));r={...e,tables:s,seatingPlans:[],userSetTables:!0};break}case"UPDATE_TABLE_NAME":{const s=e.tables.map((e=>e.id===t.payload.id?{...e,name:t.payload.name}:e));r={...e,tables:s,seatingPlans:[]};break}case"UPDATE_ASSIGNMENT":{const s={...e.assignments};t.payload.tables?s[t.payload.name]=t.payload.tables:delete s[t.payload.name],r={...e,assignments:s,seatingPlans:[]};break}case"SET_SEATING_PLANS":r={...e,seatingPlans:t.payload,currentPlanIndex:0};break;case"SET_CURRENT_PLAN_INDEX":r={...e,currentPlanIndex:t.payload};break;case"SET_SUBSCRIPTION":console.log("Setting subscription in app context:",t.payload),r={...e,subscription:t.payload};break;case"SET_USER":console.log("Setting user in app context:",t.payload),r={...e,user:t.payload};break;case"SET_USER_SET_TABLES":r={...e,userSetTables:t.payload};break;case"UPDATE_DEFAULT_TABLES":r={...e,tables:t.payload,seatingPlans:[]};break;case"SET_LOADED_SAVED_SETTING":r={...e,loadedSavedSetting:t.payload};break;case"IMPORT_STATE":{const s={...t.payload,guests:t.payload.guests||[],tables:t.payload.tables||li,constraints:t.payload.constraints||{},adjacents:t.payload.adjacents||{},assignments:t.payload.assignments||{},seatingPlans:t.payload.seatingPlans||[],currentPlanIndex:t.payload.currentPlanIndex||0,userSetTables:void 0===t.payload.userSetTables||t.payload.userSetTables};s.tables&&(s.tables=s.tables.map((e=>e.hasOwnProperty("seats")?e:{...e,seats:8}))),console.log("Importing state with tables:",s.tables),r={...e,...s,subscription:e.subscription,user:e.user,loadedSavedSetting:!0};break}case"RESET":r={...ci,subscription:e.subscription,user:e.user,loadedSavedSetting:!1},e.user&&si(e.subscription)&&ii(e.user.id,!0);break;default:return e}try{const e={...r};delete e.subscription,delete e.user,localStorage.setItem(oi,JSON.stringify(e))}catch(a){console.error("Error saving state:",a)}return r},hi=e.createContext(void 0),mi=({children:t})=>{const[s,r]=e.useReducer(ui,(()=>{try{const e=localStorage.getItem(oi);if(e){const t=JSON.parse(e);return t.subscription&&delete t.subscription,t.user&&delete t.user,{...ci,...t}}}catch(e){console.error("Error loading saved state:",e)}return ci})());return e.useEffect((()=>{(async()=>{try{const{data:e}=await $n.auth.getUser();(null==e?void 0:e.user)&&(console.log("User found:",e.user.id),r({type:"SET_USER",payload:e.user}))}catch(e){console.error("Error fetching user data:",e)}})();const{data:{subscription:e}}=$n.auth.onAuthStateChange(((e,t)=>{console.log("Auth state changed:",e),"SIGNED_IN"===e&&(null==t?void 0:t.user)?r({type:"SET_USER",payload:t.user}):"SIGNED_OUT"===e&&(r({type:"SET_USER",payload:null}),r({type:"SET_SUBSCRIPTION",payload:null}))}));return()=>e.unsubscribe()}),[]),e.useEffect((()=>{(async()=>{try{const{data:{user:e}}=await $n.auth.getUser();if(e){console.log("Fetching subscription for user:",e.id);const{data:t,error:s}=await $n.from("subscriptions").select("*").eq("user_id",e.id).order("current_period_end",{ascending:!1}).limit(1);if(!s&&(null==t?void 0:t.length)>0)return console.log("Found subscription:",t[0]),void r({type:"SET_SUBSCRIPTION",payload:t[0]});s&&console.error("Error fetching subscription:",s);const{data:a,error:n}=await $n.from("trial_subscriptions").select("*").eq("user_id",e.id).gt("expires_on",(new Date).toISOString()).limit(1);if(!n&&(null==a?void 0:a.length)>0){console.log("Found trial subscription:",a[0]);const t={id:`trial-${a[0].id}`,user_id:e.id,status:"active",current_period_end:a[0].expires_on,cancel_at_period_end:!0,trial_end:a[0].expires_on};r({type:"SET_SUBSCRIPTION",payload:t})}else n&&console.error("Error fetching trial subscription:",n)}}catch(e){console.error("Error fetching user subscription:",e)}})()}),[]),e.useEffect((()=>{(async()=>{if(s.user&&si(s.subscription)&&!s.loadedSavedSetting){console.log("Attempting to load recent session settings for premium user");try{const e=await(async(e,t)=>{var s,r;try{const a=localStorage.getItem("seatyr_recent_tables");let n=a?JSON.parse(a):null;if(t&&e){const{data:t,error:a}=await $n.from("recent_session_settings").select("data").eq("user_id",e).order("updated_at",{ascending:!1}).limit(1);a?console.error("Error loading recent session settings:",a):t&&t.length>0&&(null==(r=null==(s=t[0])?void 0:s.data)?void 0:r.tables)&&(n=t[0].data.tables,localStorage.setItem("seatyr_recent_tables",JSON.stringify(n)))}return n}catch(a){return console.error("Error loading recent session settings:",a),null}})(s.user.id,!0);e&&e.length>0&&(console.log("Loaded recent session table settings:",e.length),r({type:"UPDATE_DEFAULT_TABLES",payload:e}),r({type:"SET_USER_SET_TABLES",payload:!0}))}catch(e){console.error("Error loading recent session settings:",e)}}})()}),[s.user,s.subscription,s.loadedSavedSetting]),e.useEffect((()=>{if(!s.userSetTables&&s.guests.length>0){const e=s.guests.reduce(((e,t)=>e+t.count),0),t=di(e);JSON.stringify(t)!==JSON.stringify(s.tables)&&r({type:"UPDATE_DEFAULT_TABLES",payload:t})}}),[s.guests,s.userSetTables]),x.jsx(hi.Provider,{value:{state:s,dispatch:r},children:t})},pi=()=>{const t=e.useContext(hi);if(void 0===t)throw new Error("useApp must be used within an AppProvider");return t},gi=()=>{const[t,s]=e.useState(!1),[r,a]=e.useState(!1),[i,o]=e.useState(null),[l,c]=e.useState(null),[d,u]=e.useState(!1),h=n(),{state:m,dispatch:p}=pi();e.useEffect((()=>{$n.auth.getSession().then((({data:{session:e}})=>{o((null==e?void 0:e.user)??null)}));const{data:{subscription:e}}=$n.auth.onAuthStateChange(((e,t)=>{o((null==t?void 0:t.user)??null)}));return()=>e.unsubscribe()}),[]),e.useEffect((()=>{i?g():(c(null),p({type:"SET_SUBSCRIPTION",payload:null}))}),[i]);const g=async()=>{var e,t;try{console.log("Fetching subscription for user:",i.id);const{data:s,error:r}=await $n.from("subscriptions").select("*").eq("user_id",i.id).order("current_period_end",{ascending:!1}).limit(1);if(r)return void console.error("Error fetching subscription:",r);const a=(null==s?void 0:s[0])||null;if(console.log("Subscription data:",a),a)c(a),p({type:"SET_SUBSCRIPTION",payload:a});else{const{data:s,error:r}=await $n.from("trial_subscriptions").select("*").eq("user_id",i.id).gt("expires_on",(new Date).toISOString()).limit(1);if(r&&console.error("Error fetching trial subscription:",r),s&&s.length>0){console.log("Found active trial:",s[0]);const e={id:`trial-${s[0].id}`,user_id:i.id,status:"active",current_period_start:s[0].start_date,current_period_end:s[0].expires_on,cancel_at_period_end:!0};c(e),p({type:"SET_SUBSCRIPTION",payload:e})}else{const{data:s}=await $n.auth.getUser(),r=null==(t=null==(e=null==s?void 0:s.user)?void 0:e.email)?void 0:t.toLowerCase();if(console.log("User email for premium check:",r),"danabrams999@yahoo.com"===r||"immortality.bytes.book@gmail.com"===r){console.log("Force enabling premium for special user:",r),await fetch("https://xuakhnuxkxjopfrshsny.supabase.co/functions/v1/sync-user-premium",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh1YWtobnV4a3hqb3BmcnNoc255Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY3Njk1NzgsImV4cCI6MjA2MjM0NTU3OH0.u9G84BiP3QEgBHKje0TQPiT45GR2n0-tni83VfuNNWs"},body:JSON.stringify({email:r})}).catch((e=>console.error("Error syncing premium status:",e)));const{data:e}=await $n.from("subscriptions").select("*").eq("user_id",i.id).order("current_period_end",{ascending:!1}).limit(1),t=(null==e?void 0:e[0])||null;t?(console.log("Refreshed subscription data:",t),c(t),p({type:"SET_SUBSCRIPTION",payload:t})):(c(null),p({type:"SET_SUBSCRIPTION",payload:null}))}else c(null),p({type:"SET_SUBSCRIPTION",payload:null})}}}catch(s){console.error("Error in fetchSubscription:",s),c(null),p({type:"SET_SUBSCRIPTION",payload:null})}},f=si(l)||si(m.subscription);return x.jsxs("header",{className:"bg-[#FEF6D1] shadow-md",children:[x.jsx("div",{className:"container mx-auto px-4 py-3",children:x.jsxs("div",{className:"flex flex-col space-y-3 md:space-y-2",children:[x.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center",children:[x.jsxs("div",{className:"flex items-center",children:[x.jsx("img",{src:"https://i.imgur.com/RKDznxk.png",alt:"Seatyr Logo",className:"h-10 w-auto mr-2"}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("h1",{className:"text-2xl font-bold text-[#7973BB]",children:"Seatyr"}),x.jsx("span",{className:"text-xs -mt-1 text-[#7973BB]",children:"Preview Version 0.8"})]})]}),x.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-2 md:mt-0",children:[f&&x.jsxs("span",{className:"flex items-center bg-yellow-500 text-black px-2 py-0.5 rounded-full text-sm font-medium",children:[x.jsx(L,{className:"w-4 h-4 mr-1"}),"Premium"]}),i?x.jsxs(x.Fragment,{children:[x.jsx(re,{variant:"secondary",onClick:()=>h("/account"),className:"whitespace-nowrap text-[#7973BB] border-[#7973BB]",icon:x.jsx(B,{className:"w-4 h-4"}),size:"sm",children:x.jsx("span",{className:"text-xs truncate max-w-[140px]",children:i.email})}),x.jsx(re,{variant:"secondary",onClick:async()=>{await $n.auth.signOut(),h("/")},className:"whitespace-nowrap text-[#7973BB] border-[#7973BB]",size:"sm",children:"Sign Out"})]}):x.jsx(re,{variant:"secondary",onClick:()=>s(!0),className:"whitespace-nowrap text-[#7973BB] border-[#7973BB]",children:"Login/Join"}),i&&!f&&x.jsx(re,{onClick:async()=>{i?a(!0):s(!0)},disabled:d,className:"bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-black font-medium whitespace-nowrap",icon:x.jsx(L,{className:"w-4 h-4"}),size:"sm",children:d?"Processing...":"Upgrade"})]})]}),x.jsx("nav",{className:"flex flex-wrap gap-3 w-full",children:x.jsxs("ul",{className:"flex flex-wrap justify-start gap-3 w-full",children:[x.jsx(fi,{to:"/",icon:x.jsx(te,{className:"w-4 h-4"}),label:"Guests"}),x.jsx(fi,{to:"/constraints",icon:x.jsx(A,{className:"w-4 h-4"}),label:"Constraints"}),x.jsx(fi,{to:"/tables",icon:x.jsx(X,{className:"w-4 h-4"}),label:"Tables"}),x.jsx(fi,{to:"/assignments",icon:x.jsx(q,{className:"w-4 h-4"}),label:"Assignments"}),x.jsx(fi,{to:"/seating",icon:x.jsx(q,{className:"w-4 h-4"}),label:"Seating"}),x.jsx(fi,{to:"/saved-settings",icon:x.jsx(U,{className:"w-4 h-4"}),label:"Saved Settings"})]})})]})}),t&&x.jsx(Dn,{onClose:()=>s(!1)}),r&&i&&x.jsx(ti,{onClose:()=>a(!1),userId:i.id,onSuccess:()=>{g()}})]})},fi=({to:e,icon:t,label:s})=>x.jsx("li",{className:"flex-none",children:x.jsxs(i,{to:e,className:({isActive:e})=>"flex items-center px-3 py-1 rounded-md transition-colors text-sm border border-[#7973BB] min-w-[110px] whitespace-nowrap\n           "+(e?"bg-[#7973BB] text-white":"bg-white text-[#7973BB] hover:bg-[#7973BB]/20"),children:[t,x.jsx("span",{className:"ml-1",children:s})]})}),yi=({title:e,children:t,className:s="",actions:r})=>x.jsxs("div",{className:`bg-white rounded-lg shadow-md overflow-hidden ${s}`,children:[e&&x.jsxs("div",{className:"px-4 py-3 bg-indigo-50 border-b border-indigo-100 flex justify-between items-center",children:[x.jsx("h2",{className:"text-lg font-medium text-[#7973BB]",children:e}),r&&x.jsx("div",{className:"flex space-x-2",children:r})]}),x.jsx("div",{className:"p-4",children:t})]}),bi=()=>{const{state:t,dispatch:s}=pi(),[r,a]=e.useState(""),[n,i]=e.useState(!1),[o,l]=e.useState(!1),[c,d]=e.useState(!1),[u,h]=e.useState(null),m=e.useRef(null),{user:p,subscription:g}=t,f=e=>{try{if(e.includes("CONFIGURATION DATA")){const t=e.substring(e.indexOf("CONFIGURATION DATA")),r=t.indexOf("{");if(-1!==r){const e=JSON.parse(t.substring(r));if(e.version&&e.guests)return e.tables&&(e.tables=e.tables.map((e=>e.hasOwnProperty("seats")?e:{...e,seats:8}))),e.hasOwnProperty("userSetTables")||(e.userSetTables=!0),s({type:"IMPORT_STATE",payload:e}),s({type:"SET_LOADED_SAVED_SETTING",payload:!0}),a(""),h(null),[]}}return e.split(/[,\n]/).map((e=>e.trim())).filter((e=>e)).map((e=>{const t=e.split("&").map((e=>e.trim())).filter((e=>e));return{name:e,count:t.length}})).filter((e=>e.name))}catch(t){return console.error("Error parsing input:",t),h("Invalid format. Please check your input and try again."),[]}},y=()=>{if(!r.trim())return;const e=f(r);if(e.length>0){const r=si(g),n=ri(r?{status:"active"}:null);if(t.guests.length+e.length>n&&!r)return void d(!0);s({type:"ADD_GUESTS",payload:e}),a(""),h(null)}},b=()=>{i(!0)},v=async()=>{if(p)try{await Xn(p.id)}catch(e){console.error("Error initiating checkout:",e),alert("Failed to start checkout process. Please try again.")}else l(!0)},w=si(g),j=!w&&t.guests.length>=70;return x.jsxs("div",{className:"space-y-6",children:[x.jsx("div",{className:"relative w-full pt-[37.5%] mb-4 rounded-lg overflow-hidden",children:x.jsx("iframe",{src:"https://player.vimeo.com/video/1085961997?badge=0&autopause=0&player_id=0&app_id=58479&autoplay=1&muted=1&loop=1&dnt=1",allow:"autoplay; fullscreen; picture-in-picture; clipboard-write; encrypted-media",title:"SeatyrBannerV1cVideo",className:"absolute top-0 left-0 w-full h-full"})}),x.jsxs("h1",{className:"text-2xl font-bold text-[#7973BB] flex items-center",children:[x.jsx(te,{className:"mr-2"}),"Guest Manager",w&&x.jsxs("span",{className:"flex items-center bg-yellow-500 text-black px-2 py-0.5 rounded-full text-sm font-medium ml-2",children:[x.jsx(L,{className:"w-4 h-4 mr-1"}),"Premium"]})]}),x.jsx(yi,{children:x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-gray-700 text-[17px]",children:"Enter guest names separated by commas or line breaks."}),x.jsx("p",{className:"text-gray-700 text-[17px]",children:"Connect couples and parties with an ampersand (&)."}),x.jsx("p",{className:"text-gray-700 text-[17px]",children:"You can also paste exported data here to restore a previous configuration."}),!w&&x.jsxs("p",{className:"text-sm text-[#7973BB] mt-2",children:["Free plan: ",ni(g,t.guests.length)]}),w&&x.jsx("p",{className:"text-sm text-green-600 mt-2",children:"Premium plan: Unlimited guests"})]}),x.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2",children:[x.jsx("textarea",{value:r,onChange:e=>a(e.target.value),placeholder:"e.g., Alice, Bob\r\nCarol & David\r\n Or paste exported data here to restore a previous configuration",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#7973BB] min-h-[100px]",onKeyDown:e=>"Enter"===e.key&&e.ctrlKey&&y()}),x.jsx(re,{onClick:y,icon:x.jsx(H,{className:"w-4 h-4"}),children:"Add"})]}),u&&x.jsx("div",{className:"text-red-600 text-sm mt-2",children:u}),x.jsxs("div",{className:"flex space-x-2",children:[x.jsx(re,{onClick:()=>{const e=f("Alice, Betty, Carl, David, Evan, Freida, Gayle, Hailey, Igor, James, Katy, Larry, Mike, Nathan, Ophelia, Patty, Quinn, Rob, Sally, Tommy, Uma, Victor, Wayne, Xavier, Yves, Zoe"),r=si(g),a=ri(r?{status:"active"}:null);e.length+t.guests.length>a&&!r?d(!0):s({type:"ADD_GUESTS",payload:e})},children:"Load Test Guest List"}),x.jsx("input",{type:"file",ref:m,onChange:e=>{var r;const a=null==(r=e.target.files)?void 0:r[0];if(!a)return;const n=new FileReader;n.onload=e=>{var r;const a=null==(r=e.target)?void 0:r.result;try{const e=a.split("\n");let r=null;const n=e.findIndex((e=>e.includes("CONFIGURATION DATA")));if(-1!==n){const t=e.slice(n+1).join("\n"),s=t.indexOf("{");-1!==s&&(r=JSON.parse(t.substring(s)))}if((null==r?void 0:r.version)&&(null==r?void 0:r.guests)){r.tables&&(r.tables=r.tables.map((e=>e.hasOwnProperty("seats")?e:{...e,seats:8}))),r.hasOwnProperty("userSetTables")||(r.userSetTables=!0);const e=r.guests.length,t=si(g);if(e>ri(t?{status:"active"}:null)&&!t)return void d(!0);t&&p&&ii(p.id,!0),s({type:"IMPORT_STATE",payload:r}),s({type:"SET_LOADED_SAVED_SETTING",payload:!0}),h(null)}else{const r=e.map((e=>e.trim())).filter((e=>e&&!e.startsWith("#"))).map((e=>{const t=e.split(",").map((e=>e.trim()));return{name:t[0],count:parseInt(t[1])||1}})).filter((e=>e.name));if(!(r.length>0))throw new Error("No valid guest data found");{const e=si(g),a=ri(e?{status:"active"}:null);if(r.length+t.guests.length>a&&!e)return void d(!0);s({type:"ADD_GUESTS",payload:r}),h(null)}}}catch(n){console.error("Error parsing file:",n),h("Invalid file format. Please ensure it's a CSV file with the correct format.")}m.current&&(m.current.value="")},n.readAsText(a)},accept:".csv,.txt",className:"hidden"}),x.jsx(re,{onClick:()=>{var e;return null==(e=m.current)?void 0:e.click()},icon:x.jsx(ee,{className:"w-4 h-4"}),children:"Upload Guests & Settings"})]})]})}),x.jsx(yi,{title:`Guest List (${t.guests.length}${w?"":"/80"})`,actions:x.jsx(re,{variant:"danger",onClick:b,icon:x.jsx(Q,{className:"w-4 h-4"}),size:"sm",children:"Clear Guest List"}),children:0===t.guests.length?x.jsxs("div",{className:"text-center",children:[x.jsx("p",{className:"text-gray-500 py-4",children:"No guests added yet. Add some guests to get started."}),!w&&x.jsxs(x.Fragment,{children:[x.jsx("p",{className:"text-gray-600",children:"Free to use for up to 80 guests."}),x.jsx("p",{className:"text-gray-600",children:"For more than 80 guests, upgrade to Seatyr Premium."}),x.jsx("div",{className:"mt-4",children:x.jsx(re,{onClick:v,className:"bg-[#7973BB] hover:bg-[#7973BB]/90 text-white",children:"Upgrade to Premium"})})]})]}):x.jsxs(x.Fragment,{children:[x.jsx("div",{className:"border-[3px] border-black rounded-lg overflow-hidden",children:t.guests.map(((e,r)=>{const a=(r+1)%3==1?"border-[1px]":"border-[2px]",n=(r+1)%3==1?"border-gray-400":(r+1)%3==2?"border-gray-600":"border-gray-800";return x.jsxs("div",{className:`grid grid-cols-[1fr,auto] gap-4 items-center ${a} ${n} p-4`,children:[x.jsxs("div",{className:"flex-1",children:[x.jsx("span",{className:"font-medium text-gray-800",children:e.name}),e.count>1&&x.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["(",e.count," people)"]})]}),x.jsxs("div",{className:"flex space-x-2",children:[x.jsx(re,{variant:"secondary",size:"sm",onClick:()=>(e=>{const r=t.guests[e],a=prompt("Enter new name:",r.name);if(a&&""!==a.trim()){const t=f(a)[0];t&&s({type:"RENAME_GUEST",payload:{index:e,name:t.name}})}})(r),icon:x.jsx(W,{className:"w-4 h-4"}),"aria-label":"Rename guest",className:"border-2 border-black rounded-md",children:"Rename"}),x.jsx(re,{variant:"danger",size:"sm",onClick:()=>(e=>{s({type:"REMOVE_GUEST",payload:e})})(r),icon:x.jsx(Q,{className:"w-4 h-4"}),"aria-label":"Remove guest",children:"Remove"})]})]},r)}))}),j&&x.jsxs("div",{className:"mt-4 p-4 bg-indigo-50 rounded-lg",children:[x.jsx("p",{className:"text-[#7973BB]",children:"You're approaching the 80 guest limit. Upgrade to Premium for unlimited guests!"}),x.jsx("div",{className:"mt-2",children:x.jsx(re,{onClick:v,className:"bg-[#7973BB] hover:bg-[#7973BB]/90 text-white",children:"Upgrade to Premium"})})]}),x.jsx("div",{className:"mt-4 flex justify-end",children:x.jsx(re,{variant:"danger",onClick:b,icon:x.jsx(Q,{className:"w-4 h-4"}),children:"Clear Guest List"})})]})}),x.jsxs("div",{className:"w-full mt-10 bg-[#fff4cd] border-2 border-[#a78bfa] rounded-xl p-6",children:[x.jsx("h2",{className:"text-lg font-bold text-[#a78bfa] mb-4",children:"Seatyr's Favorite Sites  May 2025:"}),x.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-2 text-sm text-gray-800 list-disc list-inside",children:[x.jsxs("ul",{children:[x.jsx("li",{children:x.jsx("a",{href:"https://example1.com",target:"_blank",rel:"noopener noreferrer",children:"https://example1.com"})}),x.jsx("li",{children:x.jsx("a",{href:"https://example2.com",target:"_blank",rel:"noopener noreferrer",children:"https://example2.com"})})]}),x.jsxs("ul",{children:[x.jsx("li",{children:x.jsx("a",{href:"https://example3.com",target:"_blank",rel:"noopener noreferrer",children:"https://example3.com"})}),x.jsx("li",{children:x.jsx("a",{href:"https://example4.com",target:"_blank",rel:"noopener noreferrer",children:"https://example4.com"})})]}),x.jsxs("ul",{children:[x.jsx("li",{children:x.jsx("a",{href:"https://example5.com",target:"_blank",rel:"noopener noreferrer",children:"https://example5.com"})}),x.jsx("li",{children:x.jsx("a",{href:"https://example6.com",target:"_blank",rel:"noopener noreferrer",children:"https://example6.com"})})]})]})]}),n&&x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:x.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full shadow-2xl",children:[x.jsx("h3",{className:"text-xl font-bold mb-4",children:"Confirm Clear Guest List"}),x.jsx("p",{className:"text-gray-700 mb-6",children:"This will remove all guests and reset all constraints, assignments, and seating plans. This action cannot be undone."}),x.jsxs("div",{className:"flex justify-end space-x-2",children:[x.jsx(re,{variant:"secondary",onClick:()=>i(!1),children:"Cancel"}),x.jsx(re,{variant:"danger",onClick:()=>{s({type:"CLEAR_GUESTS"}),i(!1),si(g)&&p&&ii(p.id,!0)},children:"Clear All Data"})]})]})}),c&&x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:x.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full shadow-2xl",children:[x.jsx("h3",{className:"text-xl font-bold mb-4",children:"Guest Limit Reached"}),x.jsx("p",{className:"text-gray-700 mb-6",children:"The guest list for regular users cannot go beyond the 80-seat maximum limit. Upgrade to premium to arrange more than 80 guests and get to save up to 50 seating plans."}),x.jsxs("div",{className:"flex justify-end space-x-2",children:[x.jsx(re,{variant:"secondary",onClick:()=>d(!1),children:"Cancel"}),x.jsx(re,{onClick:v,className:"bg-[#7973BB] hover:bg-[#7973BB]/90 text-white",children:"Upgrade to Premium"})]})]})}),o&&x.jsx(Dn,{onClose:()=>l(!1)})]})},xi=()=>{const{state:t,dispatch:s}=pi(),[r,a]=e.useState(null),[n,i]=e.useState(null),[o,l]=e.useState(null),c=e.useRef(null),[d,u]=e.useState(0),[h,m]=e.useState(1),[p,g]=e.useState("as-entered"),f=si(t.subscription);e.useEffect((()=>{u(0),f&&t.guests.length>120?m(Math.ceil(t.guests.length/10)):m(1)}),[t.guests.length,f]);const y=e=>{var s;return(null==(s=t.adjacents[e])?void 0:s.length)||0},b=e.useMemo((()=>{const e=f&&"as-entered"!==p?[...t.guests].sort(((e,s)=>{if("first-name"===p){const t=e.name.split(" ")[0].toLowerCase(),r=s.name.split(" ")[0].toLowerCase();return t.localeCompare(r)}if("last-name"===p){const t=e.name.includes(" ")?e.name.split(" ").slice(-1)[0].toLowerCase():e.name.toLowerCase(),r=s.name.includes(" ")?s.name.split(" ").slice(-1)[0].toLowerCase():s.name.toLowerCase();return t.localeCompare(r)}if("current-table"===p){if(0===t.seatingPlans.length)return 0;const r=t.seatingPlans[0];let a=0,n=0;return r.tables.forEach(((t,r)=>{t.seats.forEach((r=>{r.name===e.name&&(a=t.id),r.name===s.name&&(n=t.id)}))})),a-n}return 0})):[...t.guests],{constraints:s,adjacents:a}=t;if(0===e.length)return x.jsx("div",{className:"text-center py-8 text-gray-500",children:"No guests added yet. Add guests to create constraints."});const i=f&&e.length>120,o=i?Math.ceil(e.length/10):1;let l=e;if(i){const t=10*d,s=Math.min(t+10,e.length);l=e.slice(t,s)}const c=[x.jsx("th",{className:"bg-indigo-50 font-medium p-2 border border-[#7973BB] border-2 sticky top-0 left-0 z-30",children:"Guest Names"},"corner")];l.forEach(((e,t)=>{const s=y(e.name);let i=null;s>0&&(i=x.jsx("span",{className:"text-[#b3b508] font-bold ml-1",title:`Adjacent to: ${a[e.name].join(", ")}`,children:1===s?"*":"**"}));const o=r===e.name,l=(null==n?void 0:n.guest1)===e.name||(null==n?void 0:n.guest2)===e.name;c.push(x.jsx("th",{className:`\n            p-2 font-medium sticky top-0 z-20 min-w-[100px] cursor-pointer transition-colors duration-200\n            border border-[#7973BB] border-2\n            ${l?"bg-yellow-300":o?"bg-[#7973BB] text-white":"bg-indigo-50 text-[#7973BB] hover:bg-indigo-100"}\n          `,onDoubleClick:()=>S(e.name),onTouchStart:t=>w(t,e.name),onTouchEnd:()=>j(),"data-name":e.name,children:x.jsxs("div",{className:"truncate max-w-[140px]",children:[e.name,i]})},`header-${t}`))}));const h=[x.jsx("tr",{children:c},"header")];e.forEach(((e,i)=>{const o=y(e.name);let c=null;o>0&&(c=x.jsx("span",{className:"text-[#b3b508] font-bold ml-1",title:`Adjacent to: ${a[e.name].join(", ")}`,children:1===o?"*":"**"}));let d=null;if(f){const s=(e=>{if(!f)return null;if(t.assignments[e])return{text:t.assignments[e].split(",").map((e=>e.trim())).map((e=>{const s=parseInt(e);if(!isNaN(s)){const e=t.tables.find((e=>e.id===s));return(null==e?void 0:e.name)?`${e.name} (${s})`:`${s}`}return e})).join(", "),type:"assigned"};if(t.seatingPlans.length>0){const s=t.seatingPlans[t.currentPlanIndex];for(const r of s.tables)if(r.seats.find((t=>t.name===e))){const e=t.tables.find((e=>e.id===r.id));return{text:(null==e?void 0:e.name)?`${e.name} (${r.id})`:`${r.id}`,type:"plan"}}}return{text:"unassigned",type:"none"}})(e.name);d=x.jsx("div",{className:"text-xs mt-1",children:"assigned"===(null==s?void 0:s.type)?x.jsx("span",{className:"font-bold",children:s.text}):"plan"===(null==s?void 0:s.type)?x.jsx("span",{className:"italic",children:s.text}):x.jsx("span",{children:s.text})})}const u=r===e.name,m=(null==n?void 0:n.guest1)===e.name||(null==n?void 0:n.guest2)===e.name,p=[x.jsx("td",{className:`\n            p-2 font-medium sticky left-0 z-10 min-w-[140px] cursor-pointer transition-colors duration-200\n            border border-[#7973BB] border-2\n            ${m?"bg-yellow-300":u?"bg-[#7973BB] text-white":"bg-indigo-50 text-[#7973BB] hover:bg-indigo-100"}\n          `,onDoubleClick:()=>S(e.name),onTouchStart:t=>w(t,e.name),onTouchEnd:()=>j(),"data-name":e.name,children:x.jsxs("div",{children:[x.jsxs("div",{className:"truncate max-w-[140px]",children:[e.name,c]}),f&&d]})},`row-${i}`)];l.forEach(((t,r)=>{var n,o,l;if(e.name===t.name)p.push(x.jsx("td",{className:"p-2 border border-[#7973BB] border-2 bg-gray-800"},`cell-${i}-${r}`));else{const c=(null==(n=s[e.name])?void 0:n[t.name])||"",d=null==(o=a[e.name])?void 0:o.includes(t.name),u=null==(l=a[t.name])?void 0:l.includes(e.name);let h="",m="";"must"===c?(m="bg-[#22cf04]",h=d||u?x.jsxs("div",{className:"flex items-center justify-center space-x-1",children:[x.jsx("span",{className:"text-[#b3b508] font-bold",children:"*"}),x.jsx("span",{className:"text-black font-bold",children:"&"}),x.jsx("span",{className:"text-[#b3b508] font-bold",children:"*"})]}):x.jsx("span",{className:"text-black font-bold",children:"&"})):"cannot"===c&&(m="bg-[#e6130b]",h=x.jsx("span",{className:"text-black font-bold",children:"X"})),p.push(x.jsx("td",{className:`p-2 border border-[#7973BB] border-2 cursor-pointer transition-colors duration-200 text-center ${m}`,onClick:()=>_(e.name,t.name),"data-guest1":e.name,"data-guest2":t.name,children:h},`cell-${i}-${r}`))}})),h.push(x.jsx("tr",{children:p},`row-${i}`))}));const m=i&&x.jsx("div",{className:"flex flex-col md:flex-row items-center justify-between py-4 border-t mt-4",children:x.jsxs("div",{className:"flex items-center w-full justify-between",children:[x.jsxs("div",{className:"pl-[140px]",children:[" ",x.jsx(re,{size:"md",variant:"secondary",onClick:()=>u((e=>Math.max(0,e-1))),disabled:0===d,icon:x.jsx(C,{className:"w-4 h-4"}),className:"transform scale-[1.4] h-auto border-2 border-[#7973BB] rounded-md",children:"Previous"})]}),x.jsx("div",{className:"flex flex-wrap justify-center",children:(()=>{if(o<=9)return Array.from({length:o},((e,t)=>x.jsx("button",{onClick:()=>u(t),className:"px-4 py-2 mx-1 rounded-md border "+(d===t?"bg-[#7973BB] text-white font-bold border-[#7973BB]":"bg-white text-[#7973BB] border-[#7973BB] hover:bg-gray-100"),children:t+1},t)));const e=[];for(let t=0;t<3;t++)t<o&&e.push(x.jsx("button",{onClick:()=>u(t),className:"px-4 py-2 mx-1 rounded-md border "+(d===t?"bg-[#7973BB] text-white font-bold border-[#7973BB]":"bg-white text-[#7973BB] border-[#7973BB] hover:bg-gray-100"),children:t+1},t));d>2&&(e.push(x.jsx("span",{className:"mx-1",children:"..."},"ellipsis1")),d>2&&d<o-3&&e.push(x.jsx("button",{onClick:()=>u(d),className:"px-4 py-2 mx-1 rounded-md border bg-[#7973BB] text-white font-bold border-[#7973BB]",children:d+1},d))),d<o-3&&e.push(x.jsx("span",{className:"mx-1",children:"..."},"ellipsis2"));for(let t=Math.max(3,o-3);t<o;t++)e.push(x.jsx("button",{onClick:()=>u(t),className:"px-4 py-2 mx-1 rounded-md border "+(d===t?"bg-[#7973BB] text-white font-bold border-[#7973BB]":"bg-white text-[#7973BB] border-[#7973BB] hover:bg-gray-100"),children:t+1},t));return e})()}),x.jsxs("div",{className:"pr-[10px]",children:[" ",x.jsx(re,{size:"md",variant:"secondary",onClick:()=>u((e=>Math.min(o-1,e+1))),disabled:d>=o-1,icon:x.jsx(P,{className:"w-4 h-4 ml-1 mr-0"}),iconPosition:"right",className:"transform scale-[1.4] h-auto border-2 border-[#7973BB] rounded-md",children:"Next"})]})]})}),g=!f&&t.guests.length>100&&t.guests.length<=120;return x.jsxs("div",{className:"flex flex-col space-y-4",children:[g&&x.jsxs("div",{className:"bg-amber-50 border border-[#7973BB] rounded-md p-4 flex items-start",children:[x.jsx(k,{className:"text-amber-500 mr-2 flex-shrink-0 mt-1"}),x.jsxs("div",{className:"text-sm text-amber-800",children:[x.jsx("p",{className:"font-medium",children:"Performance Notice"}),x.jsxs("p",{children:["You have ",t.guests.length," guests, which may cause the constraint grid to be slow to render and interact with."]}),x.jsx("p",{className:"mt-1",children:"For better performance, consider working with smaller groups of guests."})]})]}),i&&x.jsxs("div",{className:"bg-amber-50 border border-[#7973BB] rounded-md p-4 flex items-start",children:[x.jsx(k,{className:"text-amber-500 mr-2 flex-shrink-0 mt-1"}),x.jsxs("div",{className:"text-sm text-amber-800",children:[x.jsx("p",{children:"Large Guest List Detected"}),x.jsx("p",{children:"To improve performance, the constraint grid shows 10 columns at a time."}),x.jsx("p",{children:"Scroll vertically and use the navigation buttons below to see all guests."})]})]}),x.jsx("div",{className:"overflow-auto max-h-[60vh] border border-[#7973BB] rounded-md relative",children:x.jsx("table",{className:"w-full border-collapse bg-white",children:x.jsx("tbody",{children:h})})}),i&&m]})}),[t.guests,t.constraints,t.adjacents,r,n,d,h,p,f,t.seatingPlans,t.assignments,t.tables,t.currentPlanIndex]);let v;const w=(e,t)=>{e.preventDefault(),v=setTimeout((()=>{S(t)}),500)},j=()=>{v&&clearTimeout(v)},_=(e,r)=>{var n,c;a(null),i(null),o&&(clearTimeout(o),l(null));const d=(null==(n=t.constraints[e])?void 0:n[r])||"";let u;""===d?u="must":"must"===d?((null==(c=t.adjacents[e])?void 0:c.includes(r))&&s({type:"REMOVE_ADJACENT",payload:{guest1:e,guest2:r}}),u="cannot"):u="",s({type:"SET_CONSTRAINT",payload:{guest1:e,guest2:r,value:u}})},S=e=>{if(null===r)a(e);else if(r!==e){s({type:"SET_ADJACENT",payload:{guest1:r,guest2:e}}),i({guest1:r,guest2:e}),a(null);const t=setTimeout((()=>{i(null)}),3e3);o&&clearTimeout(o),l(t)}else a(null)};return x.jsxs("div",{className:"space-y-6",children:[x.jsxs("h1",{className:"text-2xl font-bold text-[#7973BB] flex items-center",children:[x.jsx(A,{className:"mr-2"}),"Constraint Manager",f&&x.jsxs("span",{className:"flex items-center bg-yellow-500 text-black px-2 py-0.5 rounded-full text-sm font-medium ml-2",children:[x.jsx(L,{className:"w-4 h-4 mr-1"}),"Premium"]})]}),x.jsx(yi,{children:x.jsx("div",{className:"space-y-4",children:x.jsxs("div",{className:"flex items-start space-x-4",children:[x.jsx(z,{className:"text-[#7973BB] mt-1 flex-shrink-0"}),x.jsxs("div",{children:[x.jsx("h3",{className:"font-medium text-[#7973BB]",children:"How to use constraints:"}),x.jsxs("ul",{className:"list-disc pl-5 space-y-1 text-gray-600 text-[17px] mt-2",children:[x.jsxs("li",{children:["Click a cell to cycle between constraints:",x.jsxs("div",{className:"mt-1 flex space-x-4",children:[x.jsxs("span",{className:"flex items-center",children:[x.jsx("span",{className:"inline-block w-3 h-3 bg-[#22cf04] border border-[#7973BB] mr-1"}),"Must sit at the same table"]}),x.jsxs("span",{className:"flex items-center",children:[x.jsx("span",{className:"inline-block w-3 h-3 bg-[#e6130b] border border-[#7973BB] mr-1"}),"Cannot sit at the same table"]}),x.jsxs("span",{className:"flex items-center",children:[x.jsx("span",{className:"inline-block w-3 h-3 bg-white border border-[#7973BB] mr-1"}),"No constraint"]})]})]}),x.jsxs("li",{children:['To set "Adjacent Seating" (guests sit right next to each other):',x.jsxs("ol",{className:"list-decimal pl-5 mt-1",children:[x.jsx("li",{children:"Long-press (mobile) or double-click (desktop) a guest name to select it"}),x.jsx("li",{children:"And then Long-press or double-click another guest name to create the adjacent pairing"})]})]}),x.jsxs("li",{children:["Guests with adjacent constraints are marked with ",x.jsx("span",{className:"text-[#b3b508] font-bold",children:"*"})]})]})]})]})})}),x.jsxs(yi,{title:"Constraint Grid",children:[f&&x.jsxs("div",{className:"flex justify-end items-center space-x-2 mb-4",children:[x.jsxs("span",{className:"text-[#7973BB] font-medium flex items-center",children:[x.jsx(N,{className:"w-4 h-4 mr-1"}),"Sort by:"]}),x.jsxs("div",{className:"flex space-x-2",children:[x.jsx(re,{variant:"as-entered"===p?"primary":"secondary",size:"sm",onClick:()=>g("as-entered"),className:"as-entered"===p?"":"bg-white text-[#7973BB]",children:"As Entered"}),x.jsx(re,{variant:"first-name"===p?"primary":"secondary",size:"sm",onClick:()=>g("first-name"),className:"first-name"===p?"":"bg-white text-[#7973BB]",children:"First Name"}),x.jsx(re,{variant:"last-name"===p?"primary":"secondary",size:"sm",onClick:()=>g("last-name"),className:"last-name"===p?"":"bg-white text-[#7973BB]",children:"Last Name"}),x.jsx(re,{variant:"current-table"===p?"primary":"secondary",size:"sm",onClick:()=>g("current-table"),disabled:0===t.seatingPlans.length,className:"current-table"===p?"":"bg-white text-[#7973BB]",children:"Current Table"})]})]}),x.jsx("div",{ref:c,children:0===t.guests.length?x.jsx("p",{className:"text-gray-500 text-center py-4",children:"No guests added yet. Add guests to create constraints."}):b})]})]})},vi=()=>{const{state:t,dispatch:s}=pi(),[r,a]=e.useState(null),[n,i]=e.useState(""),[o,l]=e.useState(null),c=t.tables.reduce(((e,t)=>e+t.seats),0),d=si(t.subscription);e.useEffect((()=>{(async()=>{if(t.user&&d&&t.userSetTables){t.tables.some((e=>void 0!==e.name))&&await(async(e,t,s)=>{if(s&&0!==s.length)try{if(localStorage.setItem("seatyr_recent_tables",JSON.stringify(s)),t&&e){const{data:t,error:r}=await $n.from("recent_session_settings").select("id").eq("user_id",e).limit(1);if(r)return void console.error("Error fetching recent session settings:",r);const a={tables:s,timestamp:(new Date).toISOString()};if(t&&t.length>0){const{error:e}=await $n.from("recent_session_settings").update({data:a,updated_at:(new Date).toISOString()}).eq("id",t[0].id);e&&console.error("Error updating recent session settings:",e)}else{const{error:t}=await $n.from("recent_session_settings").insert({user_id:e,data:a});t&&console.error("Error inserting recent session settings:",t)}}}catch(r){console.error("Error saving recent session settings:",r)}})(t.user.id,d,t.tables)}})()}),[t.tables,t.user,d,t.userSetTables]);const u=e=>{i(e.target.value),l(null)},h=()=>{if(null===r)return;const e=n.trim();if(!e)return void a(null);t.tables.some((t=>{var s;return t.id!==r&&((null==(s=t.name)?void 0:s.toLowerCase())===e.toLowerCase()||!t.name&&`Table ${t.id}`.toLowerCase()===e.toLowerCase())}))?l("That name is already in use. Please choose another."):(s({type:"UPDATE_TABLE_NAME",payload:{id:r,name:e===`Table ${r}`?void 0:e}}),a(null))},m=e=>{"Enter"===e.key?h():"Escape"===e.key&&(a(null),l(null))},p=e=>e.name||`Table ${e.id}`;return x.jsxs("div",{className:"space-y-6",children:[x.jsxs("h1",{className:"text-2xl font-bold text-[#7973BB] flex items-center",children:[x.jsx(X,{className:"mr-2"}),"Table Manager",d&&x.jsxs("span",{className:"flex items-center bg-yellow-500 text-black px-2 py-0.5 rounded-full text-sm font-medium ml-2",children:[x.jsx(L,{className:"w-4 h-4 mr-1"}),"Premium"]})]}),x.jsx(yi,{children:x.jsxs("div",{className:"space-y-4",children:[x.jsx("p",{className:"text-gray-700",children:"Add, remove, and manage tables for your seating arrangement. Each table can have between 1 and 20 seats."}),d&&x.jsx("div",{className:"bg-green-50 border border-green-300 rounded-md p-3",children:x.jsxs("p",{className:"text-sm text-green-700 flex items-center",children:[x.jsx(L,{className:"w-4 h-4 mr-1 text-yellow-500"}),"Premium feature: Double-click to rename any table."]})}),!t.userSetTables&&x.jsx("div",{className:"bg-blue-50 border border-[#7973BB] rounded-md p-3",children:x.jsx("p",{className:"text-sm text-[#7973BB]",children:"Tables are currently in auto-adjust mode. The number of tables will automatically update based on your guest list. Any manual changes will switch to fixed table settings."})}),x.jsx(re,{onClick:()=>{t.tables.length>=100?alert("Maximum number of tables (100) reached."):(s({type:"SET_USER_SET_TABLES",payload:!0}),s({type:"ADD_TABLE"}))},icon:x.jsx(H,{className:"w-4 h-4"}),children:"Add New Table"})]})}),x.jsxs(yi,{children:[x.jsxs("div",{className:"flex justify-between items-center mb-4",children:[x.jsxs("h2",{className:"text-lg font-semibold text-[#7973BB]",children:["Tables (",t.tables.length,")"]}),x.jsxs("div",{className:"text-[#7973BB]",children:["Total Seats: ",c]})]}),0===t.tables.length?x.jsx("p",{className:"text-gray-500 text-center py-4",children:"No tables added yet. Add a table to get started."}):x.jsx("div",{className:"grid gap-5 grid-cols-1 sm:grid-cols-2 md:grid-cols-3",children:t.tables.map((e=>x.jsxs("div",{className:"bg-[#f9f9f9] rounded-lg p-4 border border-solid border-[#7973BB] border-[1px] shadow-sm mb-5",children:[x.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r===e.id?x.jsxs("div",{className:"w-full",children:[x.jsx("input",{type:"text",value:n,onChange:u,onBlur:h,onKeyDown:m,className:"px-3 py-1 border rounded-md focus:outline-none focus:ring-2 focus:ring-[#7973BB] w-full "+(o?"border-red-300 bg-red-50":"border-[#7973BB]"),autoFocus:!0}),o&&x.jsx("p",{className:"text-red-600 text-xs mt-1",children:o})]}):x.jsxs("div",{className:"font-medium text-[#7973BB] flex items-center "+(d?"cursor-pointer":""),onDoubleClick:()=>{return t=e.id,s=e.name,void(d&&(a(t),i(s||`Table ${t}`),l(null)));var t,s},title:d?"Double-click to rename (Premium feature)":"",children:[x.jsx("span",{children:p(e)}),d&&x.jsx(W,{className:"w-3 h-3 ml-1 text-gray-400"}),x.jsxs("span",{className:"text-xs bg-gray-200 text-gray-600 px-1.5 py-0.5 rounded ml-2",children:["#",e.id]})]}),x.jsx(re,{variant:"danger",size:"sm",onClick:()=>{return t=e.id,void(window.confirm("Are you sure you want to remove this table? This will also update any assignments that reference this table.")&&(s({type:"SET_USER_SET_TABLES",payload:!0}),s({type:"REMOVE_TABLE",payload:t})));var t},icon:x.jsx(Q,{className:"w-4 h-4"}),"aria-label":"Remove table",children:"Remove"})]}),x.jsxs("div",{className:"flex items-center space-x-3",children:[x.jsx("label",{htmlFor:`table-${e.id}-seats`,className:"text-[#7973BB]",children:"Seats:"}),x.jsx("input",{id:`table-${e.id}-seats`,type:"number",min:"1",max:"20",value:e.seats,onChange:t=>((e,t)=>{const r=parseInt(t);!isNaN(r)&&r>=1&&r<=20&&(s({type:"SET_USER_SET_TABLES",payload:!0}),s({type:"UPDATE_TABLE_SEATS",payload:{id:e,seats:r}}))})(e.id,t.target.value),className:"px-3 py-1 border border-[#7973BB] rounded-md w-16 focus:outline-none focus:ring-2 focus:ring-[#7973BB]"})]}),x.jsx("div",{className:"mt-3 flex flex-wrap",children:Array.from({length:e.seats}).map(((e,t)=>x.jsx("div",{className:"w-5 h-5 bg-indigo-200 border border-[#7973BB] rounded-sm m-0.5",title:`Seat ${t+1}`},t)))})]},e.id)))})]})]})},wi=()=>{const{state:e,dispatch:t}=pi(),s=si(e.subscription);return x.jsxs("div",{className:"space-y-6",children:[x.jsxs("h1",{className:"text-2xl font-bold text-[#7973BB] flex items-center",children:[x.jsx(A,{className:"mr-2"}),"Assignment Manager",s&&x.jsxs("span",{className:"flex items-center bg-yellow-500 text-black px-2 py-0.5 rounded-full text-sm font-medium ml-2",children:[x.jsx(L,{className:"w-4 h-4 mr-1"}),"Premium"]})]}),x.jsx(yi,{children:x.jsxs("div",{className:"space-y-4",children:[x.jsx("p",{className:"text-[#7973BB]",children:"Specify which tables each guest can be assigned to. Enter table numbers separated by commas, or leave blank for automatic assignment."}),s&&x.jsxs("p",{className:"text-sm text-[#7973BB] bg-green-50 p-3 rounded-md border border-green-300",children:[x.jsx(L,{className:"inline-block w-4 h-4 mr-1 text-yellow-500"}),x.jsx("strong",{children:"Premium feature:"})," You can enter either table numbers or the exact table names you've created."]}),x.jsxs("p",{className:"text-sm text-[#7973BB] bg-indigo-50 p-3 rounded-md",children:[x.jsx("strong",{children:"Tip:"}),' You can assign a guest to multiple tables by entering comma-separated numbers (e.g., "1,3,5"). This means the seating algorithm will place them at one of these tables.']})]})}),x.jsx(yi,{title:"Guest Assignments",children:0===e.guests.length?x.jsx("p",{className:"text-gray-500 text-center py-4",children:"No guests added yet. Add guests to create assignments."}):x.jsx("div",{className:"space-y-6",children:e.guests.map(((r,a)=>x.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 mb-6",children:[x.jsxs("div",{className:"min-w-[150px] font-medium text-[#7973BB]",children:[r.name,r.count>1&&x.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["(",r.count," people)"]})]}),x.jsxs("div",{className:"w-full sm:w-auto",children:[x.jsxs("label",{htmlFor:`assignment-${a}`,className:"sr-only",children:["Table assignment for ",r.name]}),x.jsxs("div",{className:"relative",children:[x.jsx("input",{id:`assignment-${a}`,type:"text",value:e.assignments[r.name]||"",onChange:a=>{return n=r.name,i=a.target.value,void(s?(i.split(",").map((t=>{const s=t.trim();if(!s)return"";if(!isNaN(Number(s)))return s;const r=e.tables.find((e=>e.name&&e.name.toLowerCase()===s.toLowerCase()));return r?r.id.toString():s})).filter(Boolean).join(", "),t({type:"UPDATE_ASSIGNMENT",payload:{name:n,tables:i}})):t({type:"UPDATE_ASSIGNMENT",payload:{name:n,tables:i}}));var n,i},placeholder:s?"Enter table numbers or table names...":"Enter table numbers...",className:"w-full sm:w-[280px] px-3 py-2 border border-[#7973BB] rounded-md focus:outline-none focus:ring-2 focus:ring-[#7973BB]"}),x.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none"})]}),e.tables.length>0&&x.jsxs("div",{className:"mt-1 text-xs text-[#7973BB]",children:["Available tables: ",s&&e.tables.some((e=>e.name))?e.tables.map((e=>e.name?`${e.id} (${e.name})`:e.id)).join(", "):e.tables.map((e=>e.id)).join(", ")]})]})]},a)))})})]})};function ji(e,t,s){var r;for(const a of t)if("cannot"===(null==(r=s[e.name])?void 0:r[a.name]))return!1;return!0}function _i(e){return e.reduce(((e,t)=>e+t.count),0)}function ki(e,t,s,r,a){const n=t.map((e=>({id:e.id,seats:[],capacity:e.seats}))),i=[...e],o=function(e,t){const s=[],r=new Set;return e.forEach((e=>{const a=e.name;if(!r.has(a)){const e=[a],n=[a];for(r.add(a);n.length>0;){const s=n.shift();Object.keys(t[s]||{}).forEach((a=>{"must"!==t[s][a]||r.has(a)||(e.push(a),n.push(a),r.add(a))}))}e.length>1&&s.push(e)}})),s}(e,s);for(const l of o){const t=l.map((t=>e.find((e=>e.name===t)))).filter((e=>void 0!==e&&i.some((t=>t.name===e.name))));if(t.length>1){const e=t.reduce(((e,t)=>e+t.count),0);let s=n;t.some((e=>a[e.name]))&&(s=n.filter((e=>t.every((t=>{if(!a[t.name])return!0;return a[t.name].split(",").map(Number).includes(e.id)})))));const r=s.find((t=>_i(t.seats)+e<=t.capacity));if(!r)return null;for(const a of t){r.seats.push(a);const e=i.findIndex((e=>e.name===a.name));-1!==e&&i.splice(e,1)}}}for(const l of Object.keys(a)){const e=i.find((e=>e.name===l));if(!e)continue;const t=a[l].split(",").map((e=>parseInt(e.trim()))).filter((e=>!isNaN(e)));let r=!1;for(const a of t){const t=n.find((e=>e.id===a));if(t){if(_i(t.seats)+e.count<=t.capacity&&ji(e,t.seats,s)){t.seats.push(e);const s=i.findIndex((e=>e.name===l));-1!==s&&i.splice(s,1),r=!0;break}}}if(!r&&t.length>0)return null}return Si(n,i,0,s)?(function(e,t){for(const s of e){if(s.seats.length<=1)continue;const e={};for(const o of s.seats)t[o.name]&&(e[o.name]=t[o.name].filter((e=>s.seats.some((t=>t.name===e)))));if(0===Object.keys(e).length)continue;const r=[],a=new Set,n=t=>{if(a.has(t.name))return;a.add(t.name),r.push(t);const i=e[t.name]||[];for(const e of i)if(!a.has(e)){const t=s.seats.find((t=>t.name===e));t&&n(t)}},i=s.seats.filter((t=>{var s;return(null==(s=e[t.name])?void 0:s.length)>0}));i.length>0&&n(i[0]);for(const t of s.seats)a.has(t.name)||n(t);r.length===s.seats.length&&(s.seats=r)}}(n,r),{id:Math.floor(1e6*Math.random()),tables:n}):null}function Si(e,t,s,r){if(s>=t.length)return!0;const a=t[s],n=function(e){const t=[...e];for(let s=t.length-1;s>0;s--){const e=Math.floor(Math.random()*(s+1));[t[s],t[e]]=[t[e],t[s]]}return t}(e);for(const i of n){if(_i(i.seats)+a.count<=i.capacity&&ji(a,i.seats,r)){if(i.seats.push(a),Si(e,t,s+1,r))return!0;i.seats.pop()}}return!1}async function Ni(e,t,s,r,a,n=!1){const i=function(e,t,s,r){const a=[];Object.keys(r).forEach((e=>{r[e].split(",").map((e=>parseInt(e.trim()))).filter((e=>!isNaN(e))).forEach((s=>{t.some((e=>e.id===s))||a.push({message:`Invalid table assignment for ${e}: Table ${s} does not exist.`,type:"error"})}))})),Object.keys(s).forEach((e=>{Object.keys(s[e]||{}).forEach((t=>{if("must"===s[e][t]&&r[e]&&r[t]){const s=r[e].split(",").map((e=>parseInt(e.trim()))).filter((e=>!isNaN(e))),n=r[t].split(",").map((e=>parseInt(e.trim()))).filter((e=>!isNaN(e)));s.length>0&&n.length>0&&!s.some((e=>n.includes(e)))&&a.push({message:`Constraint conflict: ${e} and ${t} must be at the same table but are assigned to non-overlapping tables.`,type:"error"})}}))}));const n=e.reduce(((e,t)=>e+t.count),0),i=t.reduce(((e,t)=>e+t.seats),0);return n>i&&a.push({message:`Not enough seats (${i}) for all guests (${n}). Add more tables or seats.`,type:"error"}),a}(e,t,s,a);if(i.some((e=>"error"===e.type)))return{plans:[],errors:i};const o=[],l=n?30:10,c=n?3e3:1e3;let d=0;await new Promise((e=>setTimeout(e,0)));const u=Date.now(),h=n?3e4:1e4;for(;o.length<l&&d<c&&Date.now()-u<h;){d++,d%100==0&&await new Promise((e=>setTimeout(e,0)));const n=ki(e,t,s,r,a);n&&!o.some((e=>{return s=n,(t=e).tables.length===s.tables.length&&t.tables.every(((e,t)=>{const r=s.tables[t];return e.seats.length===r.seats.length&&e.seats.map((e=>e.name)).sort().join(",")===r.seats.map((e=>e.name)).sort().join(",")}));var t,s}))&&o.push(n)}0===o.length&&d>=c?i.push({message:"Unable to generate a valid seating plan. Try relaxing some constraints or adding more tables.",type:"error"}):o.length<l&&d>=c&&i.push({message:`Only able to generate ${o.length} different seating plans. Try relaxing some constraints for more options.`,type:"warning"});let m=!1;return o.forEach((e=>{e.tables.forEach((e=>{_i(e.seats)>e.capacity&&(m=!0)}))})),m&&i.push({message:"One or more tables were overfilled during plan generation.",type:"error"}),{plans:o,errors:i}}const Ei=()=>{const{state:t,dispatch:s}=pi(),[r,a]=e.useState(!1),[i,o]=e.useState(!1),[l,c]=e.useState(!1),[d,u]=e.useState(""),[h,m]=e.useState(!1),[p,g]=e.useState(!1),[f,y]=e.useState([]),[b,v]=e.useState(!1),[w,j]=e.useState(!1);n();const{user:_,subscription:S}=t,N=si(S),C=e=>{const r=t.currentPlanIndex+e;r>=0&&r<t.seatingPlans.length&&s({type:"SET_CURRENT_PLAN_INDEX",payload:r})},P=()=>{if(0===t.seatingPlans.length)return"";const e=[];e.push("SEATING PLANS\n"+"=".repeat(80)+"\n"),e.push(t.seatingPlans.map(((e,s)=>`Plan #${s+1}\n`+e.tables.map((e=>{var s;return`${(null==(s=t.tables.find((t=>t.id===e.id)))?void 0:s.name)||`Table ${e.id}`} (${e.capacity} seats)\t${e.seats.map((e=>{var s;return e.name+(e.count>1?` (${e.count})`:"")+((null==(s=t.adjacents[e.name])?void 0:s.length)>0?" *":"")})).join("\t")}`})).join("\n"))).join("\n\n")),e.push("\nGUEST LIST\n"+"=".repeat(80)),e.push("Name\tGroup Size"),e.push(t.guests.map((e=>`${e.name}\t${e.count}`)).join("\n")),e.push("\nTABLES\n"+"=".repeat(80)),e.push("Table ID\tName\tSeats"),e.push(t.tables.map((e=>`${e.id}\t${e.name||`Table ${e.id}`}\t${e.seats}`)).join("\n")),e.push("\nCONSTRAINTS\n"+"=".repeat(80)),e.push("Guest 1\tGuest 2\tConstraint Type");const s=[];Object.entries(t.constraints).forEach((([e,t])=>{Object.entries(t).forEach((([t,r])=>{r&&e<t&&s.push(`${e}\t${t}\t${r}`)}))})),e.push(s.join("\n")),e.push("\nADJACENT SEATING\n"+"=".repeat(80)),e.push("Guest 1\tGuest 2");const r=[];Object.entries(t.adjacents).forEach((([e,t])=>{t.forEach((t=>{e<t&&r.push(`${e}\t${t}`)}))})),e.push(r.join("\n")),e.push("\nTABLE ASSIGNMENTS\n"+"=".repeat(80)),e.push("Guest\tAssigned Tables"),e.push(Object.entries(t.assignments).map((([e,t])=>`${e}\t${t}`)).join("\n"));const a={version:"1.0",guests:t.guests,tables:t.tables.map((e=>({id:e.id,seats:e.seats,name:e.name}))),constraints:t.constraints,adjacents:t.adjacents,assignments:t.assignments,seatingPlans:t.seatingPlans,currentPlanIndex:t.currentPlanIndex,userSetTables:t.userSetTables};return e.push("\nCONFIGURATION DATA\n"+"=".repeat(80)),e.push(JSON.stringify(a,null,2)),{csv:e.join("\n"),fullText:e.join("\n"),configData:JSON.stringify(a,null,2)}};return x.jsxs("div",{className:"space-y-6",children:[x.jsxs("h1",{className:"text-2xl font-bold text-[#7973BB] flex items-center",children:[x.jsx(q,{className:"mr-2"}),"Seating Plan Viewer",N&&x.jsxs("span",{className:"flex items-center bg-yellow-500 text-black px-2 py-0.5 rounded-full text-sm font-medium ml-2",children:[x.jsx(L,{className:"w-4 h-4 mr-1"}),"Premium"]})]}),x.jsx(yi,{children:x.jsxs("div",{className:"space-y-4",children:[x.jsxs("p",{className:"text-gray-700",children:["Generate and review seating plans based on your guests, tables, and constraints.",N&&x.jsx("span",{className:"ml-1 text-[#7973BB]",children:"As a Premium user, you'll get up to 30 different seating plan options."})]}),x.jsxs("div",{className:"flex flex-wrap gap-2",children:[x.jsx(re,{onClick:async()=>{a(!0),y([]);try{const{plans:e,errors:r}=await Ni(t.guests,t.tables,t.constraints,t.adjacents,t.assignments,N);r.length>0&&y(r),e.length>0&&s({type:"SET_SEATING_PLANS",payload:e})}catch(e){console.error("Error generating seating plans:",e),y([{message:"An unexpected error occurred while generating seating plans.",type:"error"}])}finally{a(!1)}},disabled:r||0===t.guests.length||0===t.tables.length,icon:r?x.jsx(J,{className:"w-4 h-4 animate-spin"}):void 0,children:r?"Generating...":"Generate Seating Plan"}),x.jsx(re,{variant:"secondary",onClick:()=>o(!0),disabled:0===t.seatingPlans.length,icon:x.jsx(D,{className:"w-4 h-4"}),children:"Export Plans"}),_&&x.jsx(re,{variant:"secondary",onClick:()=>c(!0),disabled:0===t.seatingPlans.length,icon:x.jsx(Y,{className:"w-4 h-4"}),className:"bg-green-100 hover:bg-green-200 border border-green-300",children:"Save Plan"})]}),f.length>0&&x.jsxs("div",{className:"mt-4 bg-red-50 border border-red-200 rounded-md p-3",children:[x.jsxs("h3",{className:"flex items-center text-red-800 font-medium mb-2",children:[x.jsx(k,{className:"w-4 h-4 mr-1"}),"Validation Errors"]}),x.jsx("ul",{className:"list-disc pl-5 text-red-700 text-sm space-y-1",children:f.map(((e,t)=>x.jsx("li",{children:e.message},t)))})]})]})}),x.jsxs(yi,{title:"Seating Plan",children:[(()=>{if(0===t.seatingPlans.length)return x.jsx("div",{className:"text-center py-8 text-gray-500",children:'No seating plans generated yet. Click "Generate Seating Plan" to create plans.'});const e=t.seatingPlans[t.currentPlanIndex],s=Math.max(...e.tables.map((e=>e.capacity))),r=e=>{const s=t.tables.find((t=>t.id===e));return(null==s?void 0:s.name)||`Table ${e}`};return x.jsxs("div",{children:[x.jsxs("div",{className:"flex justify-between items-center mb-4",children:[x.jsxs("h3",{className:"text-lg font-medium text-[#7973BB]",children:["Plan #",t.currentPlanIndex+1," of ",t.seatingPlans.length]}),x.jsxs("div",{className:"flex space-x-2",children:[x.jsx(re,{variant:"secondary",onClick:()=>C(-1),disabled:0===t.currentPlanIndex,icon:x.jsx(E,{className:"w-4 h-4"}),size:"sm",children:"Previous Plan"}),x.jsx(re,{variant:"secondary",onClick:()=>C(1),disabled:t.currentPlanIndex===t.seatingPlans.length-1,icon:x.jsx(T,{className:"w-4 h-4 ml-1 mr-0"}),iconPosition:"right",size:"sm",children:"Next Plan"})]})]}),x.jsx("div",{className:"overflow-x-auto",children:x.jsxs("table",{className:"min-w-full border-collapse",children:[x.jsx("thead",{children:x.jsx("tr",{children:e.tables.map((e=>{const t=e.seats.reduce(((e,t)=>e+t.count),0);return x.jsxs("th",{className:"bg-indigo-100 text-[#7973BB] font-medium p-2 border border-indigo-200",children:[r(e.id),x.jsxs("span",{className:"text-xs block text-gray-600",children:["(",t,"/",e.capacity," seats)"]})]},`table-${e.id}`)}))})}),x.jsx("tbody",{children:Array.from({length:s}).map(((s,r)=>x.jsx("tr",{children:e.tables.map((e=>{const s=e.seats[r],a=s?(e=>{const s=t.adjacents[e]||[],r=[];return Object.entries(t.adjacents).forEach((([t,s])=>{s.includes(e)&&t!==e&&r.push(t)})),[...new Set([...s,...r])]})(s.name):[],n=a.length,i=e.seats.map((e=>e.name)),o=a.filter((e=>i.includes(e))),l=r>=e.seats.length&&r<e.capacity;return x.jsxs("td",{className:`p-2 border ${s?"border-indigo-200":"border-gray-200"} ${t.assignments[null==s?void 0:s.name]?"bg-amber-50":l?"bg-gray-50":"bg-white"}`,children:[s&&x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"font-medium",children:[s.name,s.count>1&&x.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",s.count,")"]}),n>0&&x.jsx("span",{className:"text-[#b3b508] font-bold ml-1",title:`Adjacent to: ${a.join(", ")}`,children:1===n?"*":"**"})]}),o.length>0&&x.jsxs("div",{className:"text-xs text-amber-600 mt-1",children:["Adjacent to: ",o.join(", ")]})]}),l&&x.jsx("div",{className:"text-xs text-gray-400 text-center",children:"Empty"})]},`cell-${e.id}-${r}`)}))},`row-${r}`)))})]})})]})})(),t.seatingPlans.length>0&&x.jsxs("div",{className:"mt-6 flex justify-center space-x-4",children:[x.jsx(re,{variant:"secondary",onClick:()=>C(-1),disabled:0===t.currentPlanIndex,icon:x.jsx(E,{className:"w-4 h-4"}),children:"Previous Plan"}),x.jsx(re,{variant:"secondary",onClick:()=>C(1),disabled:t.currentPlanIndex===t.seatingPlans.length-1,icon:x.jsx(T,{className:"w-4 h-4 ml-1 mr-0"}),iconPosition:"right",children:"Next Plan"})]})]}),i&&x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:x.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full shadow-2xl",children:[x.jsx("h3",{className:"text-xl font-bold mb-4",children:"Export Options"}),h?x.jsx("div",{className:"text-green-600 text-center py-4",children:"Export successful!"}):x.jsxs(x.Fragment,{children:[x.jsx("p",{className:"text-gray-700 mb-6",children:"Choose how you'd like to export your seating plans:"}),x.jsxs("div",{className:"space-y-4",children:[x.jsx(re,{variant:"primary",onClick:async()=>{const{fullText:e}=P();try{await navigator.clipboard.writeText(e),m(!0),setTimeout((()=>{o(!1),m(!1)}),2e3)}catch(t){console.error("Failed to copy to clipboard:",t),alert("Unable to copy to clipboard. Please try again.")}},className:"w-full",children:"Copy to Clipboard"}),x.jsx(re,{variant:"primary",onClick:()=>{if(0===t.seatingPlans.length)return;const{csv:e}=P(),s=new Blob([e],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");r.href=URL.createObjectURL(s),r.download="seating_plans.csv",document.body.appendChild(r),r.click(),document.body.removeChild(r),m(!0),setTimeout((()=>{o(!1),m(!1)}),2e3)},className:"w-full",children:"Download as Spreadsheet (CSV)"})]}),x.jsx("div",{className:"mt-6 flex justify-end",children:x.jsx(re,{variant:"secondary",onClick:()=>o(!1),className:"border-2 border-gray-300 rounded-md",children:"Cancel"})})]})]})}),l&&x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:x.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full shadow-2xl",children:[x.jsx("h3",{className:"text-xl font-bold mb-4",children:"Save Seating Plan"}),p?x.jsx("div",{className:"text-green-600 text-center py-4",children:"Plan saved successfully!"}):x.jsxs(x.Fragment,{children:[x.jsxs("p",{className:"text-gray-700 mb-4",children:["Save your current seating plan to access it later.",!N&&x.jsx("span",{className:"block mt-2 text-sm text-[#7973BB]",children:"Free users can save up to 5 settings."})]}),x.jsxs("div",{className:"mb-4",children:[x.jsx("label",{htmlFor:"planName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Plan Name"}),x.jsx("input",{id:"planName",type:"text",value:d,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#7973BB]",placeholder:"Enter a name for this plan"})]}),x.jsxs("div",{className:"flex justify-end space-x-2",children:[x.jsx(re,{variant:"secondary",onClick:()=>c(!1),children:"Cancel"}),x.jsx(re,{onClick:async()=>{if(_)if(d.trim()){j(!0);try{const e=si(S),{data:s,error:r}=await $n.from("saved_settings").select("id",{count:"exact"});if(r)throw r;const a=ai(e?{status:"active"}:null);if(s.length>=a&&!e)throw new Error(`Free users can only save up to ${a} settings. Upgrade to Premium for more.`);const n={version:"1.0",guests:t.guests,tables:t.tables.map((e=>({id:e.id,seats:e.seats,name:e.name}))),constraints:t.constraints,adjacents:t.adjacents,assignments:t.assignments,seatingPlans:t.seatingPlans,currentPlanIndex:t.currentPlanIndex,userSetTables:t.userSetTables},{error:i}=await $n.from("saved_settings").insert({user_id:_.id,name:d,data:n});if(i)throw console.error("Error saving plan:",i),i.message.includes("check_settings_limit")?new Error(`You've reached your limit of ${a} saved settings. Upgrade to Premium for more.`):new Error(i.message);g(!0),setTimeout((()=>{c(!1),g(!1),u("")}),2e3)}catch(e){console.error("Failed to save plan:",e),y([...f,{message:e.message||"Failed to save settings",type:"error"}])}finally{j(!1)}}else y([...f,{message:"Please enter a name for your settings",type:"error"}]);else v(!0)},disabled:w||!d.trim(),icon:w?x.jsx(J,{className:"w-4 h-4 animate-spin"}):x.jsx(Y,{className:"w-4 h-4"}),children:w?"Saving...":"Save Plan"})]})]})]})}),b&&x.jsx(Dn,{onClose:()=>v(!1)})]})},Ti=()=>{const{state:t,dispatch:s}=pi(),[r,a]=e.useState([]),[i,o]=e.useState(!0),[l,c]=e.useState(null),[d,u]=e.useState(!1),[h,m]=e.useState(""),[p,g]=e.useState(!1);e.useState(!1);const f=n(),{user:y,subscription:b}=t;e.useEffect((()=>{y?v():(a([]),o(!1))}),[y]);const v=async()=>{try{if(!y)return a([]),void o(!1);o(!0),c(null);const{data:e,error:t}=await $n.from("saved_settings").select("*").order("updated_at",{ascending:!1});if(t)throw console.error("Error loading settings:",t),t;console.log("Loaded settings:",(null==e?void 0:e.length)||0),a(e||[])}catch(e){c("Failed to load saved settings"),console.error(e)}finally{o(!1)}},w=async e=>{try{if(console.log("Loading saved setting:",e),!e.data)throw new Error("Saved setting data is missing or corrupted");const r=["guests","tables","constraints","adjacents","assignments"].filter((t=>!e.data.hasOwnProperty(t)));r.length>0&&(console.warn(`Missing properties in saved settings: ${r.join(", ")}`),r.forEach((t=>{switch(t){case"guests":e.data.guests=[];break;case"tables":e.data.tables=[];break;case"constraints":e.data.constraints={};break;case"adjacents":e.data.adjacents={};break;case"assignments":e.data.assignments={}}}))),e.data.tables&&(e.data.tables=e.data.tables.map((e=>e.hasOwnProperty("seats")?e:{...e,seats:8}))),e.data.hasOwnProperty("userSetTables")||(e.data.userSetTables=!0),si(t.subscription)&&y&&await ii(y.id,!0),s({type:"IMPORT_STATE",payload:e.data}),s({type:"SET_LOADED_SAVED_SETTING",payload:!0}),await $n.from("saved_settings").update({updated_at:(new Date).toISOString()}).eq("id",e.id),f("/seating")}catch(r){console.error("Failed to load settings:",r),c("Failed to load settings: "+(r.message||"Unknown error"))}},j=si(b),_=ai(j?{status:"active"}:null);return y?x.jsxs("div",{className:"space-y-6",children:[x.jsxs("h1",{className:"text-2xl font-bold text-[#7973BB] flex items-center",children:[x.jsx(U,{className:"mr-2"}),"Saved Settings",j&&x.jsxs("span",{className:"flex items-center bg-yellow-500 text-black px-2 py-0.5 rounded-full text-sm font-medium ml-2",children:[x.jsx(L,{className:"w-4 h-4 mr-1"}),"Premium"]})]}),x.jsx(yi,{children:x.jsxs("div",{className:"space-y-4",children:[x.jsxs("p",{className:"text-gray-700",children:["Save and manage your seating arrangements.",j?" Premium users can save up to 50 configurations.":` Free users can save up to ${_} configurations. Premium users can save up to 50.`]}),x.jsx(re,{onClick:()=>u(!0),icon:x.jsx(Y,{className:"w-4 h-4"}),disabled:j?r.length>=50:r.length>=_,children:"Save Current Settings"}),l&&x.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-md p-3 flex items-start",children:[x.jsx(k,{className:"w-5 h-5 text-red-500 mr-2 flex-shrink-0 mt-0.5"}),x.jsx("p",{className:"text-red-700",children:l})]}),!j&&r.length>=_&&x.jsx("div",{className:"bg-indigo-50 border border-indigo-200 rounded-md p-3",children:x.jsxs("p",{className:"text-indigo-700",children:["You've reached your limit of ",_," saved settings.",x.jsx("span",{className:"font-bold",children:" Upgrade to Premium for more saved settings!"})]})}),j&&x.jsx("div",{className:"bg-green-50 border border-green-300 rounded-md p-3",children:x.jsxs("p",{className:"text-green-700 flex items-center",children:[x.jsx(L,{className:"w-4 h-4 mr-1 text-yellow-500"}),x.jsx("span",{children:"Premium users: Your table names will automatically be preserved between sessions."})]})})]})}),x.jsx(yi,{title:"Saved Configurations",children:i?x.jsxs("div",{className:"text-center py-4",children:[x.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500 mx-auto"}),x.jsx("p",{className:"mt-2 text-gray-600",children:"Loading saved settings..."})]}):0===r.length?x.jsx("div",{className:"text-center py-4 text-gray-500",children:'No saved settings yet. Click "Save Current Settings" to create your first configuration.'}):x.jsx("div",{className:"space-y-4",children:r.map((e=>{var t,s;return x.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>w(e),children:x.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"font-medium text-gray-900",children:e.name}),x.jsxs("p",{className:"text-sm text-gray-500",children:["Last modified: ",new Date(e.updated_at).toLocaleDateString()]}),(null==(t=e.data)?void 0:t.guests)&&x.jsxs("p",{className:"text-sm text-gray-600",children:[e.data.guests.length," guests  ",(null==(s=e.data.tables)?void 0:s.length)||0," tables"]})]}),x.jsxs("div",{className:"flex flex-wrap gap-2",children:[x.jsx(re,{variant:"secondary",size:"sm",onClick:t=>{t.stopPropagation(),w(e)},icon:x.jsx(U,{className:"w-4 h-4"}),className:"bg-green-100 hover:bg-green-200 border border-green-300",children:"Load"}),x.jsx(re,{variant:"secondary",size:"sm",onClick:t=>{t.stopPropagation(),(async(e,t)=>{const s=prompt("Enter new name:",t);if(s&&s!==t)try{const{error:t}=await $n.from("saved_settings").update({name:s}).eq("id",e);if(t)throw t;v()}catch(r){c("Failed to rename settings"),console.error(r)}})(e.id,e.name)},icon:x.jsx(W,{className:"w-4 h-4"}),children:"Rename"}),x.jsx(re,{variant:"secondary",size:"sm",onClick:t=>{t.stopPropagation(),(async e=>{try{const t=si(b),s=ai(t?{status:"active"}:null);if(r.length>=s&&!t)return void c(`Free users can only save up to ${s} settings. Upgrade to Premium for unlimited settings.`);const{error:a}=await $n.from("saved_settings").insert({name:`${e.name} (Copy)`,data:e.data});if(a)throw a;v()}catch(t){c("Failed to duplicate settings"),console.error(t)}})(e)},icon:x.jsx(O,{className:"w-4 h-4"}),disabled:!j&&r.length>=_,children:"Duplicate"}),x.jsx(re,{variant:"danger",size:"sm",onClick:t=>{t.stopPropagation(),(async e=>{if(window.confirm("Are you sure you want to delete these settings?"))try{const{error:t}=await $n.from("saved_settings").delete().eq("id",e);if(t)throw t;v()}catch(t){c("Failed to delete settings"),console.error(t)}})(e.id)},icon:x.jsx(Q,{className:"w-4 h-4"}),children:"Delete"})]})]})},e.id)}))})}),d&&x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:x.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full shadow-2xl",children:[x.jsx("h3",{className:"text-xl font-bold mb-4",children:"Save Current Settings"}),x.jsxs("div",{className:"mb-4",children:[x.jsx("label",{htmlFor:"settingName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Configuration Name"}),x.jsx("input",{id:"settingName",type:"text",value:h,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#7973BB]",placeholder:"Enter a name for these settings"})]}),x.jsxs("div",{className:"flex justify-end space-x-2",children:[x.jsx(re,{variant:"secondary",onClick:()=>u(!1),children:"Cancel"}),x.jsx(re,{onClick:async()=>{if(y)if(h.trim())try{const e=si(b),s=ai(e?{status:"active"}:null);if(r.length>=s&&!e)return void c(`Free users can only save up to ${s} settings. Upgrade to Premium for unlimited settings.`);const a={version:"1.0",guests:t.guests,tables:t.tables.map((e=>({id:e.id,seats:e.seats,name:e.name}))),constraints:t.constraints,adjacents:t.adjacents,assignments:t.assignments,seatingPlans:t.seatingPlans,currentPlanIndex:t.currentPlanIndex,userSetTables:t.userSetTables},{error:n}=await $n.from("saved_settings").insert({name:h,data:a});if(n)throw console.error("Error saving settings:",n),n.message.includes("violates row-level security policy")?new Error("You don't have permission to save settings. Please make sure you're logged in."):n;u(!1),m(""),v()}catch(e){console.error("Failed to save settings:",e),c(e.message||"Failed to save settings")}else c("Please enter a name for your settings");else g(!0)},icon:x.jsx(Y,{className:"w-4 h-4"}),children:"Save Settings"})]})]})}),p&&x.jsx(Dn,{onClose:()=>g(!1)})]}):x.jsxs("div",{className:"space-y-6",children:[x.jsxs("h1",{className:"text-2xl font-bold text-[#7973BB] flex items-center",children:[x.jsx(U,{className:"mr-2"}),"Saved Settings"]}),x.jsx(yi,{children:x.jsxs("div",{className:"text-center py-8",children:[x.jsx("p",{className:"text-gray-600 mb-4",children:"You need to be logged in to access saved settings."}),x.jsx(re,{onClick:()=>g(!0),children:"Log In or Sign Up"})]})}),p&&x.jsx(Dn,{onClose:()=>g(!1)})]})},Ci=()=>x.jsxs("div",{className:"space-y-6 pb-8",children:[x.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center",children:[x.jsx(Z,{className:"mr-2"}),"Privacy Policy"]}),x.jsx(yi,{children:x.jsxs("div",{className:"prose max-w-none",children:[x.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Effective Date: May 9, 2025"}),x.jsx("p",{className:"mb-6",children:'This Privacy Policy explains how Exabyte LLC ("we," "us," "our") collects, uses, shares, and protects information about users of Seatyr.com (the "Service").'}),x.jsx("p",{className:"mb-6",children:"By using Seatyr.com, you agree to the terms of this policy."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"1. Information We Collect"}),x.jsx("p",{children:"We collect the following types of information:"}),x.jsx("h4",{className:"font-semibold mt-4 mb-2",children:"a. Information You Provide"}),x.jsxs("ul",{className:"list-disc pl-6 mb-4",children:[x.jsx("li",{children:"Guest lists and event data (names, seating preferences, constraints)"}),x.jsx("li",{children:"Your email address or name (if provided via contact form or optional account registration)"})]}),x.jsx("h4",{className:"font-semibold mt-4 mb-2",children:"b. Automatically Collected Information"}),x.jsxs("ul",{className:"list-disc pl-6 mb-4",children:[x.jsx("li",{children:"Device and browser type"}),x.jsx("li",{children:"IP address and usage data"}),x.jsx("li",{children:"Cookies and similar technologies (see Section 6)"})]}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"2. How We Use Your Information"}),x.jsx("p",{children:"We use the information we collect to:"}),x.jsxs("ul",{className:"list-disc pl-6 mb-4",children:[x.jsx("li",{children:"Provide and maintain the Service"}),x.jsx("li",{children:"Improve functionality and performance"}),x.jsx("li",{children:"Respond to user inquiries and support requests"}),x.jsx("li",{children:"Protect against misuse or unauthorized access"}),x.jsx("li",{children:"Analyze aggregate usage trends (non-personally identifiable)"})]}),x.jsx("p",{className:"mb-4",children:"We do not sell or rent your personal data."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"3. Data Storage & Security"}),x.jsx("p",{className:"mb-4",children:"We use industry-standard measures to protect your data, including encryption, secure servers, and access controls."}),x.jsx("p",{className:"mb-4",children:"However, no internet-based service is 100% secure. You use the Service at your own risk and are responsible for safeguarding any personal data you choose to upload."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"4. Data Retention"}),x.jsx("p",{className:"mb-4",children:"Event and guest data is retained only as long as needed to operate the Service or as requested by you."}),x.jsx("p",{className:"mb-4",children:"You may request deletion of your data at any time by contacting us at info@seatyr.com."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"5. Sharing of Information"}),x.jsx("p",{className:"mb-4",children:"We do not share personal information with third parties except:"}),x.jsxs("ul",{className:"list-disc pl-6 mb-4",children:[x.jsx("li",{children:"As required by law or court order"}),x.jsx("li",{children:"To third-party service providers who support site functionality (e.g., hosting)"}),x.jsx("li",{children:"In the event of a merger, acquisition, or asset sale"})]}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"6. Cookies and Analytics"}),x.jsx("p",{className:"mb-4",children:"Seatyr.com may use cookies and third-party analytics (such as Google Analytics) to enhance user experience and gather usage data. You can disable cookies in your browser settings, though this may affect site performance."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"7. Children's Privacy"}),x.jsx("p",{className:"mb-4",children:"Seatyr.com is not intended for use by children under 13. We do not knowingly collect personal information from children."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"8. Your Rights"}),x.jsx("p",{className:"mb-4",children:"Depending on your location, you may have the right to:"}),x.jsxs("ul",{className:"list-disc pl-6 mb-4",children:[x.jsx("li",{children:"Access or correct your personal data"}),x.jsx("li",{children:"Request deletion of your data"}),x.jsx("li",{children:"Object to certain types of data processing"})]}),x.jsx("p",{className:"mb-4",children:"To make such a request, email us at info@seatyr.com."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"9. International Users"}),x.jsx("p",{className:"mb-4",children:"If you are accessing Seatyr.com from outside the United States, be aware that your data may be processed and stored in the U.S. By using the Service, you consent to this transfer."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"10. Changes to This Policy"}),x.jsx("p",{className:"mb-4",children:"We may update this Privacy Policy periodically. Changes will be posted on this page with the updated effective date. Continued use of the Service after changes constitutes acceptance."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"11. Contact Us"}),x.jsx("p",{className:"mb-4",children:"If you have questions about this Privacy Policy or how your data is handled, contact:"}),x.jsxs("p",{className:"mb-4",children:["Exabyte LLC",x.jsx("br",{}),"Email: info@seatyr.com",x.jsx("br",{}),"Website: https://seatyr.com"]})]})})]}),Pi=()=>x.jsxs("div",{className:"space-y-6 pb-8",children:[x.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center",children:[x.jsx(K,{className:"mr-2"}),"Terms of Service"]}),x.jsx(yi,{children:x.jsxs("div",{className:"prose max-w-none",children:[x.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Effective Date: May 9, 2025"}),x.jsx("p",{className:"mb-6",children:'Welcome to Seatyr.com. These Terms of Service ("Terms") govern your access to and use of our website, applications, and related services (collectively, the "Service") provided by Exabyte LLC ("we," "us," or "our"). By using Seatyr.com, you agree to be bound by these Terms.'}),x.jsx("p",{className:"mb-6",children:"Please read them carefully."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"1. Service Overview"}),x.jsx("p",{className:"mb-4",children:"Seatyr.com is a web-based application that helps users organize and optimize seating arrangements for events such as weddings, banquets, and conferences. Features include guest list management, table assignments, seating permutations, and constraint-based arrangement tools."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"2. Eligibility"}),x.jsx("p",{className:"mb-4",children:"To use Seatyr.com, you must be at least 13 years old. By using the Service, you represent and warrant that you have the legal capacity to enter into these Terms."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"3. User Accounts"}),x.jsx("p",{className:"mb-4",children:"You may use Seatyr.com without an account, but some features may require registration."}),x.jsx("p",{className:"mb-4",children:"You are responsible for maintaining the confidentiality of any account credentials and for all activities that occur under your account."}),x.jsx("p",{className:"mb-4",children:"You agree to provide accurate and current information."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"4. Acceptable Use"}),x.jsx("p",{className:"mb-4",children:"You agree not to:"}),x.jsxs("ul",{className:"list-disc pl-6 mb-4",children:[x.jsx("li",{children:"Use the Service for any unlawful purpose;"}),x.jsx("li",{children:"Reverse-engineer, copy, or resell any part of the Service;"}),x.jsx("li",{children:"Attempt to interfere with the operation or security of Seatyr.com;"}),x.jsx("li",{children:"Upload or share content that is offensive, harmful, or infringing."})]}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"5. Intellectual Property"}),x.jsx("p",{className:"mb-4",children:"All content on Seatyr.com, including design, code, and trademarks, is owned by Exabyte LLC or its licensors. You may not reproduce, distribute, or modify any portion of the Service without explicit permission."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"6. User Content"}),x.jsx("p",{className:"mb-4",children:"You retain ownership of content (e.g., guest lists) you upload to the Service."}),x.jsx("p",{className:"mb-4",children:"By using the Service, you grant us a limited license to store, display, and process your content to provide the functionality of the Service."}),x.jsx("p",{className:"mb-4",children:"We do not claim ownership over your event data."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"7. Data & Privacy"}),x.jsx("p",{className:"mb-4",children:"Our Privacy Policy explains how we collect, use, and protect your personal data. By using Seatyr.com, you consent to our data practices as outlined there."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"8. Availability & Modifications"}),x.jsx("p",{className:"mb-4",children:"We strive to maintain uptime but do not guarantee uninterrupted access."}),x.jsx("p",{className:"mb-4",children:"We may modify or discontinue any part of the Service at any time, with or without notice."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"9. Third-Party Services"}),x.jsx("p",{className:"mb-4",children:"The Service may integrate with third-party platforms or APIs. We are not responsible for the content, functionality, or policies of those third parties."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"10. Disclaimers"}),x.jsx("p",{className:"mb-4",children:'The Service is provided "as is" and "as available." We make no warranties regarding reliability, accuracy, or suitability for your specific needs.'}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"11. Limitation of Liability"}),x.jsx("p",{className:"mb-4",children:"To the fullest extent permitted by law, Seatyr.com and Exabyte LLC shall not be liable for any indirect, incidental, special, or consequential damages arising from your use of the Service."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"12. Indemnification"}),x.jsx("p",{className:"mb-4",children:"You agree to indemnify and hold harmless Exabyte LLC from any claims, liabilities, or expenses arising from your use of the Service or violation of these Terms."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"13. Governing Law"}),x.jsx("p",{className:"mb-4",children:"These Terms are governed by the laws of the State of New York, without regard to its conflict of law principles."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"14. Changes to These Terms"}),x.jsx("p",{className:"mb-4",children:"We may update these Terms at any time. Continued use of the Service after changes are posted constitutes your acceptance of the revised Terms."}),x.jsx("h3",{className:"text-lg font-semibold mt-8 mb-4",children:"15. Contact Us"}),x.jsxs("p",{className:"mb-4",children:["If you have questions about these Terms, please contact us at:",x.jsx("br",{}),"info@seatyr.com"]})]})})]}),Bi=()=>{const t=n();return e.useEffect((()=>{(async()=>{try{const{error:e}=await $n.auth.getSession();if(e)throw e;t("/",{replace:!0})}catch(e){console.error("Error during auth callback:",e),t("/",{replace:!0})}})()}),[t]),x.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:x.jsxs("div",{className:"text-center",children:[x.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500 mx-auto mb-4"}),x.jsx("p",{className:"text-gray-600",children:"Completing authentication..."})]})})},Ii=()=>{const t=n(),{dispatch:s}=pi();return e.useEffect((()=>{(async()=>{try{const{data:e}=await $n.auth.getUser(),t=null==e?void 0:e.user;if(t){console.log("Refreshing subscription data after payment");const{data:e,error:r}=await $n.from("subscriptions").select("*").eq("user_id",t.id).order("current_period_end",{ascending:!1}).limit(1);if(r)console.error("Error fetching subscription after payment:",r);else if(e&&e.length>0)console.log("Updated subscription data:",e[0]),s({type:"SET_SUBSCRIPTION",payload:e[0]});else if(t.email&&("danabrams999@yahoo.com"===t.email.toLowerCase()||"dan@corpania.com"===t.email.toLowerCase()||"immortality.bytes.book@gmail.com"===t.email.toLowerCase())){console.log("Special user detected, creating fallback premium subscription");const e={id:"special-user",user_id:t.id,status:"active",current_period_end:new Date(Date.now()+2592e6).toISOString(),created:(new Date).toISOString()};s({type:"SET_SUBSCRIPTION",payload:e})}}}catch(e){console.error("Error syncing subscription after payment:",e)}})();const e=setTimeout((()=>{t("/")}),5e3);return()=>clearTimeout(e)}),[t,s]),x.jsxs("div",{className:"space-y-6",children:[x.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center",children:[x.jsx(L,{className:"mr-2"}),"Welcome to Premium!"]}),x.jsx(yi,{children:x.jsxs("div",{className:"text-center py-8",children:[x.jsx(L,{className:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),x.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Thank you for upgrading to Premium!"}),x.jsx("p",{className:"text-gray-600 mb-4",children:"Your premium features are now active. You can now:"}),x.jsxs("ul",{className:"text-left max-w-md mx-auto space-y-2 mb-8",children:[x.jsxs("li",{className:"flex items-center",children:[x.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),"Create seating plans with unlimited guests"]}),x.jsxs("li",{className:"flex items-center",children:[x.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),"Save multiple seating configurations"]}),x.jsxs("li",{className:"flex items-center",children:[x.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),"Access premium support"]})]}),x.jsx("p",{className:"text-sm text-gray-500",children:"Redirecting you to the home page in a few seconds..."})]})})]})},Ai=()=>{const e=n();return x.jsxs("div",{className:"space-y-6",children:[x.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center",children:[x.jsx(se,{className:"mr-2"}),"Premium Upgrade Cancelled"]}),x.jsx(yi,{children:x.jsxs("div",{className:"text-center py-8",children:[x.jsx(se,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),x.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Premium upgrade cancelled"}),x.jsx("p",{className:"text-gray-600 mb-8",children:"No worries! You can still use all the free features of Seatyr. If you change your mind, you can upgrade to Premium at any time."}),x.jsx(re,{onClick:()=>e("/"),className:"mx-auto",children:"Return to Home"})]})})]})},$i=({onSuccess:t})=>{var s;const{state:r}=pi(),{user:a,subscription:n}=r,[i,o]=e.useState(!1),[l,c]=e.useState(!1);if(!a)return x.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:x.jsx("div",{className:"text-center p-4",children:x.jsx("p",{children:"You need to be logged in to view subscription details."})})});const d=si(n),u=n&&"special-user"===n.id,h=null==(s=null==n?void 0:n.id)?void 0:s.toString().startsWith("trial-"),m=e=>e?e&&!isNaN(Number(e))&&10===e.length?new Date(1e3*Number(e)).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A",p=async()=>{o(!0);try{await ei(a.id)}catch(e){console.error("Error opening billing portal:",e),alert("Failed to open billing portal. Please try again.")}finally{o(!1)}};return x.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[x.jsx("div",{className:"flex items-center mb-4",children:x.jsxs("h2",{className:"text-xl font-bold flex items-center",children:[x.jsx(L,{className:"mr-2 text-yellow-500"}),"Subscription Status"]})}),d?x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"bg-green-50 p-4 rounded-md mb-4 flex items-start",children:[x.jsx(L,{className:"mr-2 text-green-600 flex-shrink-0 mt-1"}),x.jsxs("div",{children:[x.jsx("p",{className:"font-medium text-green-700",children:"Premium Subscription Active"}),!u&&!h&&x.jsxs("p",{className:"text-green-600 text-sm",children:["Your subscription is ",n.cancel_at_period_end?"set to cancel":"active"," until ",m(n.current_period_end),"."]}),h&&x.jsxs("p",{className:"text-green-600 text-sm",children:["Your trial subscription is active until ",m(n.current_period_end),"."]})]})]}),!u&&!h&&x.jsxs("div",{className:"space-y-4",children:[n.cancel_at_period_end?x.jsxs("div",{children:[x.jsxs("p",{className:"text-amber-700 mb-2",children:["Your subscription will end on ",m(n.current_period_end),". You'll continue to have premium access until then."]}),x.jsx(re,{onClick:async()=>{o(!0);try{await Qn(a.id,"reactivate"),t&&t()}catch(e){console.error("Error reactivating subscription:",e),alert("Failed to reactivate subscription. Please try again.")}finally{o(!1)}},disabled:i,className:"bg-green-600 hover:bg-green-700",children:"Reactivate Subscription"})]}):x.jsxs("div",{className:"flex flex-wrap gap-3",children:[x.jsx(re,{variant:"secondary",onClick:p,disabled:i,icon:x.jsx(R,{className:"w-4 h-4"}),children:"Manage Billing"}),x.jsx(re,{variant:"danger",onClick:()=>c(!0),disabled:i,children:"Cancel Subscription"})]}),"past_due"===n.status&&x.jsxs("div",{className:"bg-amber-50 p-4 rounded-md mt-4 flex items-start",children:[x.jsx(S,{className:"mr-2 text-amber-500 flex-shrink-0 mt-1"}),x.jsxs("div",{children:[x.jsx("p",{className:"font-medium text-amber-700",children:"Payment Issue Detected"}),x.jsx("p",{className:"text-amber-600 text-sm",children:"We were unable to process your last payment. Please update your payment method to avoid losing premium access."}),x.jsx(re,{variant:"warning",onClick:p,className:"mt-2",children:"Update Payment Method"})]})]})]})]}):x.jsx("div",{className:"bg-gray-50 p-4 rounded-md mb-4",children:x.jsx("p",{className:"text-gray-700",children:n?"Your premium subscription has ended.":"You do not have an active subscription."})}),l&&x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:x.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full shadow-2xl",children:[x.jsx("h3",{className:"text-xl font-bold mb-4",children:"Cancel Premium Subscription?"}),x.jsxs("p",{className:"text-gray-700 mb-6",children:["Are you sure you want to cancel your Premium subscription? You will still have access until ",m(null==n?void 0:n.current_period_end),"."]}),x.jsxs("div",{className:"flex justify-end space-x-2",children:[x.jsx(re,{variant:"secondary",onClick:()=>c(!1),disabled:i,children:"Keep Subscription"}),x.jsx(re,{variant:"danger",onClick:async()=>{o(!0);try{await Qn(a.id,"cancel"),t&&t(),c(!1)}catch(e){console.error("Error cancelling subscription:",e),alert("Failed to cancel subscription. Please try again.")}finally{o(!1)}},disabled:i,children:"Yes, Cancel"})]})]})})]})},Oi=({userId:t})=>{const[s,r]=e.useState([]),[a,n]=e.useState(!0),[i,o]=e.useState(null);e.useEffect((()=>{(async()=>{try{n(!0);const e=await(async e=>{try{const{data:t,error:s}=await $n.from("payment_history").select("*").eq("user_id",e).order("payment_date",{ascending:!1});if(s)throw s;return t||[]}catch(i){throw console.error("Error fetching payment history:",i),i}})(t);r(e),o(null)}catch(e){o("Unable to load payment history"),console.error("Error loading payment history:",e)}finally{n(!1)}})()}),[t]);const l=e=>{const t={paid:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",failed:"bg-red-100 text-red-800",refunded:"bg-blue-100 text-blue-800"}[e.toLowerCase()]||"bg-gray-100 text-gray-800";return x.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t}`,children:e.charAt(0).toUpperCase()+e.slice(1)})};return a?x.jsx("div",{className:"flex justify-center py-6",children:x.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#7973BB]"})}):i?x.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md text-red-700",children:[x.jsx("p",{className:"font-medium",children:"Failed to load payment history"}),x.jsx("p",{className:"text-sm",children:"Please try again later or contact support."})]}):0===s.length?x.jsxs("div",{className:"p-6 text-center text-gray-500 bg-gray-50 border border-gray-200 rounded-md",children:[x.jsx($,{className:"w-8 h-8 mx-auto text-gray-400 mb-2"}),x.jsx("p",{className:"font-medium",children:"No payment history yet"}),x.jsx("p",{className:"text-sm",children:"Your payment records will show up here once available."})]}):x.jsx("div",{className:"overflow-x-auto",children:x.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[x.jsx("thead",{children:x.jsxs("tr",{className:"bg-gray-50",children:[x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Invoice"})]})}),x.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map((e=>{return x.jsxs("tr",{className:"hover:bg-gray-50",children:[x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(r=e.payment_date,new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}))}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:(t=e.amount,s=e.currency,new Intl.NumberFormat("en-US",{style:"currency",currency:s.toUpperCase()}).format(t))}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l(e.status)}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-[#7973BB]",children:e.stripe_invoice_id?x.jsxs("a",{href:"#",className:"flex items-center text-[#7973BB] hover:text-[#5d59a5]",onClick:e=>{e.preventDefault()},children:[x.jsx(R,{className:"w-4 h-4 mr-1"}),"View Receipt"]}):"N/A"})]},e.id);var t,s,r}))})]})})},Ri=()=>{var t,s,r;const{state:a,dispatch:i}=pi(),o=n(),[l,c]=e.useState(null),[d,u]=e.useState(!1),[h,m]=e.useState([]);e.useEffect((()=>{$n.auth.getSession().then((({data:{session:e}})=>{c((null==e?void 0:e.user)??null)}));const{data:{subscription:e}}=$n.auth.onAuthStateChange(((e,t)=>{c((null==t?void 0:t.user)??null)}));return()=>e.unsubscribe()}),[]),e.useEffect((()=>{l?p():m([])}),[l]);const p=async()=>{const{data:e}=await $n.from("saved_settings").select("*").order("updated_at",{ascending:!1});m(e||[])};return l?x.jsxs("div",{className:"space-y-6",children:[x.jsxs("h1",{className:"text-2xl font-bold text-[#7973BB] flex items-center",children:[x.jsx(B,{className:"mr-2"}),"Account","active"===(null==(t=a.subscription)?void 0:t.status)&&x.jsxs("span",{className:"flex items-center bg-yellow-500 text-black px-2 py-0.5 rounded-full text-sm font-medium ml-2",children:[x.jsx(L,{className:"w-4 h-4 mr-1"}),"Premium"]})]}),x.jsx(yi,{children:x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("h2",{className:"text-lg font-semibold text-[#7973BB]",children:"Account Details"}),x.jsx("p",{className:"text-gray-600 text-lg",children:l.email})]}),x.jsxs("div",{className:"border-t pt-4",children:[x.jsx("h3",{className:"font-medium text-[#7973BB] mb-2",children:"Account Type"}),x.jsx("p",{className:"text-gray-600 text-lg",children:"active"===(null==(s=a.subscription)?void 0:s.status)?a.subscription.id.toString().startsWith("trial-")?"Beta Tester (Premium Trial)":"Premium Member":"Free Member"})]})]})}),x.jsx($i,{onSuccess:async()=>{if(l)try{console.log("Refreshing subscription data for user:",l.id);const{data:e,error:t}=await $n.from("subscriptions").select("*").eq("user_id",l.id).order("current_period_end",{ascending:!1}).limit(1);if(!t&&(null==e?void 0:e.length)>0)return console.log("Found subscription:",e[0]),void i({type:"SET_SUBSCRIPTION",payload:e[0]});t&&console.error("Error fetching subscription:",t);const{data:s,error:r}=await $n.from("trial_subscriptions").select("*").eq("user_id",l.id).gt("expires_on",(new Date).toISOString()).order("expires_on",{ascending:!1}).limit(1);if(!r&&(null==s?void 0:s.length)>0){console.log("Found trial subscription:",s[0]);const e={id:`trial-${s[0].id}`,user_id:l.id,status:"active",current_period_end:s[0].expires_on,cancel_at_period_end:!0,trial_end:s[0].expires_on};i({type:"SET_SUBSCRIPTION",payload:e})}else r&&console.error("Error fetching trial subscription:",r)}catch(e){console.error("Error refreshing subscription:",e)}}}),x.jsx(yi,{title:"Payment & Billing",actions:x.jsx(re,{variant:"secondary",size:"sm",icon:d?void 0:x.jsx(G,{className:"w-4 h-4"}),onClick:()=>u(!d),children:d?"Hide History":"View Payment History"}),children:x.jsxs("div",{className:"space-y-4",children:[x.jsx("p",{className:"text-gray-700",children:"Manage your payment methods and view your billing history."}),"active"===(null==(r=a.subscription)?void 0:r.status)&&!a.subscription.id.toString().startsWith("trial-")&&x.jsx(re,{variant:"secondary",onClick:async()=>{try{await $n.auth.getUser(),await ei(l.id)}catch(e){console.error("Error opening customer portal:",e),alert("Failed to open customer portal. Please try again.")}},icon:x.jsx(R,{className:"w-4 h-4"}),children:"Manage Payment Methods"}),d&&x.jsxs("div",{className:"mt-6",children:[x.jsx("h3",{className:"text-lg font-medium text-[#7973BB] mb-4",children:"Payment History"}),x.jsx(Oi,{userId:l.id})]})]})}),x.jsx(yi,{title:"Saved Settings",children:0===h.length?x.jsx("p",{className:"text-gray-500 text-center py-4 text-lg",children:"No saved settings yet."}):x.jsx("div",{className:"space-y-4",children:h.map((e=>{var t,s;return x.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>(async e=>{try{if(console.log("Loading saved setting from Account page:",e),!e.data)throw new Error("Saved setting data is missing or corrupted");e.data.tables&&(e.data.tables=e.data.tables.map((e=>e.hasOwnProperty("seats")?e:{...e,seats:8}))),e.data.hasOwnProperty("userSetTables")||(e.data.userSetTables=!0),i({type:"IMPORT_STATE",payload:e.data}),alert("Settings loaded successfully!"),o("/seating")}catch(t){console.error("Error loading settings:",t),alert("Failed to load settings. Please try again.")}})(e),children:x.jsxs("div",{children:[x.jsx("h3",{className:"font-medium text-[#7973BB] text-lg",children:e.name}),x.jsxs("p",{className:"text-sm text-gray-500 text-lg",children:["Last modified: ",new Date(e.updated_at).toLocaleDateString()]}),(null==(t=e.data)?void 0:t.guests)&&(null==(s=e.data)?void 0:s.tables)&&x.jsxs("p",{className:"text-sm text-gray-600",children:[e.data.guests.length," guests  ",e.data.tables.length," tables"]})]})},e.id)}))})})]}):x.jsxs("div",{className:"space-y-6",children:[x.jsxs("h1",{className:"text-2xl font-bold text-[#7973BB] flex items-center",children:[x.jsx(B,{className:"mr-2"}),"Account"]}),x.jsx(yi,{children:x.jsx("div",{className:"text-center py-8",children:x.jsx("p",{className:"text-gray-600 text-lg",children:"Please log in to view your account details."})})})]})},Li=()=>{const{state:t}=pi(),{user:s}=t,[r,a]=e.useState([]),[n,i]=e.useState(!0),[o,l]=e.useState(null),[c,d]=e.useState(!1),[u,h]=e.useState(null),[m,p]=e.useState({code:"",maxUses:"10",expirationDays:"30"});e.useEffect((()=>{g()}),[]);const g=async()=>{try{i(!0),l(null);const{data:e,error:t}=await $n.from("beta_codes").select("*").order("code");if(t)throw t;a(e||[])}catch(e){console.error("Error fetching beta codes:",e),l("Failed to load beta codes")}finally{i(!1)}};return(null==s?void 0:s.email)&&["your-admin-email@example.com","danabrams999@yahoo.com","dan@corpania.com"].includes(s.email.toLowerCase())?x.jsxs("div",{className:"space-y-6",children:[x.jsxs("h1",{className:"text-2xl font-bold text-[#7973BB] flex items-center",children:[x.jsx(F,{className:"mr-2"}),"Beta Code Management"]}),x.jsxs(yi,{children:[x.jsxs("div",{className:"flex justify-between items-center mb-4",children:[x.jsx("p",{className:"text-gray-700",children:"Create and manage beta codes for premium trial access."}),x.jsx(re,{onClick:()=>d(!0),icon:x.jsx(V,{className:"w-4 h-4"}),children:"Create New Code"})]}),o&&x.jsx("div",{className:"bg-red-50 border border-red-200 rounded p-3 mb-4 text-red-600",children:o})]}),x.jsx(yi,{title:"Beta Codes",children:n?x.jsxs("div",{className:"text-center py-4",children:[x.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500 mx-auto"}),x.jsx("p",{className:"mt-2 text-gray-600",children:"Loading codes..."})]}):0===r.length?x.jsx("div",{className:"text-center py-4",children:x.jsx("p",{className:"text-gray-500",children:"No beta codes found. Create one to get started."})}):x.jsx("div",{className:"overflow-x-auto",children:x.jsxs("table",{className:"min-w-full border-collapse",children:[x.jsx("thead",{children:x.jsxs("tr",{className:"bg-indigo-50",children:[x.jsx("th",{className:"px-4 py-2 text-left text-[#7973BB] font-medium",children:"Code"}),x.jsx("th",{className:"px-4 py-2 text-left text-[#7973BB] font-medium",children:"Usage"}),x.jsx("th",{className:"px-4 py-2 text-left text-[#7973BB] font-medium",children:"Expires On"}),x.jsx("th",{className:"px-4 py-2 text-left text-[#7973BB] font-medium",children:"Status"}),x.jsx("th",{className:"px-4 py-2 text-right text-[#7973BB] font-medium",children:"Actions"})]})}),x.jsx("tbody",{children:r.map((e=>{const t=e.expires_on&&new Date(e.expires_on)<new Date,s=e.max_uses&&e.uses>=e.max_uses,r=t?"Expired":s?"Maxed Out":"Active";return x.jsxs("tr",{className:"border-b",children:[x.jsx("td",{className:"px-4 py-3 font-medium",children:x.jsxs("div",{className:"flex items-center",children:[e.code,x.jsxs("button",{onClick:()=>(async e=>{try{await navigator.clipboard.writeText(e),h(e),setTimeout((()=>h(null)),2e3)}catch(t){console.error("Could not copy text: ",t)}})(e.code),className:"ml-2 text-gray-500 hover:text-[#7973BB]",title:"Copy code",children:[x.jsx(I,{size:16}),u===e.code&&x.jsx("span",{className:"ml-1 text-xs text-green-600",children:"Copied!"})]})]})}),x.jsxs("td",{className:"px-4 py-3",children:[e.uses,e.max_uses?`/${e.max_uses}`:""]}),x.jsx("td",{className:"px-4 py-3",children:e.expires_on?new Date(e.expires_on).toLocaleDateString():"Never"}),x.jsx("td",{className:"px-4 py-3",children:x.jsx("span",{className:"inline-block px-2 py-1 rounded-full text-xs font-medium "+("Active"===r?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:r})}),x.jsx("td",{className:"px-4 py-3 text-right",children:x.jsx(re,{variant:"danger",size:"sm",onClick:()=>(async e=>{try{if(!confirm("Are you sure you want to delete this beta code?"))return;const{error:t}=await $n.from("beta_codes").delete().eq("code",e);if(t)throw t;g()}catch(t){console.error("Error deleting beta code:",t),l("Failed to delete beta code")}})(e.code),icon:x.jsx(Q,{className:"w-4 h-4"}),children:"Delete"})})]},e.code)}))})]})})}),c&&x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:x.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full shadow-2xl",children:[x.jsx("h3",{className:"text-xl font-bold mb-4",children:"Create New Beta Code"}),x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{htmlFor:"code",className:"block text-sm font-medium text-gray-700 mb-1",children:"Code"}),x.jsx("input",{id:"code",type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#7973BB]",placeholder:"e.g., BETA2025",value:m.code,onChange:e=>p((t=>({...t,code:e.target.value})))})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"maxUses",className:"block text-sm font-medium text-gray-700 mb-1",children:"Maximum Uses (leave empty for unlimited)"}),x.jsx("input",{id:"maxUses",type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#7973BB]",placeholder:"e.g., 10",value:m.maxUses,onChange:e=>p((t=>({...t,maxUses:e.target.value})))})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"expirationDays",className:"block text-sm font-medium text-gray-700 mb-1",children:"Expires After Days (leave empty for no expiration)"}),x.jsx("input",{id:"expirationDays",type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#7973BB]",placeholder:"e.g., 30",value:m.expirationDays,onChange:e=>p((t=>({...t,expirationDays:e.target.value})))})]}),x.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[x.jsx(re,{variant:"secondary",onClick:()=>d(!1),children:"Cancel"}),x.jsx(re,{onClick:async()=>{try{if(!m.code.trim())return void l("Please enter a code");const e=parseInt(m.maxUses),t=parseInt(m.expirationDays),s=new Date;s.setDate(s.getDate()+t),await(async(e,t,s)=>{try{const{data:{user:r}}=await $n.auth.getUser();if(!r)throw new Error("You must be logged in to create beta codes");const{data:a,error:n}=await $n.from("beta_codes").insert({code:e,max_uses:t,expires_on:null==s?void 0:s.toISOString(),uses:0}).select().single();if(n)throw n;return await $n.from("valid_beta_codes_ui").insert({code:e}).select(),a}catch(o){throw console.error("Error creating beta code:",o),o}})(m.code.trim(),isNaN(e)?void 0:e,isNaN(t)?void 0:s),g(),d(!1),p({code:"",maxUses:"10",expirationDays:"30"})}catch(e){console.error("Error creating beta code:",e),l("Failed to create beta code")}},children:"Create Code"})]})]})]})})]}):x.jsxs("div",{className:"space-y-6",children:[x.jsxs("h1",{className:"text-2xl font-bold text-[#7973BB] flex items-center",children:[x.jsx(F,{className:"mr-2"}),"Beta Code Management"]}),x.jsx(yi,{children:x.jsx("div",{className:"text-center py-8",children:x.jsx("p",{className:"text-red-600 text-lg",children:"Unauthorized access. Admin privileges required."})})})]})},Di=()=>x.jsx("footer",{className:"bg-[#7973BB] text-white py-4 mt-auto",children:x.jsx("div",{className:"container mx-auto px-4",children:x.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between",children:[x.jsx("div",{className:"text-sm mb-2 md:mb-0",children:" 2025 Seatyr - Efficient Seating for Slightly Fewer Headaches"}),x.jsxs("div",{className:"flex items-center space-x-4",children:[x.jsx("a",{href:"https://github.com",target:"_blank",rel:"noopener noreferrer",className:"text-white hover:text-white/80 transition-colors","aria-label":"GitHub",children:x.jsx(M,{className:"w-5 h-5"})}),x.jsx("a",{href:"/privacy",className:"text-white hover:text-white/80 transition-colors text-sm",children:"Privacy Policy"}),x.jsx("a",{href:"/terms",className:"text-white hover:text-white/80 transition-colors text-sm",children:"Terms of Service"})]})]})})});function Ui(){return x.jsx(o,{children:x.jsx(mi,{children:x.jsxs("div",{className:"min-h-screen bg-indigo-50 flex flex-col",children:[x.jsx(gi,{}),x.jsx("main",{className:"flex-grow container mx-auto px-4 py-6",children:x.jsxs(l,{children:[x.jsx(c,{path:"/",element:x.jsx(bi,{})}),x.jsx(c,{path:"/constraints",element:x.jsx(xi,{})}),x.jsx(c,{path:"/tables",element:x.jsx(vi,{})}),x.jsx(c,{path:"/assignments",element:x.jsx(wi,{})}),x.jsx(c,{path:"/seating",element:x.jsx(Ei,{})}),x.jsx(c,{path:"/saved-settings",element:x.jsx(Ti,{})}),x.jsx(c,{path:"/privacy",element:x.jsx(Ci,{})}),x.jsx(c,{path:"/terms",element:x.jsx(Pi,{})}),x.jsx(c,{path:"/auth/callback",element:x.jsx(Bi,{})}),x.jsx(c,{path:"/premium/success",element:x.jsx(Ii,{})}),x.jsx(c,{path:"/premium/cancel",element:x.jsx(Ai,{})}),x.jsx(c,{path:"/account",element:x.jsx(Ri,{})}),x.jsx(c,{path:"/admin/beta-codes",element:x.jsx(Li,{})})]})}),x.jsx(Di,{})]})})})}v.createRoot(document.getElementById("root")).render(x.jsx(s.StrictMode,{children:x.jsx(Ui,{})}));
//# sourceMappingURL=index-Bgh7yE98.js.map
